<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />
<title>CIF and POSCAR web-viewer</title>
<style>
@font-face {
font-family:Exo2;
src: url('data:application/x-font-woff;base64,d09GRgABAAAAAHmcABMAAAAA+agAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAB5eAAAABwAAAAceUsFJ0dERUYAAGREAAAAHQAAAB4AJwDvR1BPUwAAZJwAABTcAABNzPMOXlFHU1VCAABkZAAAADgAAABQkzyCS09TLzIAAAIgAAAATwAAAGB2j4xSY21hcAAABOAAAAGGAAAB2rnFRIVjdnQgAAANeAAAAEoAAACOHSQ4hmZwZ20AAAZoAAAGcAAADW1BHo58Z2FzcAAAZDwAAAAIAAAACAAAABBnbHlmAAAPjAAAT9gAAIqUB7r492hlYWQAAAGoAAAANgAAADYL57chaGhlYQAAAeAAAAAgAAAAJA8MBj5obXR4AAACcAAAAm8AAAOkwddcYmxvY2EAAA3EAAABxwAAAdRDgWX4bWF4cAAAAgAAAAAgAAAAIAIsAjFuYW1lAABfZAAAAusAAAWve92IL3Bvc3QAAGJQAAAB6wAAAto4Fjk0cHJlcAAADNgAAACfAAAAsVrvLKx3ZWJmAAB5lAAAAAYAAAAGZupZmAABAAAAAQBBE46CgV8PPPUAHwgAAAAAAM9oVQQAAAAA1b4XaP+i/f4H7Ad5AAAACAACAAAAAAAAeNpjYGRgYK/+u5SBgYPh/6L/69nfMABFUMBLAJ74B1oAAQAAAOkATQAFAAAAAAACACQANgCLAAAAjgGsAAAAAHjaY2Bm0WCcwMDKwMJqzHKWgYFhFoRmOsuQxhQG5AOlYICJnQEJhHqH+zE4MCj8ZmFL+5fGwMBezRStwMAwHSTH+JxpE5BSYGACADztDNkAeNptU19IU2EcPff7fvfeEB8ihPbgU2UvMUZIyDCLIgwdZpiEjBARkSHpWKNIbfogY4iMJcNmEjS1IiKGjBCRMaqnnqW3oCESIwpEIiRC17lXBBMvHM7H/b7fv3P4qZ+4Bn7qDWB8IvvwQa0hZY4gKBO4b59Fj+XFpPEWKVVCmLiqnyIsIUSNNSR1BmnjM6bkFBpkDRPaB6+MISL3MCA/cFFayGkkxIOb8gVJniPGBpLGN8xKEwYl5/K0VKHDLGJO/qBGfiMvKcTMdvIIXkk7cqaFcbMLeeUhVtAkq7yrRc4WPDEXkeddTFbIQYzLFu8esYeXOG/ewmsp4bQ9g8uygXpJ4qQk0KvmsSpn0EDu1CHme8754miUPoRY+5n+zhlnEJUAwroKfnmATubLGn+RVeCsJ8g9WLAVss5/mWK9RXIKEX2BfBz9uprvUpypCXVWhrX98Ekj6qQGfSqJbmMbBZVCh9Tjsat9NZYYF2aPUXlPzbbQynpF4Uy6BS+sJQzrBDVepzcrmNUzSMtd9lePmCpT53eY0yOI6dsYVRPsp4gOap02SmhWQTTrJOPXMWiVccP2EPOsA87laH4E7LbKruOD68EBKE8lRx8S5CK5ipp79z04DF1Ct3umDwfh+lBgTD+1dTQ/AtY2Qq4Pgf9h7FQWjB2MkvPErjx0vd7z4DCmqaPDjg8H4fiQYQzZbkPMvsI37EnfQS/RrQuAPQzss4pxP74Sl/aATfIYeYBvuAP74Exp+xw1LyBuLGPc2RH1C3G1SQ+reS5j1fqIhBOrrqNVBdDl5DVrMWgvY5L+gHvip6Z+ewj+Y4D/Hyi85HcAeNpjYGBgZoBgGQZGBhC4AuQxgvksDDuAtBaDApDFxVDHsIXhP2MwYwXTMaY7ClwKIgpSCnIKSgpqCvoKVgrxCmsUlVT//Gb5/x+oR4FhAcM2xiCoWgYFAQUJBRmoWku4Wsb///8//n/o/8H/+f+9//77+/LBsQcHH+x7sPfBrgfbH6x/sOxB0wOz+wdvvWB9AnUbkYCRjQGugZEJSDChKwB6mYWVjZ2Dk4ubh5ePX0BQSFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTS1tHV0/fwNDI2MTUzNzC0sraxtbO3sHRydnF1c3dw9PL28fXzz8gMCg4JDQsPCIyKjomNi4+IZGhta2ja9L0uYsWLl66ZNmKVStXr1m3dv2GTVs2b92+bfeuPXsZilJSM++ULyjIflyWxdA+k6GYgSEd4rqcaoblOxuS80Ds3Jq7SY0t0w4eunL15q1r13cwHDjM8Oj+g6fPGCpu3GZo7m7q6ezrn9A7ZSrD5NlzZjEcOVoI1FQJxAC5t4rgAAB42q1WaXcTNxTVeMlGNhISWqalMsJpGmsMpSwBDISZOC64ixOgnYHSzsQO3RfoRvd9wb/mTdKeQ7/x03qfZJsEEnraU3/wu5Ku9FY9DQktSVwJq5GU9btidLlOfZeuhnTUpdkoviHbV0LKFJO/BsSAaDbVqlsokIhIBGpxXTgiiH2PHE0yvuFRRsuWpHsNys1cXZ91dgXVZpX6qmGBssVo5VpYUAW3HUpqNDC1ELmS5hnNR5FMLTtp0SymOiNJh3n9MDPvNUIJa9qJpKFGGGNG8toQo+OMjsduHEWRC2tpKGiSWAlJ1JkMVuDWaT+j/fXk7rhoMuNuXqxGUSuJyClFkSLRCNeiyKOsltCcKybwJR80Qsorn/qUD89BjT3KaQVPZCvNr/qSV9hH19rM/5SLq03KzhWwGMi2bENBejhfRFiWw7jhJitRqKJCJGnhUog1l4PR0e9RXlN/UFoXGRvbPgyVr5Aj5SeUWb1BThNWUH7Oo34t2dRh+JITq5JPoIU4Ykq8aEwd0Ov9wyKo+nOFXrYG9dbsDdlTnBJMgO3FWFbbKuFMmggLl7NA0oWRXSuRT5UsWhW7dthOB7FLuPdd27xpWBuH1ncNZVEeripEcwWPRnSayVSplSx6NKpBlJJGgou8HUD5EY3yaAWjUYw8GsMx4yYkEhFoQi+NBbFsx5LGEDSPxnX9cpjmWovRQRpZU7c92q3ry2H9kp10C5ifNPMTOhXjwZUwHR8PyEl8GitxlaOa/HSE/0bxR840MpEtNsKUgwdv/TbyC7WjcwWFbV3s2nXegsvDMxE8qcH+Gma3pmqHBKZCTCpEKyBxdt1xHJOrSS1SkaleDmlc+bJKwyi+XQoF58sY6v+cmHDEmPD9dpxO9JXoTsk9gDDtgW+TJY+mdOqwnEacWe7VaZblYzrNsXxcp3mW+3Tax9LVaT/LJ3Q6wPJJnQ6yfEarbtypL0aElSyTc50viEdzmxane4s37WJp0+JMb/GWXdyvBY2U/oN/T8G//bBLwj+WBfjH8gD8Y6ngH8uD8I9lEf6xnIF/LJ+Gfyxn4R9LrWXFlKmnoXYilgFyGwcmlbh6mmu1rMkrkYdbeAgXoCZ3yKJK5hX30EcyXPb+cDe16fBQlSuNDs2leWeqGqL/sZfPbgrPTpwjWh4zlj+H0yyn+rBOXNZtbeF5Mf2H4N/iWTWfHnGm2NejiAcc2N5+XJJk3qNjury34tHxf6KioJugn0CKxHRRlmWNGwFCe6HdrqkaOkeINwaNFt3huONM7UGE59Gxpmk3aDk00aKhpUPCp8GgtNYuKykrbZx5citNlu15lFN+ly0p5l6ysBxuZGRWuhuZmey+yOf+OoBWrcwOtYSbHTx4TWPucfYBygRxS1E2SFpYzgSJCxxzf3twTwLT0PXVEnKsoGGJH6eBwGjBedsoUbaT5tA8kIw8Ci7/0Kk4kb0qGiPw37Ad9L4uFMKpbiwkZvMznVioCsJ0urdEA2Z9SdVYKWex0gshO2MjTeJyWJYVvN1sfWdSsl2dVFBfEaMLmz8TbBK3q/ZOthSX/JlNlgTddMX8LfGgy90Un0X/KHMUl2h3EDZcvKSyEpXTsrMH9/bcltUVt7FldWHbvY/acV7TfOlRCn1NJ0tt2MY1Bqd2pCKhZSpjR2Bc5vqcsZFPaEj51nUuUIXrU8bNs+cvojHhjelu+ZclXfu/qph94j5WUWhVm+qlEHXsrKIBz5e6UVnC6GSpoDpx6XjTC0ENIZiy1x7fILjhk2U6ilv+/A7zF3Ccs2eSjgFf1HQCos5RrCLccgkPbjdaL2guaKoDvqjX0cIAXgJwGLys1x0z0wAwM8vMqQKsMIfBJeYwuMwcBlf0BnrheaBXgByDXtUbjp0LgexcxDyH0VXmGXSNeQa9xjyDrrPOAOB11sngDdbJIGadDBLmLAGsModBkzkMWsxhsGbs8oFuGLsYvWnsYvSWsYvR28YuRu8Yuxi9a+xi9J6xi9H7iPGpXgI/MCM6C/ihhecAP+Kgm9ECRjfx1nY4tyxkzseG43Q4n2Dz6d6pn5qR2fGZhbzjcwuZfhvndAhfWMiELy1kwlfgVnrnfW1Ghv6NhUz/1kKmf4edHcL3FjLhBwuZ8CO4Z3rn/WRGhv6zhUz/xUKm/4qdHcJvFjLhdwuZcEdvDOYy3S9av0QDa5Q92LjdfaK9vwHLHNO2eNpj8N7BcCIoYiMjY1/kBsadHAwcDMkFGxnYnbYy2OnJsTBogdgOXM5MxhzKHKLsLBxQAVcGazZtNhlWsAC3015BBl4GTgbWBgYWBk6gCL/TXgYHKASLMDO4bFRh7AiM2ODQEbGROcVloxqIt4ujgYGRxaEjOSQCpCQSCEBmm7KpsomzsvBo7WD837qBpXcjE4PLZtYUNgYXFwBFvSgDAHjaY2AgCmwDwikMU1jb/39gfsrA8C+Fdd7/58z//j//58ywFQhBcq0MDKyTobIL/j8HskHySQh5podI8k/h8kZQ6MIqCABFpireAAB42mNgYNCBwhSGNoY/jFuYEpheMDMwqzB7MDcx72N+xcLCosPiwtLGsoLlG2sc6wLWP2xFbDPYpdgnsV/jUOKw4kjgqOB4wNnDeYrLiKuB6xg3F7cd9xruG9zveKR4wniaeK7xSvCm8K7j4+NL4DvG94Jfij+AfxP/CwExAReBKoFJAscEXglyCEoJThF8JaQlNEXojbCF8CURAZEAkRki10RZRNNEN4i+EUsQ2yT2QTxIfIL4DQkOiRyJRRKPJAUkkyQrJE9JgcAiqR/SQdJbZLhk9GR2yHyRrZPjkjORy5BrkueS15DPkF8i/0EhQCFFYY7CMYUvihKKQYpViq+U4pRzlB+p6KlUqVxQtVBdosalVqD2Rd1FfYr6O404jQaNJRqXNEU0szRvaOlptWm90I7SvqD9RSdFZ5HOI10d3S7dQ3pCeuf0Q/RvGbQYGhneM2ozVjCeZ8JkkmbyxjTPdILpFtMPZkZms8xFzJPMN1koWPRZ/LEMstxlxWeVZHXNOs16iw2fTY1tjO0DOwu7KLtJOOACu3V2e+yu2X2wV7JPsO+zv+dg49DlsM1RAAi1HJ2AcJWTiJOW0xZnJxc9Vy8Aih2QogB42sy9CXyU1bk4fM55t5nJZDL7JJnMJJPJzGTfJpMBsg0QICQhxBBWgSAkhH2RTUVIMUR2ERCKCIgUkVKIiIhI0eq11lov19rW66XWulLbutRa67WQefmec96ZLJAA//u/3/f7WhMm827Pec6zby8iqBIh0iyMRxySUO4zGOWVnpb4EV8WPiMKfyg9zRH4iJ7h6NcC/fq0JI7sKj2N6fd+g8vgcRlclSRFTsN75TnC+Cs/qeQvIrglegUhvFTYjgRkQd6QG77D0xDGvhoeE8I1IY7zcrUqUR8rWlQWo0FQWbMw5+YMfs5faHVgs5iFU71luKgYLzZsMXYuzElzOtNy3ElJnEPehReSu6/OcqYtSnM6PIs8Dnjedu4iqRQ62DpsITPB9IEcxtiDag0Gg55XxWdhN+dnP8Z7Yh7GiStjH+Iu4nNyFT6HGMxTEBKS4R52lIzuqzmVXD8plB4nEiRwBBOEW2KwWu2p0eljOUlSTdNqiEqVztbjJbX2kJd+wQ4ilTT7xusiJ04OORFKdjqS4DH2xIR4m9ViNhm6/6dyAB78kptzm1zw4w762Y+fc8GPX8rAnIvPCH1oe792S628CX59Zfs89IXts8otlXgV/PrUJu+RN4XwKm6PvH2pXIvP0J+leOkS3Cavoz9L5O2ApRVyF28Xm1EmGoxGoMOhOB+W+Dwr4SQDhs2prjkVA8v3IIHnhUWIYnOxCksS3yRins+qUWOOQ00Uy9mo1l5zKhZOTus+Ga8f+FygBYEX2m9+1uTJIV1pSXGqwZBVaDAmaihWbE5sMev4LCy5g15f0In9Jl8uDhSV8yU46JesNsnrE8zWZGxyp+pEzBWWk0BRLvGR9nsPrrMVVy1dO4k3Tjee2x9b/ccsX/ueB2zFlUuWj0/QTYs7+YD26Ca5vb65ysPnFg11Z5pMEq5IndA8MtGUV+bnzE7fi8cb7hkfTNZ+/qXKsZlI+GuX56WjDfeM8yepf/Erydkuce8umRFvxG9jUWtJzimVk2SfvmB8VVm9PykWuGDGta/E14RDKAbFwcZ7UB56seaUCbCWgUSkwqJqDpyE1QJujQF0oCZOQxDKqkFqNWmSIiRWc8oOF+RcfwFsl6dGuUqDb7goVHDr8+FMepHUhCQpW6LYTzboMcrO8nlTXY4km0VvN9jjdLFaSUAxOEarMmfhQqBb0Z3qDQCLurFfSBUtZqu/sDhQ5EUp9FgKHEpLFW2ilX6Jjz2/65Gzz+3ahQ2ruUdWd+kXjR+/aPG4ceQZPG/XLnnPLnz2w3GEjPuwUTj08qefvPLKJ5++fGWG0NG4+ScnN27oPLlRJi9//OnPfvbpxw0bTj69cePTJxWe3XTtC+GisA8FUAWaEprowByJA0oeJBKVhDFS8dXAhjwn8GuBzDRYUvFSCyCANMGifTVadQynUqEZWCG7YDFCJYOLK4IVcL8i4MZ0d0VaaqwqKctjo2v16bCy4mCAUZ7gLwSqA3Lj6dqBQw0uyWWgH9OCBhfDiHDOcufauWvjpvz+Rx9f+MHutYss3sq6e++beHa7edynI6Y3Fnh0Kw/gdt1O2K5rqHRUOA/r98n3/nj93RvaEu8cf9cdT/32+IVYlfbw/pHz64pTjaKlQ5RMrkG1gYdmYVG+skleXlXGPYEXrnx8x3xgKpCDOJnJQVNIH5W6VAbqCRWxUelHBR89ihbLneSQ2IBikfisCuF84DORGPRGm5SGDHpENtnevPDir2zyX+UuzIsNjTPlUfJB+Yg8Yk7jfPwe3oIfwu/R+wyD+yyL3AcQn59lCvL0BoKv2AjPHmbGNgqu/BfzGxcuCHLjPNkj3y2vkD3zG+fgn+KpeCZ+AQHUi8n3XI6wAangTkaUEnLA1XGx2hiNWhR4kKdIj0YB4LAiG1ZZsrBJ8kk+E+fn4rAvGIt9gSD+5t8bDxyccFE3bw2xyqlk/zWU8B1fJn9f1nWlDIu4Wv5rjmN4S+tQR850xHCwDJ3jvuV1wJsja04lAItZBEwfhTnUAtjjpyGeT8fASomI5zA/vtdRnqcI5vGYySE1k996UZWYhV0Gt8EVcBmAILhv5XXtIHnXbMBriFvejee34znyXvrcbfI3uBJ9A0tKDiWpJIJHMbXVBM/04lqCYjRIT/QccFuQKUVR8hUHqFYsx2/705K4EQ1mWyJ2fePwtHdui79nbXLiqjQn3HcXfpXjSRVgMz5kYbJ7PNwSTaPPHBMhBICO48PbyVL8agf9fgv8qgJY4lBiyNYXDI2E4khcDxg9uvniYI/D4RkMqvkbpoeZRlZwGrx2L/dFDx1itJ7SIY7QoQ0kxusPc56HN4hahY/br13m60E+xoK9kA56hxDUxCvSieMYLNm4FiOTMU4HQigWxwpUCKVQ2nKl5mIS0Bv5FKI3phj1ZA7W/f738jcbX7i78BL+qXz4wQfx9E3CIfmEvEpeKZ8Y9zzW/QJvwo0H5Wvh9bIMu3kfgzkHAKkGmFXIHoqn5AZPraZg18BhL6q1MthdbkNRUPB5/KT6jEY+moDnnuFnVPkXdOyg91iKEK8XDqIUVBjKc2LMaTAYAdWIKrfIejAm0xATzhg5qFiNQSk4ha2n0MmB5JRwsd9lcQWKgrDTvlzenQobT7Imrlk6In3RQ/L8GR34g667EvG+zffzODFjZFXxf/xS+2fhoM5XuaC246MDcqmqcyk8/K09f5yVPthlFF1biils865d5v4GOM5DI0PDc7GAcjAvSJjjTZhwICh5xBGea0GCgEApRzRDD+6zM13JziSr2RCH8nCeFFUCOixZnJzNCgLSE1Q0QC5xA32V84FcToFd/+UvU5vqKpsGJRDuP747J/937D8eObHdVrJ0vHwFi0OnFzlUxD66eeJPLuj+Qzj08Lm7trbqVTEl05bXvveGZ6dl9b7ySdVp27Azp2poTmV9bpx+iwfWUwq43gH7ZUZFoQI9rAMg5Ug1GH14NPAonMHh2bAE2D9QdtOUTTQYwbIyMi6VKJemeoPYj0WQ2Yag3+Dnd5w9Hj47sTEN7zwtrzAke/Dl5C1n8UKTfBRP2TqWq+96MSMLP/7X8CqFzudd+4z7L4DBi8pDJQS4zABw6AGfHFAOYBTza0FowH/3w+nCNMCth1I0mQFwZZNac5Y7wxiRGZzNyUlmHaDMR/FYToLFuUIezsVBMAWPhjste7e/uDaIzaUzn1rybx9b/n3frLbKRIKNiSMGtU2f3gSgusjn/BfyWq0m0HpgWc099zb4i3Z40sbOqhk0rjQjwagSRS4nhUyn/Lbh2me8G+jUi4agqtAIOyAuCfDlTyO8wFXT3Rd4JLRGVWVWjQQGQ5QW0n0YFeT5hqQPSXYkxmtUyIu9KoUeDGwBuTxoRzGqHTmpHJsKyzkwDdypomR2CuTQH54yDZ75xJLZDy8clhGnd+dX1S+6u/r4MsOU0+MWTvU7+dE/qqiaVeLSLHx08qYJQmxS1rAJ3L6Lctf0TW11uUkjmo/8fOv9r++7u6HIGZPcrrKVLXt2/bihXZ85CiZNHXl6W7B62up7RlUkG9ge1YNi+RD2SIMSQlYqWSgpeGoU+WYypXAqW5bJVWiVwJApDrrqueSKQpM86gx+SG8PVwgdw0qufM+3Fwyi+mnbtc/5OrA3nCgffCfY83gJeAbEBAcIAkujVcRUdCHGPYIQxVhhQUpy6ZCCysJKnyc5PyU/V68CUYJSnMSiB/ahli2RxFzCbAuvoagcC6k6zCwqirdcwlEbA2zeiFWL/4K1Tzf73vjBnIz553dsv7Aga94P3kyfjYMrVufd/fTopmGuWGvFgon1c2rSDUUb2ppWVCbEj1wi7Mu8q6NF/o1VFXvhVMv6piyMM2c82PL0i7EqG85pebCpNa9lxs5pOmdJbenoiWW28EM4zj10cuWsuYUJFXfWTGwBdQK0sxRoRwTaSQcOBNrJTgKasQDJm0GycdWAByZHWvuXI5kZGBUXZZRmlqY4460mA0rH6QrtOFXUvu+hfmpsUYyUE1NhcbAoFwSMjoA5SQIVLeOHBbxJBg2fUHrHA7vmnG4zzHxp3gPT0vmaw6vn7Z3gy53bOXfi5kmc2pCcWVZXNGFJiRWTu4WDmgRXcdmU6evWT3z8L0/NLbMld6gylr92aMLw4T94Ys6aU2tKu94fUjNu4dLKSrdTkzll2fjDj8F6twERVXMdoBuTUVYonYpx6te1Cr1cWVA7KNGmTzYmK+pShCWZrlOX1//9FtWcaX1/cR1J7qX0j6XupPBCplAjWpWgvWAvNDA4UlBxyO+kZkh1vI1wowYEyZ6oTzGm3AqkXobFuyVuh8NdAo62j5oYwxsttkROgYrqegYV2BsntsevvQfsDfC9MVqIXuJO8FrwM8RnRQ5sPzWx4ADmToQnkWNdr3AV3Dr5I/nPW3HTFtxM14HL+ARuKfPVU0PJ1ELhMBhTHMA+nkocUI8cGdPttlNLCn74hK42bh39IV+vC//7esbbO+DZb0efTaj9Co9W4wD3dtfL5BgFYIv8xFYcj5O3MDujAZ51WjiN0lARKgsNSQKSpToenoe5tczqEBjFggPJ8U2gN7x8rc+DUV62p8hXlGjWxqA0nNqj/ATJ7S3ngsXMC5B85eL18Qtifuut9FDd2GHZZDepnNlcRbh1WwsmDKpOnWDSxNU7RuTVNIp5FOl5gHTh9P4nyheOrx8/9f6quU+vbF1e1jqTEIGoyBpOJ2h4gVwNMVMrGvfYd22jkMV3ohCqRZvP1krU7alWYheZalgJ1T0tFNMqDhwfFWgoQQUuoCCKwnhgUHEaEgVxDPUSsYqoMFnbz0WICCpywzWTQwkEVVcNH1qQk52RYDHqY8BERyFSoaHIAXFqMbgVh4miwe+i0t+VqgMmd4pg3vBuMVekWgILOgwIo5ZDkLyNPY/ub9eHPl65esc9y/Cx2mb5SmnN+LziRGdMDMfbzOVFK2ZOIwb5v/509/5tE6rSEiTRljy0ds0WkiQ/UlUyvPLONyr5zk37wu37hs5ds2pO8+JJ40YQtc6RVlo5e/GYlvUrhw+yGUi7AUt2b92k3Y+vWr5vx4QxHodKtqq5QGlxVcXocsCrGbBwGXRGDDJRngcogdoEZvEz681TQ4NLoD+0Wq1JazIbCw16SZVA1TgokRJcaMPuGOz1uUWJ4w6Fz2/5KX49NngBXJRfnL/wrFE/JCb+ND4vjxQaCwqunCATSEFxWebo8FtUx5y+9jXfJuwBSzgFvNKhoXItEGkMWBPUjgS9zAktVMswiepjipkpHHBgU102a2a6Kzs1KzHemmJLcadTNYMjCsad4jMUuwpB55hFcFFcTCMrcRKvz2Wwcs2PPpC/9Mha+eTzP8EpD55YkX+3vEv+EufVt1QmPbB+0vzRjgdPyW81ko+o/li0rdGlFzoMrvHbFu07SOJkD7YU31m1renqNvOg6bWHl3PhfxDGo2tAX4wEfeFEwVARoA2ZeIDeDOKLGkm42zCOiK5sDoxNGxAUGPpO7FQMY6tiSgDoTuCwIHPHiaHIWI7JsXVP3mk89/zcTRPTbP6J9zT+6UnTyb+/9beFQx78tXDQaNtkHLTpnSfXn99U77FtyN+OS7HhIjaeqlX8jtPXvuLfFvbCPieinFAmtdOnUXB8NVSUMu8ZNjlWi1G8RZsYm6AWUQzWiApMIGGp1WtIA+sGg1qm1q7BSo6/9cWCBV+89Tf5v7Hto02PjYz3T1g5bv3L54S9G+XXw/8lv77RKHSYrvxj/reX2s9vqPfwV3/IUzwdvSbzZvB9E1BeKBt2mtoTLSgChQdEEijUiBULvxNQvMHkChRQqvPYRDBkfYZy7E+xSTTyYAAHgkYieK3qgjx9zU6Md67Bhy+owm9UlJKZ4YOlFXu2atffzR24e71227CR8sUd8pqqoYpN2wm0rwI49Cgj5NUD3VEJCSIZkxY4zqQiM2JBx7gNBhO4LpTuow8F96gYoODk8FdVw0hd+PSZnWvxI2f5r4aOkl/YGV7Gb7rnQR17Thv4fKvBH3GhxaE4sN+JAQtcCscsUCU4ltpjf7LVN9FAjZeZ88pHGlBMue4khiJ6TtTkmByiz3MhV7rb6zYwLo2IJoWCeqI4eiaFDPzqdkv1ux1f/Kb04d8f++iY8cQrdyy5qzTLsPH4XYcncwVdb+2pbsUz8Q/eweafjMjaoDfk3dH+7Br5dblqKPEoODwNiDrK5IcvlEb9AMBiiygQGnsjOLqHMSiGRQ0iMBko9mhYnT96Jrz8zBmyVei4spocDU8ROsIvkuHKffHsbr+6xzc1RH1TP5595ozAfPqya18RLXzUIk8oVcLUm4U9JMzyRTMUiQG/tUjrdvNUThhYRM8Hbn7AQLRbH8y6O8Uy+5DQcfXIY4fiYtr28zO717YL7muha9NTL4vKJRoQmc2z+wuKaLQZTAaT4ty4qTaApZklP/W2JIsV5CMRO7WnT2tP4M7X5OaEwOBk3Pkrsre2OiwLHfLIcWPJ1PBZT4Avzg53KHR5Tea+jq5HhDV0rweOzlA4VVlPanQ94NYx1ggY8Ixho7CsPi1v370ZVrRv5NCtuu2r+TVw3z0IiYvhvsyqApuEwxLXQleCpokqQl2FyIIISrLbzCwipVFJoO1SSIqaigLQ+RaTGyQ/Vfs+TKP3ig6w2vzFQVwsJP/K7St9zp8lv6YvP1xhkl/LKDgT5Eb/+xAjVsX50rJi4B+hw+e58jr/9dUvy8p401W9MLi2rOuJgm0HvNyUsijev2H5CeBL6utOixAU5YfpPVRlR3ZzoclcqFCVmYEEmohtQVEULEAJ/83IU4NtsntEjEt1pur4YBt+K32QWwKae7VqMPfXHRl3zL36vlBWNbgrb+zaB8bzVF6uAZ69BDxrBGl+kzhNYoLZFKNBRmzsiWsQHU5RIjXFfIoO6504pRzrveTE2uc6xnoHb3hL/vmvNwxZ9Dc8Q/704IgRB3ES/BYO5bWe/ObYb+TPO0eP7sSW32AbLtt0eP63ctW3CxZ8i899G5HjgJvpIMcNKIlqGT04IbEsGgCUCdYdmDxUZghMskeDL0kJZmOcTqsBn92gSHSqGpkDDpgq5lxMM4JMJ3vbjy3KcZbN2zxrz6kzz4OJO29ZYOX+D+uFvelznlo/75HWkkR9+CII9bAXF6y++9gqQvV4m9zMvwe4MiE3ykD+UH66z8PhUQLuF2kWM0CUaHZb3ACRCZvE3ojr1na2VIa5iB+IcdAqSGmkM4rCg7/928LBG379+EMUgQ/N2zTZM+qA/IX/j3joEPmfvXG5GfRg/G+wuXN0BJeDNv3nk+/9c/6VsoV35T5X3I3TPYDTBLCWQSPFgHS2YEytkIg8A2OQaWxfVKRVZqcahjOOd7m5XAq1m2IyYnNQR9eGXVRV0kCAm9/zyhr7lFFVv045/TwuaHtqacF9mwc3WcOTcOHjq1Y9PuyiG58fO4KETwFivdP333PyJFjMreNxFlny2KMLFduC+qJmsC2KaLyNxl8c1JbvY1ZEtEM23XKXMylR4lARLmJ0GbEqaKDeJjAjiUVf+GA0eeRRMkyk5OqPtb94I5obGjsLJx9c66m856F5H7yrxZMnTWwelWjOKyuU39vzA1ugcsly4SDvaddEckG+JTPiR3lf/MnMDRPzjL4OLdEXTqpmiaHq7iQSXUsB4HsF8LdE448Uo9w0lqtRJFuPO6QEl/kVcvCMPJiv5C9ftfOXDyl65xjw5wm4hwG5Qk4aMKcaIhKRUMS9ARncJregsoFs0BNXCknAfoOSujHwJy7Ln8sff3HmkfMv7BY6uvbKb8phzIE7Nadr7yfPnvmYmwPPcAOcF/p5Ro9tAs8wmfz0GWqsw9QV8oHYV4Qhf0FuVHnin0/0iHLjeVznUgWNCbgWpE6n1eGwCg1XD93rqq3np7P1VCAkTYBnZTPrjMo8lSRwFCs0bYim9Ui9bJRtCZhMRRa/WmXveS4Hkk/iuoEwMSBM5biE2pSRv6QJ8kei134xMZ1/36DPcv5B9CW+legT5I9+9r7anBdrfk/w2F9L9IrvmVVFRtWHAOupeIczgfdVTzh09VKC02kT6q+ezv3BuDt5kz0lxX71y1k1bTl8vbInfsAX0DCKpRIzhie9FGZLH4VpNBiMkQyCG7vVmOpKvxoU5Ra/fOg1/JC87d9wZQmufFXegrf/nOwNzyHvkePhg2DQTQh72LNsERqKRY5QoopDLIZNcI+hYDMaOLb3bkP3lvjJoTNy1ss4w5Yel+rAGT/DX8t6/C23I3wif8mMcjJBWQdof94H91bTvVDBXoB8HR0NZ9MENzWeu2lAjdQGmti3ZXksrgB14i2Y93WVkK/DDu542Lhv3z6+4dFHr3aye5+XO0md6AFZCTgSmG6PoghRQ3x85DmYjPG4vJF0PjU5zdYSbGEanjqZpO5trcGgfVt+r7CsIh97hNMm3b+e0ZmWBQeJjxaU9+QmvhowNyG4sZ/7amfXezuV5ARGjXInvhyFLY5qk2r4noN9BOscwBofsdEJHuM1eFIobCbm/4I55QowxiryZuFG7C4oKyuQ338r1miMfUv0lBX+q7WwbJlJJ47Vmai9Rr7hsviLwP+Jz4jNlaE4gSegx2i+a7mVZrueEVElplFKIGQua6R8SS+/W4WHrOGSc3CzvD8HK7jcfm01T3N/HEph9xkgB0TvJlBBoqcxlQ7Fxirh6wgS3oBrxWc5msfDkidIUIm8chZ/sP67DqoX5lz7irvIyaAXPOj+UFw8wGjDHO8QiSBSy51mqVPoHQRObGF6F4xPlFujwjQgShRat4NZfOMpVNSx86Iie3IowZ6IUYoz0WP30NyDRiXwKAEnqCMhmBuDDKmCL81kLQ4GIoEFsurkjzdZqt5ds/FHO9vxoYnLd8p/0mOtue61RrltRGk1J+94OjzsaPWinesXrvjBpOl1ietyujrI2NG/IlzlsIq6Krrm/aBnXMI+kGzJKBQqczr0HMfHKBYGzSR3mxe5LHQUVeomI0b2BGOyKTlWq5aooSF1x8kJtbWZTVwM8ihIvUdRMlnJuZ92ZjWfbFsYntFpevaenfdgbAlOHT1q80yyhZP/IX/e8eLm4d5UYb68ZcOEs11ryNHfzn/wzrSqMeE30xT6XnztM+4g7I+ZWkJUJ8ZyQKC6vv52bl9/2xCn1Yg8MmOzYrAxxaik9KmzneLVF5Pq1+63btj43ObNzx1tM+1+RQ7/57ucnLdUe/C/Lh0yLy/6koT+yuyGZfD8byO4mhPS6rBAEhMAXQIB4rAAcSRRFPlofJxtc+71Dt0Nh29w6IC8nUk2C1U0nlTAKRNoPpF5dMyhA3mAmJ0E7hw1RETu2w2GV3/5wpONT6x/4ceq8AcFMxrHti1qXT9qyixh35XZ249hHse88qe7pjQuwkVdf5d//+TQkjricySWsjVRnP4ZcGoDL2F4KERokQwADLsv0JgM10LDMBFwxWj6FEBNiKdJvviUhBSTQUfrJ2zYRsPdHkAr0G2KV4HXajG6XU7OBBTgKgyAlTzzJ0+bhn44Uw7//q6fP/nH/+C+lgvE9Pp5BQfu5/HRBWTx6vjldsfXOPnVT+86fET+0+S7wWL42+af7prRoNDAYGD/DOEC0MD458CwFGlQ0E1RD0fFJiSKWawgCU+jqic94s3TDLcIV4uKXup7cHJI46a+qilFAv1KUerAir/vDgQDwHyFNs5+cWY9rpBf6XzuuQ2PnVgo5Iy589CmriPc1DbNszt26QBTjfJMHjgOJEcBKkfLQwYHeFh8cQIREc3cCXi0QiLJNI2AgCJbGRlQPw/oQBSZn5dPxYe75wyOS+9NLT1nTQ4ZfN6ykpwsb4GvwJCT5VFRvSEppSsgNyJWn+hKYVUdubg46FWW4sKslEXhAVzk9Xki6ZhivmJXxiufr2mwSflFePnmu38t/1P+5rfVU/zOjNy2n325YSouDX/wyMoVux9ZuQr/OrRAPhEsWH3++fu5Du2wlcf2WFKrhqhKLevbnt7QcXzyvLy01StcI18+8UiC7B7f3DJuXEvz+PDear8xL3NC+ZxhlXQvwbTjtcBPZmrjmrSEhax53lfTHa/OjUYjMdLH6WKZjARWFrtlpEFJvVEf3ATyhsjrN58KjWn88frOTqL9JweiJGwm52eNqRoXLhD2ycvvrj+t+FXwbDxV2MbqlmBr1LA11m4ZwqJA6RF/yt7rgK/3gcmhOIJo9ZBKQDEkRlDSECCZwSQDqW0CmN5pCAQaAmdOnBC2BVYE4L8ry7jL7PlBeQaezp5vQaPPgOIioxQojOxhHIOCEms6haDnS1/0SyABrZYgrUVrGeD5oKYlHzglhksNfj9AMXvKXaXBKCDypC6y6uLw2uqdTUC1bC+4r2EvLDQq3Df2EdUD6QPHP0x94h/4zQ0awL+mHZe8Kb/uTM+y4ylv4m+nVsonhH3h9rqp+G55Z4add+XJLkoHh699RWrh2bF94x++7vhHNot/xKLYSDyHo8aRTSlaMuB6MmrYDIt9cfaS9cK+q/cMG96h1XXcyys2A6xLnAMrTEYzQmpnokXLUypTeNHKYiFNkgj2JJAaLWtUNDhIC1GpgISjNFLSc3ByyEYFH61vBMGnUGQyTu7R2opUlvqQpo1yXrEw/YGNJ8iohtHrVx+rqa968L7O7Zq3X387C0yOrQ9SMp02buikcB4533QH/Ze7fODs6dPdfAJrMKI7zhoUNlEWYFLCFALpxSn2kI3t1Y08BBTTi42M2NgvG9kYE3UOrWs4sqVzl/aLKA/NrBvVGC6gQCElV3qZtwNMMYr12B0vye0bLzHoo8V1Sl2LFdwAEEoGfTGfIuqtKcV6MhLj3/1WluVrv3sHH5HPrV6Nq+7n5K/kj+UPv/wKJ2PnV488LtcdOoRPM76Vm/kCeK4BVOrSkNaRFAf6V8W8dwUnDpae5USGk57kPsVHJmUlV1SqKjncfs6BLabmTWK80WvyAHvHwALAwFGSudSPARGrkL2N5f8jbr9kcKrIe8/+6MxrPz8hdm7X3fGR886WwpZ7xj66QBoaV2zKSfC5OFn+l/zf8uUvWke2yx8I6x4fP6trXdmhnW8/Nao+/Dkx8DpOw8GmAX7lZu5btk4nKgkN4kAnJMSrwNigUYpuk6w7BkANzEyK8KREqzlGDfvbHfvhbQY3VxSkEVDQyYRTMlIGr6QjpKAFXWvqJPqfv9F5LKvl6W1Naxu2ztn00OwlxZzsTblyAk9YMelwGOs2XNg8NHz5paPlo8jINJ5UHovyFqcHGLWo+qxGoKVjkT0wUhJpAg8aJFXEy7ezCoV0ytJcE/WociMHJoe0LLYZYzC5mPMu9eIaTm8eXPf4xs4Nxo9/yclHhowIexgFYjT72l+4E6An8weIj+T2Gx/Jx/nR+EiaOxPrOIvZSXpHSKxBpc4nEiAh+IvPLujk14flVgW98TH67OxM7F69wF2+aO20Xz+v7Tx+8h5zQU62/PF9c7Jmb+Jk3t6mUcU5MlO8Bcl6zVDnvfePnh1yxzraYriiiWl5Tr1mmOMH901YWGpR/LWvyLuCFvRfIFSoyD3Ec3y7JALiODBSGKX2kYFmZKamSqpbRaUvcxJZyihAjRUaYrfgfeWjf2hpemBN+3PPdeIybmr4bFVZR+KWdjKjTYN98qVNbO/2XbvMfQ26yIjGnDVwNE0cSU2YwDljGwVO74xu09UW/ZZZrMDhM6IWayx8ZURGtykV6C0+aq4CQH6DqFAa9/VW7ae/2rCpE4+aWHNgBXe5y77jxNYN5MtwZdOY4bXkEoUHvHzeBvDoumMv6dfFXnRIZzIWKrEXJRzNgh5BE2+Td+lzDubq5UfOf5ecZC/7Dh4xMiuLOx8eOXFiJzkfiVWIzXD/3OviLek3xFtyUa61yGQMWAuVeIuohFtyMct5soBL96Oj4RYntvnLSdAkNst/jA0eTPDyRySLkODkD4vexMeCsfL7Z94yx9o9TwruxIMJqeIRIUFI5LVa6S0AtbbAmUCOJi2wbrKEpyQ4C7gzYdeout3kWIIzOTE8xTbLbigtsJEP2L7lAZ40sI6BYi7pt4y5FGTIf/oZrpPfvIBRAUYvyr/CdRfwq3IZGMafyC34MdkRltmzPPIU3gzPMqPMkA/Ron8Or40SAnVoEeW/CFmaTB4jJQA1JgJYHRVUOUeCY0HMm+Wl6+Vf65d3ZJgyrKmivOc8ViWLjizMc5evfiofilvmaWvOirdw58IJdzrvJZ/R5zeDrDgFz+83LpN+O3EZ7lTXGbIu3MGFwm3btm0jb2zfHg6ytU2XnyBlYqESAbarmPCCGzJEtrLIzET6pCYamRkLV6ShNEMSuzu20PCMVZRg02l80SLSGA2Qh9cXKA7C/2nEhgTmjsXVC5fUkrFzX3jKnpEv8aP0SRx+SvQsrpsh71w72+qetUC2T69bHLtxN4ktKLaZONxm1VqG6q34h7s3URgvyEdxiVgB22sI6WhjQTuNmEQrng1+XNLWJh+VHqXnNsB6Cth6CkK5ThDtLJgDKwIKaWXRnImRYiWCI+uhLRqwIkuWKVBMgzqwHhCGFlGi0SfRF6DxHeq/4yCYB1NeeMrkzedAr9aYXE+9MHcsGbNkYQ0eK5xdHLtptzy3LGiLowWKbQ69oyb8j90bYxfXTceXF8xyW2evxYtm1AGMD+Nfck+SfwdqaaDxm5pTBbQmGVQ3ZfSJ9F/EPCJExtpD8SDF4ePEnigZPQSbAWY3RkZDjFoSo249ix9ZeZu1OOC3ij4Q317R4vYW45Ia7CwL+O6Mndww4vGd+QHfFN0U8ga/WBQLh61qE7hBgwUxUHlfm+ITnJIX4+kcrRW2oNeU3o8e059JREZ5maxlwdDnaO51Ry03vdZ+02sdN7l2oMsm0/9Rf8RiNhqUsiihv7Io0Ksm/ze038hNO48e7jRs4b5h5U+sPKvrk/A+MhsvVPCxGPhvv9CBbGCDlIdKjHoicHYTEWkYU+RA7AgCNxGJlHdE1CphQWAl5dHAvsVgMYK2MqpUSbT6Pg67gZbA8nP5o20tXCE2g/TUYW6TactPjdNM7555FxOtvsmwrdq6Ykr5Ptk+r738qfV4zvJ87pVX4/6GNTj5y87TescKHRfW43t/+pSB/FU8zGrdEe8RDiI3GhaqMIFYcWEkEfAjJFozS0C7SgTTiBwLDWXV0BadXsLDjVINpkKvwWKgQp8KkHKch90+P+ct5yJ5dNFmckkuG3B+sZ/3dE2ZNUKlOkwO6PmU0rnLxu3+vWbHf90/TTTg07w8SSMOnxgYv2/fPv/LDz3aivVND96RG2fZrpq+Wv6m9dEdp0dItFYVdfEB/ghKBG6sCVUl2EwGnsOJei3hCQdGHMcjwlXHGwmu0gBzjKKFvwRzrSDnYXsm8pGKTILGJtldyfa0pLRsL204Q3rJJlEt7JN81O8P+oLMAwnaJGwtZsaq2cp93fDDut0LNm6Y90jDI3UNO2t3LNywecGuut3yS/ecPHnPfSdPco3ydwt31+5ubNjVsGtux6aFO+oeaWjcU7cr/Bnp/K4T/gOAqJA5BjTCKCQRI3UcrYEh1SpAP6ale7NFUAgY7FauRcP6xZTaM6fDYgZxbWBaKob2QbksLsmiBF5cPlfAB79AfVDNSiP5nBlnyQc1eIH8yBn5AGxljHyMYLe88DzO0BcIOq8T+y6QPfON8+fI5/HIOfCB/C180XFPzIxyElDo+SWQp2VMnt5efR5N7FMxW9YG/+O0nP/7Vs4P92mTz3Dvs/qOSkpt1Pr0YxoFRFRCcWQtghUT4X4kIF7gZzGOZfWi1EAfVFSY5061mMEadWGX1J2t8+p4i0jjNkRyF3sj9ieH/WI0g8e7vWCf2grL+QA7Toj52ze0P/wifWRJbooRV47ANXc1Sba2mNKp8sH5zWkVc1fKH7TFDJmOZ86dnRAIzWoa/rvP437+SkHRKLdHz1UOk8/cNUMtHOItGzQArT4hI6my0Xe+aOszSzc8Vvxm2eYVQ6cNSdWGV2/aXfxG+bYVJZOGpJlEzrophiOi3p7trBzvOVe0+ZSC2yP8OXJc2AL+oA0FWHQ+UyCs0wBNZB8QbqKBRTxWpyVgxGptOpsStxAjArx37MLV6/NvS/LySvLwY0MKCoYUCFsKlhZ0/wc7ee+1y2IQ9oLGZIvQLPbkSalY4HOwKORiCeQUkCIYJcBLrRrwogSRF1qQiCROlFphwzCIMMVj5fBYVwr1/ArysjO97pQiVxH4gMmmZI2KelMxUUVTyBstZiLy7tQ0LwkUGdNsqTzRG3l/YRqIyDTp+hhzqldfzE16E9f/fNlr8t/3/lD++2vLX8P1v+qU/3DyJE7rfBqnnTgh/+HJw8sM6x94ZMmSR863aB946g/PPisc+qn89NsH5K9eXrz4ZWw88Da+46fTj8i/l/fIvz9yBETsPOw98nzSLPGhFy88rG1O/hX+5k3Wc0Jc5Bv+PZbfPtKTx0iJ5jFcNF4qReohW5FAiyfxLCSKLC87SKRKKINWKfWcE81ogOgXJqJIukPAoKczEBYoua/t72TCTqZWlACKezIoe+R2OR298x0q9YD5DslXDA6atVBJeRDV8pVz9cUHpkxb0DIF55SMnPaR7sstg+7eOFi+Gszj32u5R85bE2yYOqFuzOTBgUGGmQ55cJo/e0hWh4HLivTB1nMruBOw+bFI9VysRuQIremVcAALakz/wbIsY36KfAZX47fox6nyWVzFLZZ3yVvK8MEMvLus5yOzI/diHZ9AjgCrVynxu3hEaX4xlQSYjOdwdwqNBmZoTu7GI5NDMbSJAgkGg1LeQ/PgfMLGsESOyPOwoSPS+0Ruo/eJhHeQxaz3iUeLiY6TQSdSnsxGAdTMuGOyB6slXC1SiQXG/FraK8lJ1EqUkFolqVuRCgm8SmiNYYBOjMHddiMtFwz483LSvWnu1BSnwwRsHGvraZ5U2ANsEORORYEiZOoda7Y4cTJoVC8Y0G5DsZ/1WXr85dhXDF+R4ItYI3/34kvyd1jz0uHLf3riR3/6E9YnZmvKJgy2DH24YeS+ZTMGye9uHT0Y42DNVuEgO/mfWPMzuLCr87MjP/rzn3905DO8hufS3ceOBN8jRnHYxLKhFpIZGOJVcgdr+A/IWWHG7eQPKS7J2fDrZDD/wTpKO/O4PWQNyBkN2IaD2NU5YIQBhXMgV64XI9oYsFD1MRatReSRRimrVHBjjfaW2qJ9pUVevGLB/gPzFx48sGjYlDuHVkyZLBx69D8fe2z+vH3zJwwfNmXK+om0Hhpt5+18AYtXDwoFVALp6dUD84sWrYiSJI4HLpamIUmUxiAWm+4uxVPToilLTwMf1be8XV7XIbfjNRvCXawC3dUuf4lN7Vgvfx3+ezvDGfmIdIHOtKPBoeJEeF4CLFVN1Vw1r+hPrvX6RDZG8VZ4tAbZsV1QR+uPREko9gtK+1cxKywH/sZH75jb6KmfJHcVTMXDwuusWP0kIHDSD3aodooVcRljyiq3TJJ5cm+d24rR4dbBLkOrk8K1mrxNPhSHIR8aHRrpxQLyAD2LkR4lvlejT7T56zoXCKO01KREanLptMiHfZI62vvLqnlo15cv0vUF5Bnwl3MBGtilIO873l45oWks4bb9uO2U6p6Hlk6qae3sLB6RrMH1Cw41qn4oDhu/ZOqiWD52blPHKmurZviEYaNbcXxOhnN4vqrZptT38HUk0CcfLfgwCcirSvAMofK7epyl0GyD3MBdAR6Oo3VWtO2eBtoIS872arxjMZlMmu8EDhZBCsfhuEi+EzacFSuBPaFPI6+9cH/HisaOrks4WTjovtIhuDT/8nHVti+uYvtfEJMze3E92UR7MUIOSmGgv6Ntk6C8e3dNXu9cvDPYncyaPZLJJqdbcSnctG9zpGzDj197FqSum3FOPKiKUdRqUhxaJbQfz0UKAWzBYqukw4B9SiVHjffP57iXdyU2ziWk8HhDTHDyA5vNU7n6kCeJwjuSfIRfEgtAZgG8Pb2Nffnaqidq5jIXBcEi9uOXNomfGP+2CUi7I2AvmT4J+Ote4uDMoDM14J1GemH6ZW0a0tbGiAJla6GbZliajWcszZrCXz+3e7f88J7dOP2PEyb8cRz/3oFXXzlw8OVXDyyYs3Xz7JYtW5k+Wgj6qKNHH6lFQlifh0+Ng5F/iFF+firmZXkqOS+fnYpFuWsqsWXIM8vwCrywTJ7f/REoqQ4hcQfr89SCbdrKcD0VUMKJyAHqTRdLBAncNhFOEFVrkQpU6ngw5mApWEK4BVQg2AKSMBupVGQaeBcqMkatRsiVkuxMSqT5Dn2cWqvWxmjgBiqrNlq4EcGqQU3DTJLFHVB6DznaexigvYe4TP1n/d82cs1dC9dwu/DlmevkpcEiO+bbr6gtNpyXMGcmCZCO9HTYiq5TXP2V1ULH1TrNG6+PKie8rDclfr1F7ois70xkfVloPFtfNd1zHmdiic8Al8MKJgcPFh8PyoyX5lCLE4Q0CEmBENbkQaZRf4SM0cWme+3A/7FZuiyDwapXg8HPVhMlEs6N/aZegkuK9K0GaRcokwOvbWTLKm3j9qypiIox/514OAm3W7BqwjhsLQhkb3xQvad7dXRl4Uu9xVoamESNa4udHqOgn52MWHUL+LJSrbAdZFsWCuGJSqyExmbtSSDk7CDk0kDIgUurKQUeyskm6hix2q6EU64/Rdv7FHZUGuDo5MnKQwYhDUgYDV6rkwg4MJzALDqi4UiLlqITdFtrLI5BajFGPRu+weI0FRaxOCYCQSlcryUabT/XIy0WtePR9TdBWi27h5Y27AzXYUngBYlfG70P+j++C1iaSenpoYryspLBxYHC/Lzc9Kz0rES31wV2Sxw4+ErAqLeMd/sCwUgnJ+ytv1sTDEjU5F2Q/+tOqdavXzylpvWZZ4pGODX1C/ZPUj24+fj6ERPvGsu5uxas4R7Bb89tk1co5P4vlTkeZ9jmzOUcVDHEVIJi4IEgQTUkVRaoms2Ni6YtpHqDqPvnAYIa5VruDCeDfC5AM59TWuUUw9MJKg6MSm4t8ze780P8DHC4M/la+01PyOdpepCg9DSH3aDv6avD18l4zm/VCZLIPBudYsqUCwRl0cYt+su4G7tLRo0u82Ghfdv5S9FGMH+0V4yTHe67aVMY/JLrx2yYOal29MTc5rtM0Taw/U9ULBx/R+PU+2G3aa/SJ1IdfNKjeBrXpNEPUjVwzxKYOfGGeLOR1h5Rc8cTxHTaDGZh+l6NS+SYvGomnvli+Py2F/DrYlr8S8FY/PNzF561S0PiY04Lv/2uQ37n6g9pF5MtMdLG1Jg8OpO2Mf1vwOXDNq5fuPyg/ZuTBgQLrIKOK3/vH6xuuHJA9JlREhoSCoJsxFQjVtOj7RIWEY2EsfJmpQI3MrvHYrEkWZIofBYjSyzRwL3kceP+gMTzSrBuDTaUy9/rcdZAsL5fC1qrq/b1q9b+wI3CqgNrOpXO6gkVs/g2WBoCaldjFeJ4FTcbSVKktZwmabx8rdvtznRnUkCtpkS9hgYW3d5iGrbuHfrtH+wtDdppYwNzWvIGZzdopzSULJmZHswklgEWICavvFfk/UWClF+29D6RDxQLYtHVOwfAPa+sR/yO+VpptCI5NBo2PwYEFgJbtFWL1YgX1HwL6FbaZyh6ami81CvUejw0IOLJ9mRnpKeBc0xnJ/UOj8RSLnTTQAisB1jR1etzv8SNLysBk9LBhYWDC5IHWp+7dyBlIFqPrEuajdTwyYUyUAXId6VnispjJHKoVTPg2lJTUzNSMxjdp5nNLMyHmPdDxau3Z7JO/0x66VzbujPrjs6rHFFUPOLYQIR2bvXUKWvWTJl6acSgwZWVgwdd+ccAe0Suyddk8bKwATmQF40KVaZi1uAugDEkiC0aIDosqZQYscIdahYjjmQGneB2OL1OL1ydZDC5/AZTQQwNFbM2nDLswnQF3V1qgkWguSGwjYqDsBgsfiC+Ks+fu172yP+8QF6qev0lvP6/xPB3FbVkePjF4VXym167vqRUfmXvQ9rNCy7Jfv7YA9O022uHye+SHUReN2oY/hWxZE4wpdwVvsT6VcIy6z1MROmoLWSihg6LvOpZNSQsbVTNqTglhsPmBC2BZT3QE4nsXSTJSs4iw4QGPmtyyGa3Y2RPtwOZRmr+EnGiqncXo9LB0buJ0dTHmCdH1z11p+W5F7YcGDHiwJa/HLac/MdbXy0Y3PHrNNP983qsfKW7ccE/5dp/LuzT2vivxyP2/zRq/9spHlhvoXQv0KKDZtGpJMZVN+8x5HnewdM9DAQiWkKNB+wzJEeZqsBZA7UbCjJVFleq+u06/F+BD7SFaWD4CqjKaBgYOqoz/nV4gJ7IKHwTQGe4aASfaQzCNAZB7SgaLo0kmihji2K0eVSlUrlUKRTO4r5aY0Bg8ZxequPRgWAWxYju+Ncb/YHNRWB2MVlbgOpDY6KSFmwaGsVSqSVVC8ihiO4A2atmiSlQIPHxVNrGF8Tn52RnZfo8aa6khNuWtgOv66OIyGUx6u0DLqyut8wdgGRATnWCGbGM2RcSnewRoZlePZFmFu6TwLyh6YllpZREJ5w5I7rrv+v4/rTQwXJLiNTe+h6CD3NwD1IrryrFM9bBPd6gsQd2EwbLS/BrCrMpYmjOhFXu99BHpOmSmThW1n4B+y/Q8gh60yll8n/r5e9KcdyaJLhzRu3rr8POfv9b5d4c+NqI6CM6007tKImAPoHNFBBt5ReiuSK6ZderRdV11Y69MwZ0RYNL8/JK8/D+wQUFgwvi4Onf9cb9vzSR9aGca1/xl4S9bAYG6DYRcxImPPUyKEOqWMWlGivjsNg69Rg5kgAaqz7Z4FQGeKE4rNP07Zx2B/xK97SeRY0YoVjJaaWB+q/yN9u2YdtHm/ePGLF/c/vLOCC/eaFXEzW50EKaWR81Pv3tAl7OaAn/lo/0rX3DbKYiWgFPQxtgMYHvBYzKi9PUKkJ1LxhN3HRaO+Tlaq1Wa5G1yFxosgWsJhuzl66zlViaPNJLmcv100xJKgJzwWbK6raZMhq0UznCOiw9osNkFaNNlm8X5HiA8643mkIr75VXKZ2X2jJfsbmn+XJOy+I5PFJogfVfMnq1ITfKDWVRikVV/fdhCnyyMyFer+Ntgo2FuYAVTDe0FPZuxuT0JcAk8nXthDinV0cm4x654SathEpb5v8trJTlbg7rX1gU8NJNgWVsehvQ9uCW8rAd+SjlMC5m5WaUhBiwtGooi/JbtGZOrXKnOsAnUNnVdqtIR9JFWPsWwH9PhTtlet2akpuuICIO5GX/B2ugtJ+BAqyfOUL9HFA/bdeUME3rg9RnffzZfK3NWpCflZmaYs2wZQDxq6h06of4b043RLzeYwAv4p83W1f/DLDz1ovklTVG5GEWCqLK0FA1UTGJyFOJSNemYUNFqWPUBMvOFmoTmEbzF+Zkp6XGZyVk9RaSMYoH37+QvOm68bsl+fklEflZOPumG9lHssrHb2M7af0Veofbxl2EtYrPquh8GzC21SzkCcYYmYL9E+SfyS9NwH754gQ8DA+dQBrkz+dgl/zBHGzBxrnyB9jVyuhiE+CMTo1IVWaKxNNkRFamIwmEuC6G0JmvCRhXxWppAUVkuEiWUjsW6R1Nc7uz07J9WelK+anVaFDQwqonuicpBLHehpmRi5WSXx+28vXDFjRRtDw1v3z60NY7aYfyY/ND4dF34t+MWPXQwRF4KfzKDchZ1cKlbdXyG/L3DDEZHRnbanER5hlyPB1dr8rH7+U+c8//tuvPC779w9lPK7qMPkU/sb5XJmvYVAJFj9/Y/wo2o4W3uE0+ZQ1gGdzQA8sZqQgkXb06YRWRF+y3HfZ/+mwB9vDGZ38hrwSRhj29H66IsAGe3vN8KrcSUH4op6/tweoQPb0lLdijCaoEtynNygpRI+KqH2CuREVU3P341d4QRUXSpIFg4hSYIjyaQTvmohxKbRaNRJjV0iOEIvZmRnyGN82V4rDfLnfeCDW+1Jsj8d7ecPflwO0D7SfroWX7aUDuUIpWUrIlyr727aW1MGOOxqn69NPiLuptXO7bVKvEpa76rmutjc4u6GC1GYNCgRgQY7g7M8fyloSPjO2Nji5ITqKjC2K1rORCL0WGF+hpT6GPDdqg0wvY4Dg6vmBf+9FFOTnzD96/5adnzjQ24vz65uF2+/Dm+g/r+U3pc34sf/eT1nSD/InQcQ3x4WScMGzxpCmLhyeQSC/Ztb8IduE1VINOKBV7mlgAUUvrDqvtoZhYBq8WkDN6snI8BcCMNJnB9jL3glXCKq05ysToZDYxur/zwCJTTkaRidGpSEREEEnrwCfRor7ykiJ/YUF+XnamO0OiRrutV726X8FGHqaRWDEYbUawRNvX6CxfFstms3y5He/MakgeNHVB7RNPxTywr3J0uS0uy5t56Zg2LjWxyDlcXzPo/qMn7+t87jmLt2JUc/Pwq7+rnpM0zp0ZV0rmTc9ZumDErIo0na1dg1XOwQWpuWkW04wxjzoKPV5bqsGtzqypGFnR9PDV89yUDfyyynm1wVSTtGrvpJXl+myrO91RWMR4iPXZCu8znzgDPRCyJIF+o1kJl4ZVqCjm1P96v22yU+DTUp0ZyRmJ8RaTTqtW8Q7BwTp3QF5KN9agUNP9+p7bBhYOMJ98apNl5HtrNj6xYz0+TMYvf1j+WI/1uvrXG+U1I8tq+Jk0KHCG9d9WLdnRQftvm8Yo/bf1tb8g3IihrP/2/4+4oEx/W7jA71Nh8OUtUUGlg3z0tnFxgcUictCFkJVFIzBKwQJOxrzg0RFR4quVWcYekB+SSKdes7Y8igUVYCEXvDVRVBore2aLexRDN3rFQCeHMgY6j40Spyd3h8MmhxLdqWpVujc1x53jTEqwGfWxWpVL7TJqqLEciYWYbg+T5p64yJRb4XNhDY2O1PxCfvOWKO3G6SEWKSlDB0Nx+VjF52FJFXAStSba1Z4H8otiml8LyNeoJc1sSlGAVpWKb6Ij1XNZFEVoEpXArj3kv/UVgD4vu4yJwmwR6M7hL0yIH1RcWOYvy83O8KWmOJLiCxIKTDaTPpZVXNJgPtdto3Ngowu3h8EAje5njR9yh3dw9h3aKXfkTS2rdQUzceWt0Hlq5X0il+px84rJzrl9abwY+ObWuOUjuO2IxKHK0LEBsJsbQVGLlsRECyGprqWoimWo0vVFbuEtL2C41fXBbQbFLbU2bsRvb6sj7iYRrtuTgXh77wTD6Vsh+HRv4+TM7eP1O5ZzyEVD0KFQXA7gNRvwWmjvhdf83pkInmOxP4a2gcm26DYu6Y9u8/OsloA/b0j+kCyw5JIdiQmWXGsuTWpQuu03qXF7QpS0985yZNwKmVXXZTvkp25Lrn4m7uJkVgM4DM0PzUmhk22pkhmsJhySaPKAp11EMRIX0wJol5BaaolVETBLGOqAQDVaRoiUycHUDhbn5mBUVlI8LDisMD8nkBtI97pddGgyVSaSgLJxdlzPNAD6hgFywywL2hMLxolNn4GjEwJ8RV5spb3qEewIuuOnDaGPZp64WJC58kJT30EX7/y6dvYXf/wPInfJI7tnCOzo4Jd2VTa8PcHIZmCwcQKty/InV/cagjF7dp/RAk3jwglk/NiGBd1jMWjvQ1jm9gPOrCiN5ldotZKOTpuIY/kV5y3yK7m3lV/JvS6/YrNhZEuzpaUkgy6JEXlkxVZVn6kV0fQK66C9LrdSRadYPPjc1oqN9x1tM+z8N7nrnf/c3Kd6KjLU4pHDw83Li77ALpzy16sV12VU2LsKrn3GXWY2iR1WPzo0EoDlJDYVQsl032I2hCNJ4F3JSWmONBsbn8rbBbsqYmZx182HsOl75kPA7pM58qpZeGblyacNoQ9nydfolIj3L5Iv5Ty6w/kHVvP42CJ+iWJfXX3jZsMi/l9cB5hI+ObrwN+W4rua5U9uuQ7mOrlvZx3ULkpG6WhdyBDJ62vAQYlhpZiKSZQG/gSPRV4xiajFx4iLtjgrrWzU+KM2Iq0GiJ47wGmTQ/GuFLXK405Jd6XbE6zmuFhVsjrZqO5j3NwcB1nMqtGXyd8bsm6FiKhVc7XqZrjgI7hQdG4eGoTuCk1PZDVNAu2MBtHFg+hiyaButRmLVSomyqk2oCJNCZwV5CvqMuDPH1QwSBHr8XkJeb2Vpe4myvIWlIyPKBmIEpaB+OBW6++jJW9K2OTaYTYr8/0bcjvp/eeHZtO4D27o7ORP13/XccXNXQb5thpuVHHre0TzQxUsJN3R2SlMolEbdhOWH6JN+XWMNmNQeUjdHaNRKFKPInMJe9rA9dHMUfSryc/1lzuq64nRJADk52p+8QugkCuVynO5azLcho/QgZ3WxtK9Bo+HZpDo/A7mTP+Ps0c5vWMtRlh1R5/M3WoKBZuBwH0nnEZJoFlHhobbMeHoS6/AW6ETX4EtkzAHOEXArUJrVNRnKQ3HEf/e6Uj3OrKd2QZbWrqkzHBR3jQQGdfiZUFIKVhsC2I2Md8XKafntmz61lrSfGjRn3//6odP3JN176GKTT/4mfnb04fkz0beVZISI63e8fDKtcLMOZdk97LOx5tLPv3+r59Xv79sdd28EVJb7ILVV17PGLW6Y1ZFVcETh5/dHZmJwmvBV7CCJ7rkbLobEBzt6HexYnMQn2vZbGYl4q4iVGpESnPsIc9150hSunKiCvc6b3LIHG/zeT1pIFnttoz4DFOiXk13/7pCnh7bv89wCry4QTt1bE9KSrHzM/B2NvglMrOCGfV8UTQMH7Xpo8NgegZZcGyOhYPxQRzsI6Uj5nD3zLLsM9DCoBf4BJs+yZAE2iBOUErkKJ/1GmwhsGnO1AbUe8lxOmAM0ILe+Z18TZbfeQeTxvkjk+5/8sh99zF2lF100sVHX0UmXbgnPbT4Ep118fj/DmyUfweAjWunOd+73u0XNoXNBwYO9eCO8r4JpaCWCPfjbu5PYtyvjA0TFDe6J79kD7H67fYBDgOZWMxqlcNuTrGkgO4xqU1WqXcWaqBV7aDqRv6Oqp7B/aM9IkvkYQMvLrq2QyzDl0/jvLQvmQeZsxZHcsI0yKtSHAZJEmYoSsWTlhCfk5WW78kHZeJOcNtMNr2G8vV1Xi3LPA2wBHxI8WN70zd4t//d/0btu9F5Da28T54+4OL4yNoU2UlXVxOqUqQni2Uj+hK1aKopt3eqiS6OStPeC+wtVbU3SzcNtNilvdv7mvtfYx/pK997s33bgNp5Fe8HjqHTactCQ5hBx9H0GYdYYp++z0TgJ0oRU4AXxlrNBDntZrfVbTJGi19V/RS/0qag678jeTm06yEnzW7HYTpvUPYpr3SEL3i/093iTrKntaQ5wn9ul3/lSJtJ3+w4k7YuMBqbzTv41WwefgbNXZlp7irdl5gAcGrVLHdlwbgqRtMrd5XbJ3eV6nJlpGakZ3iVvI8TWwDJLHNF+z2KXTRvZbYqiSuijP7yYSu3rWzBXYDnu8eOqB/aeifgurl+aPivvhxcljeUoh27jtyXWSj/rIBv7PBffg2wbXnEtzXwySuAceP28Kq2fT5yQguol+MPXXpwvydcp2PvbLjMfS1chpVZUWMo1iKxsSKKqf0/HC7C87yVh31JtbCcDkhaodeAkcgoG7JKqdEq36p7/60NmzpHTag5sIKfR12Ed7rs24/3nTXy/wWctGSrHzgJDZi29IWSRUc7bgSzG85X6dxM1BHSRaz+hBhKxpFpLfGKiKXjspm9g2dEQ8GRiYR9jrNGIZCxM3qJYHAFBjhMX1apUqkSVYmwLqsxUoumlHjduDg8uFdt14k+a1xWgwX5as0v5BP9LBMAUNa5jcmjTPTU2Qw7kcRoWbtLQ9S9jPkYWuSSTqUSP0OIWB4KKvqc6Ov3xJCn/3PgaG8hDgt3RRJ3mfGZPk8qnR6UcIOkG8AvsPWDmzO968MO9UHO+cIlBQVLCpXf7/RLB2wOC7MDWB404rsOOI8FaDGBTzAZPdZuWuyZyRIZyVKOgxhfouR4Wl62Uf6dkU1mKdSywSyJMclSkgjOoRK639YzoCWHzmcZk20eZ6QTWqLzuNzCPmYBVIdGGbGAkp1gOKrBN6UjIpR5lwPO2ooMB6c6ng7SE+mA8J43buHuSVtsmGivUVtWcuGVo3UHHnjxab6zU3zmwcmzC+a3jdw1/Rwn/0v+7JVPZ06pWC1/IBXLP9o4cnvXvZU/evidJytHhD9mlfAKPhX9l0MrtZEkCqIkrO2f1Gg4UGmRiBBFTnxORronLTXFnnjbRNH/DmzqTRd/u8lO9HEPLw64IWyOvXgZ7BYPCmKTko00mmErCsBBzsawTgwuMm0WcilH1NcfueFLFc9ag+idgrRYWhLEFnU0YJLFiuMi9dIqDYkO1VA+R03TyOMC0cvZi1zZ1eg2Lg4V3uw6TfcgDxof756kCvYjQkWFWRmAiTRar+1z99Rrs6BsZGQ/9dyLb6jbViJtdLBPkKlO8QPxgjx9bPm4HfMOsmH+v1m4Y0p5I/7hOTH8zahhZET4p8NGdc0bcfCh7a1xhrZ752+anLZnqzbLk9wz3N/hyWCVnm/Riu62qqEk5w/fLnBlF3ErcgLJwQ3/GbU7xffZvMJsVIwmhyaYsEQ7fQUV/c3REIeA1EKLVgUoik5SixE1vaOzuTmuFIwK83OKc4szfCnZrmwawDHqtRpJoMMKY3vNafUpIQwwFVJs8GOio52dnABSy8fC1aLeillIo9iXi4UpP37aEPpolvzVvOAL29jEPoR1c2aD1/cct+24vEpMv2N+uGJfm0SktY8eWb2a27BrFY/XNQ7lhdUsFLt59HDFbuvokC8ebbtzxbAEsuVceeDMBjrjj/x96/PVU++oZZV1iF8RqbPwoNLQ4BR7PEf9UeBNWLpS60tj072LRD1pjusEtfpmAZy+pQ2dvXnxeN8Sh+u6JS5eP0Uco5l8M5GFM7eaca04L0TuqYzlTylFJ7Qmij9MaL++DTnYPYw0VInaaXZyOXUk+GiPYj/OBNZEkl89TgMtVRP29useKPUPPe9TRTe8N/X/4hifces5BXxG1zxuT8814t5bXyPu/ddVEEjKNR3c97hEeBfpUVrIRd8xW8UunMiC6zQQgcb2ftGsCRRy0FcctImWQqtF0uHv/e4k0J8jGiy2RAII/d6euvrAZuuKpUkJS1PtCn7auC8w7dHWo7Iz7DW2ilurjT6DDnQBeXljl/TkUEyfh4OMkWyRl9EFguX4VXg4IVwlfc8twcnCG0mpqx/vMC9e6UhYkprEnr3tmohHok9u8x26fe7+28jSGtndUz6xp957YLNt8cokG1sZobgjyxnuXHR6YkK8SuJxFeuVxRMVT1CZ3YLGmgz03TAGl8mlPFDsD5cultqJfCFZbkAuthS4HdxwgCcB45TrUA1/PPGgdfGqbrwTineykOHdhcaeVcCL4D6uF3gK+m0DjJmZHDL1C/z12HJd/6bA6zYH3+l327nhDUZrAk65bqfgjyfazSuWRLeNvlPxmkhWs31juE1mUx0jS+gFIHtDZz/gBW8J3ttR3PYFj73OsPdWu5LgjycetK1YEtl3jM7jeSSHvH87vf03uL7zEppqapoSmmvHkPdrmuKbx4xpjp9RjSI+NxIL2DuWk1EetVBVvERE2gzZFB2bm0rfX4wyfSl5qXm9Xyep7ufty65b/P165FWODgd5bAidMjDEk5RE9g9JczjS6Mdvel4k2POLvWxSebkg469qVI+/Zr333e92ZANgvqJTX6bJz+NRvae+KNdMgmvk6DWRdzKyXn1ZPjOFNulP6dWaT98fee0z/jTIcx+1Mc1YFCyYp2M+Y9jLRFWYDaZQ015rHEOHk4kii7SAdRMTE3XwfR53qivFYHSnGkwGY6pW5WDvbE9BnDvgDxQF4bcRuWiCEBhRckkuOr1cctERFvwh4+Nvyv+Qr9o7n+KOn3ZiAYv/ttPyxI8fP2YnGl34CsE/18kN1h8/9crhLfnYhB0LQgV5C7AWcxlb7SrxmbMLkoeXL/jlv/Fi5J30ZIOULOwAHZdJbX0X7Sel4wToGPa1KtB3+AGNOgZcZsRNZB84NE0C3xJIZAxCGd5Em8VsoqlNjVoFN5EMBoNWY+ueSkJfL8WxyZ5c94umTE7CTGXlL84l/2Ot/A9xzwqX9UVtxgxv7IvxyStcXO46n3a/EKPlrKJF3Kf1bMjlhB1zwtPJ4Tld35Hj4fcyMognPIFcKsiQy/WebK2x2oRfziigKgOA/Yj7KDJjkVX/YExnLGqsWQaXwcV91JVMf+j6B4NNEhQuICtKRU8/p8cqIeqkZvTaO7Va1RSDVSql+5efppEIncccaSO0K+Pq+7vA1/8FIR81f9WK+XuzM8HmjU8Auyk5yZaakApQWlPZYHuDls61j7yFrXumvYUNuu8druMLTsg2NuF+48wTM+uJmQ4v99NxrdxUZdb9wf0HdOsa52zFx5Qh4qyG8ithpPAieH9nlaIMTRLGNMeqojWUkT94+GOyctgN6JWawNnOqqE9KmwcA7ivaliVEtPO7saRr/9Tmbf+/wyiHraQUhWYmhiB+TcVrzpg+IDuTVZgkIec96+sDNoQowo7R1xRDe3gf3EF8PmerMbC0gU6hU3/NiT5MWr/uwoMobZZjGv73RzL83n4qvNYIhhDs3qgtwHMmzuXUeJ3lLMLNL2wgdazqTMYg+ov0CAFlwgj6CJTRUZ2D6AvxUEiQDZQlJsdHF4QDi+QAzuOwQgU4ezxArxczKCQYODjQ3DApStbLD8PJzP4wHImJlgaA5lsCSxGuOIZuLi0QT0jkC4mJBOY8BsAigAzNAMYoNp54wUYeXnVcep2MGHgYuDm4OJOJUUb6ABLBS0NBgYDXQ1jLWNgqKkDu9hy0lLQVAwEoGMCoekYJS2zQy5twJWw2Y6v+Se27h/XumXLJkyemMm3PsWP8VvH7P7U7cBULgpK5SaIVA6OR445vdP4G92SWjFSPGTd8Dv2N8A0b8C4BhJHfAqMjJyg+0iYvHQZOT2giw75gGwemAwzMHaRBFiAAqAYBp0xagRM55zxoAVHwGDi4oIxQSUnMDFzc4DHd/iAQccQy8YCjyDQ+aMawJqDkUj1wmTbBF1qxcgTz8DDA9XIQIQ+UBIyIawPPC8I0Q3P0EYMwEY2Fw+wTiRaE+QEVCnwEJi+jpY6eD0SJNkAczo/uN7EzOk4khE46xuzXxdF5Hz9fxc3/uMGZv4JkyZm8mwAJqGvHbOBxUA7RikAKQlmwVIQpERoBwCLP+gSeNqNVD1vE0EQfb5zQEEhDUggqq0iW3LWH1EUwEQpogQhLBvFgRQU0XFe2yfOd6e7jZ00lDSU/ASqVFQ0SPwc/gISHW/X65DwIbC1nrezb97Mzc0awG18Qwnzz+fS1OESlrxthz1c9/oO+7jjvXO4TM5Hh5fwyK87fA0r/luHl3HTX3BWcMv/6vAqdspnVCuVl5lMW2WDS7jhNR32sOrtOuxDei8dLpPzweElnHqfHL6Gu37s8DLu+e8dXsGa/8XhVbzxv2MXKTKcIUeEEcbQEDjnaqGBJjZQI+4ioD9AwqUQ0/OYaMIlUMHMfiVPB9QoEFJxSl7ONaDf7CdkSq6IrCH3FatY/UdM1WafkaFZmcABTwvLmlqewD55ia25aytSRHs4pddkO2SUUb/M6xMNiWbk55Y/Z8S0IfeJzWC0T2x1Jpuw+ZWNfoIObY89M9zLyp0rCqbyFza6oD+13CarMgu7aXaWR6OxFuei1Whu1EQ30EESqFg8DiaBqMxmM5kMoiJMpypXAxmmEyFFlAzTSqCrv5xUa2IW6bE4UIXKp2og9tNEU3GixN5pKsXhOCrmvn461LMgV4KOOApVUpB9kgxULvRYif6TjuhlKpmTO3NCTbxQeRGliWjKJmuft9cMCKguaMxrGbFdsW0pDtToJA4IzKM27Bi18RxPccSX1HbxLaz/GteUjUaz/fzpUbdN4db6hc7vGf/U2EWmZ3xJwu1+esdkajtWCYdnESGxxd+2HeXX1DScIb1mGF4xn8SmXfd5EVp4wMQXrTC1PusLGgvHqQ7TZGoO5FajPQleq1QPZRy9aslNuXl/o/UAf3/0q8/79+uGK2OC/7x6+MM0wV51zTF+iDq/Jtb8BWT0FYw0vY1pU3pHPA+pU/zGq9MGPFdkZlTMsGMjNT3HtANss7b5m1pz+x6vTIfptc4e1utFmEeZLmQRxTLNR/VwUix89SwYKZmNs50i0uo4GmwnbP4abW+/gx+xpBxFAHjabdBHTFRhFIbh98AwA0PvHXtv996ZodhngLH3LjYUpigCDo6KDY29RmPiTmPbqLHXaNSFGrtgLFEXru1xoe5MBO7vzrN5cr7Fl5NDBO3zpxkf/5tPIBESSSQWorBiI5oY7MQSRzwJJJJEMimkkkY6GWSSRTY55JJHPgV0oCOd6EwXutKN7vSgJ73oTR/60o/+DEBDx8CBExeFFFFMCQMZxGCGMJRhDMeNh1LKKMfLCEYyitGMYSzjGM8EJjKJyUxhKtOYzgxmMovZVDCHucxjPguoFAvH2cwWbnGQj2xlL7s4xElOSBQ7ec8mDohVbOxhO3f5INEc5hS/+MlvjnGGRzzgLAtZxD6qeEI1D3lMM095xvPWH/l4SQsvOIefH+znDa94TYAvfGMHiwmyhKXUUMsR6lhGPSEaCLOcFazkM6tYTSNrWMdarnOUJtazgY185Ts3OM8FbvKWdxIjdomVOImXBEmUJEmWFEmVNEmXDC5yiatc4x6XucJ9tnFaMrnNHcmSbHZLjuRKnuRLgdVf01gf0E0MW7g2qGluTVlm6lG5x6EsadPQNE2pKw2lQ+lUupSFyiJlsfJfn9tUV726bvcF/eFQdVVlQ8CMDK+py2spD4fq2heXt7RNr8e8o1VD6VA6/wKlVp0zAAABAAH//wAPeNpjYGRgYOABYjEgZmJgBMIXQMwC5jEAAA2WARcAAAB42mNgZGBg4GLwYfBjYHFx8wlhkEquLMphUEkvSs1m0MtJLMljsGBgAaph+P8fSOBnAQEAaFQPknja1VwNTFtXlj7YYAgh5AfyQ/5oSJuEJoH8tk3TFlR1q+5oWmXTbDZppxGTaWeiaZNsk3bTmUy37c5UqMpmMtlIEduNKoSiKosSymQRQgjRzbIsyyKGQYzH9Xi9Hi/reiwhhJCFLAtx97vnXb/3/GxjQ0x/3tF97/m+e+8599xzzzn3vPtMOURUSEfoJOU+8+x3j9DaH/zk3Bu05UfnXnud9rzx/bfO0FOUizIkBMmymdznvP7auTNUIO845ZKNSxQXXN/QfOA3lJP/v1z+Ffp3+h/6E03hPJ3zUs6pnL/N+VXOv+X8KSdqW2+rsr1q+xvb39u6bb+1fWkbs2+0b7NX2Z+wnwG8Zf+p/Rf2f0BOA9J/2X9rn7RHcqtyn8g9k/t+7i9zx/JW5R3K+2Xev+Z96djneNrxnOOw45jjx44G+1uOBg1kO45PHK2oL9tR4OjEeVIDlPrP/ML82vyT+T/L/7v8Dlkr/zf5X8hEDtopXHRADNFBEaXjYoTqRS99jp7a6A5V0mdURHZaKQK0SvhprYiADweEk1bTYtFKJaKRSlF3pZjC8witFpdojXBTmWiidaKF1otOqkTaKQZol+hnHEdQ5ri4Ri+LbjohPMDnpCt0gH4lJoCxgH6NenYqQuu1qFWHEnmo34N6XpQ9D4oeQhkPOF8qRoE5CMwBUDYASleIg6ApCDoaQUMA9XpRrxn4xoHPjfqHgOMwtVIx2hilRcDTiFr9aCeKdqJoZwq1IlSDVmpRuw7U5aLUEEqNIcePnACodKBsEXAWc69H8cSJJ0F6B787hI/r3EUdH54McS+WIOcaclyg26M4NgVuSZztwDnOfK0Rt1Gjm/GeQ7uyHT9q+ZEbRm4U3CgSg8gJop0IcgPIjaDvDuQU4a4Yra8QF0GVC60OokSES7yDFutFAzWgxx14Jlu+rSiM8blI3GJu7OSW+5HrwnivBY4iPGvGswDLQIXi0gFcD4pplO3jsvXI+xy0joJOTX4+B1U5OE9jTO9QNUavgEtAqoC5COVWiDfRViPTeQR5L4MT9WI/Sj+D0uU81p8jyVbG+BzktvdzO1JS+lHXw9yXT0Pctkfx/zzavgkaJf+G0b7koZSjU2hbykAINXxczwPKGvH7n1HnDp2gFjGJMgchKwX0L+Isfamw+zCSdpYHyWMnbWY5a0XbbaA9grZ/yPU/ow1KzoaYZrvq0Wr8CjCNUe7/asil1vdxyKmTXkd6A+Uvgs47tFfR6Md43YF2k/OxlcpU37UZWswtyhk5AOnvhVx4IV9hlq/VkKU1uJYhfy2wrUOZ9eBEJZKUjl3o90HGfhfYe9CDAczKoJqVchTkbOuHbi3BuVRcQYtdaG0Yrd1Eaz7IwEWem8chW3KsitGry7QEOSvQswqe/SGUageekJLvNpSeAq4xjEY/S80oni8FT9yodYMqaAVqOaEVNqPWFNWAilrkHYGOqAMGKcd36BL6XgluHGAeS46OqDnWgNp3UVPOp3Hg61EjLyX0JkoHgc/Ds78bFEo5ljPezTPhCFPlY/0wCg6VgK8e9N7J820lj5gTPI2AC05wwAN++sBPH3D6wc8gWuhD/1zonw+8DIGP1aB2A1p0srx6gCcIHCHWpaOQ5hIlBzk4j7Bm61M6V863VlqM9q+xJO8S11HnXfTtFj3P1H4EXDeAqwl96waOepZSKS9F9CS49ig4tpvnjg24J/lOanQ/WvewvluG/KvgWjPwRvHEq/AOgTdSF3QB4wQwdoFHQ8zNupidwLweRa/kjPDyjFuCXlWgTwfQmxqlW46zHvVCqv3012j5ImuIIOZVHsayEKkCklaDVItfLsz5PyCN0iZYp1iJJZCACsj972kduZFyUH4Z61SJcxrUjwCvHAMPcPtBrRf4pcYeBG8m1NhPAG8IbWo2y80c0DRwJ+uUYp6fmnb5DNhswGQHEOo4gHMRStghh+tx9wCgFFRV0kraTlW0lnah1kbwu4YepD8D7KQ/B1TRcUA1vQzYBb1wAqNRB9hDPwDspdcA++gcYD+9A3iE3gc8SvXUSI9RC/0a9qoDcJTuAf6KegDHwAcXWnWDUy+TbeUy6YeUvlX6M+B8HP7LuAiKiJgUXqRRMSMmABGksAjhHELuBNI4Zf0AP9OVCEGmso83mDTXi+RS95NZw9Uxh7JjkoaFPyDDC9PuWNoSU+nHfB54fUlzR4BtSN1PZA3XqOV3WF0jSP54+cIMimJWeTF/xjG2vUg3hFsEcO3DnJsQTlkrLcYJXTrGFZ4uOXf4Ds+4PR80upzJ4eyMv3ha9kacEJvlr5lOWBVtfpzWnuH8HX7SLV5gqo5J/DNnxTHOfVWWmjmF8wFxkku/hHLFoloUCNhZUSqKZkagaX4+ExJFYre4YME+lHwmgWOd6n58webGSCJ/YMPkecaSC1rgiZpzhjPGMgkJCPDdp8y/SUP36GWaxT2+Xmfunxaf8i/J26viezifgiWXOS1SKgHtaDUsukQ/bDPmhGhF6o1plEwkLcucnLDqeXgcaq6y3A6BWqY1riyPrGiDVF/Sfmm14eNI7RGWYwOrnHQOGlYjLW3hbGparAG0a38qC6DLbTh7+g82ejp1TzWeCJfi57X56VX4YnKcTDTDW9au/hR1xgGdBlfET/jcC2kFDfA3CasjSpR2Q49b51kaHR+Gz5ZtHT9GX+uRqidSv6vx7DZ8C/D2thwVrJNIaQS31eomzhHOr1PX9qTYGoDtavy8zI4FFVfE0ZRP3+TzBnGe5/6lebQ/I66JclwPYeWjuMH2d0TjrZQkOcJS/yrdMqp0ciDRX5mf5jTq6L5Ajy7f0m57wVsXVrdJfE1xF3ruqtkPlXolA5stffUIeupL6cePZ9+PlxyaXdMm8mTB589k1lu8J06ouw/VmDQomxQSPaJOvA3evik+VOPgNvdXWvGY1lQ5rvR8s+oiycdkOlcMY4zdCbm9hs0xVjcZ97YlA1nr5eutefJzJmGdN2b1rNPrw/sc0zA4FzG4zD5YODOJXwhZZn0XzGxWzcM36U369DZ0TYvOj6zYPc028d1NQ540n561YCPG+mNtRmSvn+m0jNXDzBI2ubpL6fULp1q3BbPVM82isY17yfDHlJ37AOmI6BaHxQ+TeTHsh15PWOu4Z5uXKreecQdhmTqTaQusRZt1nzRrMwN8C6XmXGYr3XlgHc5A9w0unM2SbRsjBzsehT3vSjZXRCek4EZczhzoSj/z9MhG3Tx7NK3f5qhkozWUx9HRQoBDvieiTbRERmZpKaCMlpGMTi4HlNEKwEO0gTbSPqoAFFINoJRqAeUcFd1GZwG59DuS791+D1hOLkAJfQEoIzdgOf0BUEIeQBl5AWXkA6yiPwIe0+ha1yRjomueK/sd7aGnWBe6vvoVs8UizsCzD2D0Q2IQVt4p/JhdoQXG2gev32NZc1wwRS2cogn0+ESz6AJtw+IiaHoTZW5DGq/e7wwAz6cy0YPayIgB2C6f5sNn30MAz5sS157J8KT2W+aEr5fjG16Mulu8KzZp/j7GI51/PZNdG2qV+uxbaKPH4rrF+ni02IDyRqSXHEVeABpXxlFvs86LchRpRMlmdL69jNVkvzqs45yay2oFtEn6wnKFNS8qhgxvBP0z1ozuVDJ53zxvE5cgUwNaJAqy4xEXRDl6MaPF44zIptJBHuV3jClZC8csvR5hakOp7uTRGQvuAayUvBYdl8A3ju+F46UuNsPYQ49aPKLIPFfobhlDNXs9kAkna6FILA85M7pdHrfQlDFO6Mx78T4nxvp7CX32J1kVeeJjCPNZnaejMyM5n7ofnyvVahz2bIzlS1o2eb0JvjTBttxD6o/1PDl90AlznHFyhfkVWe4RSHqQezTM71TdkPsOeHIyNuNhy+JOPsf1SOagklAP2prGeYBnZ+zdZHUq/cA69Ya26jDFcEcTPLqQknE3RzD86t1ONJmsxfRjBv5iL3wHtwX3WZN1H9Hi7sAaxNUJSqfEp0h3wZfuZHNsTjHF4XhJyeZKJA3uTvRkxDxTxWXxbEKpnlla6LFqSpaiOdg2sZvfzKk4rjgtx1VFh66IDbyCa+PraXgWLyG1ivOwBDVcpgYrOKxpxFlwcdwUFX5ae8cHHdgmrsVWnnHrIOfX6yOb1/PglxF3CGWq0eaFrx3jPajNRvY/g+JDsU7JnNeQilk8tlarBPHsCWTklfZhlhyScR3RiF+HxLNiJ+jxQUsc4vH+GBpD3k0b6y95F2tdvMAR5hPQUWdR66iMI4hbaIfpnfGJw0ZsKAPd4s9At3hia0FrD2MRt8xHQ1xljgd0/yt21w9f8l1+3i3XK5DzC+IZ8R7WJdch++3sJVzW4lCSapbzmLb9SFxRtnIAfezWfIDZJDter8VFdcN6hHCK9Vl3Fr3oQj5vN7wEHtd7+uphQs8LM0c6sjK9Ym9qSqlG3RUjPbtAk/kwHSIpvV2QY83Hj6p4e5O27yBuHO7Nvp4yvCs1Oi5TTGI2+z0s376zDDshz3chVfXwOKRUGJHMxllauBzz3mQUAUnO71bYiR5Dv1tjpVYaZo9PcYttelSvnce7SdN7Md1v9ddQQl8/QGcFkvjnffG58MSOxcXjhsCFfuaLsSIOGONgpZrn92gmdowjC1+TLYF31hL/NhojXhnPc7lTgXXbRFzfBo11XLyvmen7lkxjHibNE4nt+8mu/UwdM+cIs0+3dn7Wa3XK6g4n9/JBp2+OVAxqO4Wsax+zNee3NPe9H5D9tUHuS1R77yM+ENutsZxZdUuXRbcMMP0ZrC/U+ntIj/X4YKM2q1ZG9HVWpz7jPHE+zgxqNcf7MLBtYxmuvydjPjLvvgmrtfPUfFZ15tE2xS2is/hMn0B7eLV1H/esXveZ/Il8TeIztSWOgVVfpY319Jn26A3rb1bHoM/GlO8SiJvD43Ha0csacjj+DYERHUnGHWP9zR6HEWeKmGU6bQ9c0NdufofvscbWM7JoTpPP5DW9XfAmmWOh5PGGhD0lkfnFEvTYypRuvcJ6Xtj8vmG+9gBWq9Wiz1tEjSX2M8OyEDb5UjOG/UrQ58FU+48sRw49SD20iZZRFa2Dn7QVXpM8ttBOWksOPF1Bu5AW03ZaRXaqoKVUTev5qzHjKKM8egjXStpIRbSD8zbTctztgA/4MK0kGz1AS3DdQPm0jUpod5ZMwSYTFKMPxQpixzruQQwIya5gPeWi92UmqOTd7hrEjjXcgxhIj3alghL0qwSYKtFSNo7loMZO/4cr0SI9V97ZMBZE5aC9HFQSPcpPHkR6DD2Wx36AduygfaCNwGOix2kvXwlcl8cBlb+N+bYYtD+M0ViDPi1DTgW/V9JG7iCtRq9WY8TW4v4JwEF6EuNejbxq9Loa410AudiK0d4OKXmA69m5F9ZjC0uG5PweyxNNBsx+y0oTrAOdjyswH9t0kPex8ZZjswSUm2G1Dk8oWMU9iAEh7VLgQG0H2lut1iyzHVKSlkJ6ytWZOG2kR9Sqg/j9oA19yOXvJx3gVQ6/OcxlWvPAwVLkrgIUgP9lGOVy8H8xxvRJtFlLT4Mrz9ArGM06+j5WLq/Sj+g5egPwXToDeJ7O09v0Av2ULtJf0Lv0Hr1IH2AeH6X/Ji/9IwXoS/onspUclviX/cfyX6Bfr/D+3Db6Vh5YXcnI5DhWu25xXu4rxyo5CBjAirof1mYUZ7d4Gz7NEHJHkDOMsrx7DB7LeS7rmauHl0X6Nb/0IJ9/jPRJinINSfI+4WhYg7gCuIaVnby2I13CL3m+iusNzv8oqzSfEj9nO9IKf0SLN1zn6PAwcjwqmjEOvONYCckYaRTcbxPTXGcM1MidfK24i2TyRgBjNiluwS+M3P87Y0hDQH/jpq0++zO0hyZfPiH2Y7WxrgWWmWtGVCCee/F7YoyezW/P9Dd63ndm+P6i6b4xTcX7lalWw8aoQ06n4j1N5Izwl2kRzAT5dVqfLAMdNSR3PMp4QbK9Oijl5d0SQ9oab86Uu4y1Al9T7HA09khq0US+u6EiVk7RyHS4oEtGxF1oFRfgsmgCZdehXbxJNdMllGzE04+wVuqcB+W+eF4bUaZUUTNwc9LcW9YxneBtGPzuYB628X0bcv2wAL341Z50VTuEEr2wK+2ZfwPDNV/l9xY31FsLn/rCKP0erAuyDpftMPYZqshDgMfEwxEvbSduM+5Gk72HhM71c7nWb/Csvf7V+QVmXkIWm7Qxmi0CYp4PKjLaZ6ybYb9a4ncTi82G5ueRiqLEMNZsnRghafdaYAGn5xKvSvm1xHBiHVP8rkd/q3FZi/bybthetraB5LqSY8I9IoCZYZkF1nclc9PJhvSBguaYV5Nee/MXH57E1Tl4aJJn+B3bTdG02PdVXvRkCDyXvpwWSQ5AR522zj3MHf09gtrf3jLHHkYXchdRhjQMJIthfCts9qWYx/Wto3z6/mroUbso63ivil5Nm7VHMhuooqlWfzOQyZpC3Wv7qbsT64n3Ej1bo8bXxOetMnoNX/8W+xBh3NVzLDPOi9PeSZn0zDXY3m5NvmTUO5WE6V8fm/YjwMrfSpzl4m56rY3xi2rfFCfEjkOz6fLZ9Ysa8eg3Quo7zetR8bF2H/t6KJk+N30hdUv3xHpMkegJ6ODmuJXkVtM7Pp+KT/bD++rAqDsBt6DTJ3lUT8a0Nyyx/HbQRuUcr8vlfdjFtAiwlKNxxbQYUMDRlhW8G7uUd2PbeTd2KcdplnCkZyWt5Wim3Jmdx7GhZfQUYBHvzy7kf63Ip5Py37X4XyuW8y5tO/9fxWL+vwob79i2847tIt6xvYp3bJfyju0i3rG9indsl/Je7RLeq52jYnovchQvdhh3tcBeS3+JO44M0BF6kuN28pD/p2EcO6ia9iPt5GifjMRtRnoYv/byb5m2oQ+70OMHOYr1UNzQPUqVVEW7kYroBdxvAVTSI7QVUIX0HaQ9VEHbwZN94FsurdHrvphSdGoyEK8dJigDnTsVVOuwl+OX+1UUc78ekyvEsyJQboYqHbYoeJ57EANC2q4glyNu+5GTPqYn5eA4RqtWnYnTUTJ2Pcr4XQ5twnjmgUeFkIslkLhlkJUV4Pdalq3NkKkayNJJyNBZyM77LDXyv0y+4P8y8UAy/vj/GuThggAAAAEAAAAA1CSYugAAAADPaFUEAAAAANW+F2gAAVmYZukAAA==') format('woff');
}

body{margin:0;padding:0;overflow:hidden;font-family:Exo2,Arial;}
html, body{height:100%;text-size-adjust:100%;}
#player{z-index:2;position:fixed;cursor:move;}
#infopanel{position:fixed;top:20px;left:8px;width:150px;height:150px;text-align:left;z-index:3;line-height:22px;font-size:0.9em;color:#888;}
#exitpanel{position:fixed;top:6px;right:6px;width:24px;height:24px;z-index:3;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhEAAQAJEAAAAAAP///1VVVf///yH5BAEAAAMALAAAAAAQABAAAAIjnI+py6L+BDRy0gqxHVqvLjGcJ3Yl+IEhQpLX+m7wMYv2PRQAOw==) center center no-repeat;}
#zoompanel{position:fixed;top:90px;right:6px;width:50px;height:102px;z-index:3;cursor:pointer;background:no-repeat url(data:image/gif;base64,R0lGODlhMgBmAKEBAAAAAP///8zMzP///yH5BAEKAAMALAAAAAAyAGYAAAL+nI+py+0uopzi2UtzvhxNLHXWJ4YiY55Gqg6sRzVvNx+bHKk5FPNV+cOReMBR77EzgoY+0LK2SOI4N2MQdfVBo9mEFHlUTqlhcNd2xjLFXLTmDWd+Ye64vepK5+v3/nWOxudnR4clOAhX2Ea2Bjb2BPioEMnVSGTIuDVJqQljiSmpRblpBqnnNZp3Kki2ZNW5khq7qgoL62bW+akmunqLqocHLFvZctiyq1VLu/m7zKcj7DlTljmoRoyd2Gs8zczaHb78La6dXd6cjC6kvl7p7D4LH19LH21cbT+8rT/+fk7jVruA5DyVm2ewG8BQAd0t3BMPIMJSrexle9iQjcWCVBiLXOoHkSG9LR1PcCqoMFgQRH4UkZLHkl/Il+Ni4jl5yKYclTl1SsEJ0+dOkRuJjlSJMtqpkow+9uPIlKLTo7QmWmkaUWJSqU/QDRwmLt+rlGJzoYxRlh2xKmnVvniTbmvNOGrDETIr12tbkP749sobVprfY4P/Aba7F+RXxT8KAAA7);}
#optionpanel{position:fixed;bottom:4px;left:0;width:100%;height:20px;z-index:3;text-align:center;font-size:1.1em;}
#optionpanel input{margin:4px 2px 0 2px;cursor:pointer;}
#optionpanel label{line-height:22px;vertical-align:top;cursor:pointer;color:#666;}
#landing{display:none;position:fixed;left:0;top:0;right:0;bottom:0;height:auto;z-index:8;background:#fff;margin:0;text-align:center;font-size:1.25em;padding:10px;line-height:1.8em;}
#landing a{color:#666;text-decoration:none;border-bottom:1px solid #999;}
h1{margin:20px auto 35px;font-size:1.4em;color:#999;font-weight:normal;}
#legend{width:290px;margin:20px auto 0;border-radius:15px;background:#f0f0f0;color:#666;padding:5px;}
#triangle{width:0;height:0;margin:-2px auto 20px;border-left:20px solid transparent;border-right:20px solid transparent;border-top:20px solid #f0f0f0;}
#notifybox{display:none;z-index:9;position:fixed;top:4px;left:4px;width:500px;background:#333;color:#fff;font-weight:bold;border-radius:5px;}
#cross{float:right;width:24px;height:24px;cursor:pointer;background:url(data:image/gif;base64,R0lGODlhEAAQAJEAAAAAAP///1VVVf///yH5BAEAAAMALAAAAAAQABAAAAIjnI+py6L+BDRy0gqxHVqvLjGcJ3Yl+IEhQpLX+m7wMYv2PRQAOw==) center center no-repeat;}
#message{margin:20px;}
#fileapi{color:#999;}
#demobox{display:none;position:fixed;z-index:7;top:2px;left:50%;width:500px;height:20px;margin-left:-250px;font-size:0.7em;text-align:center;line-height:20px;}
#preloader{z-index:1;position:fixed;top:50%;left:50%;margin-left:-63px;width:125px;height:60px;font-size:10px;}
#preloader > div {height:100%;width:15px;display:inline-block;margin:0 5px;background:#666;-webkit-animation:stretchdelay 1.2s infinite ease-in-out;animation:stretchdelay 1.2s infinite ease-in-out;}
#preloader > div.rect1 {background:#6d55ae;}
#preloader > div.rect2 {background:#ffb302;-webkit-animation-delay:-1.1s;animation-delay:-1.1s;}
#preloader > div.rect3 {background:#f44c4d;-webkit-animation-delay:-1.0s;animation-delay:-1.0s;}
#preloader > div.rect4 {background:#acc2b3;-webkit-animation-delay:-0.9s;animation-delay:-0.9s;}
#preloader > div.rect5 {background:#6d55ae;-webkit-animation-delay:-0.8s;animation-delay:-0.8s;}
@-webkit-keyframes stretchdelay {
0%, 40%, 100% { -webkit-transform: scaleY(0.4) }
20% { -webkit-transform: scaleY(1.0) }}
@keyframes stretchdelay {
0%, 40%, 100% {
transform: scaleY(0.4);
-webkit-transform: scaleY(0.4);
} 20% {
transform: scaleY(1.0);
-webkit-transform: scaleY(1.0);
}}
</style>
</head>
<body>
<div id="preloader"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div>
<div id="demobox">You are using demo version. Space group is not shown.</div>
<script type="text/javascript">
/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details
*/
'use strict';var player=function(da){function Z(t){if($[t])return $[t].exports;var m=$[t]={exports:{},id:t,loaded:!1};da[t].call(m.exports,m,m.exports,Z);m.loaded=!0;return m.exports}var $={};Z.m=da;Z.c=$;Z.p="";return Z(0)}([function(da,Z,$){!function(){var t=[$(1),$(4),$(6),$(3)];(function(m,g,v,b){function a(a){a=a||window.event;a.cancelBubble?a.cancelBubble=!0:(a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault())}function c(a){if(q.mpds_integration)window.parent.wmgui.notify(a),
window.parent.close_vibox();else{var c=document.getElementById("notifybox"),b=document.getElementById("message");c.style.display="block";b.innerHTML="";setTimeout(function(){b.innerHTML=a},250)}}function d(a){q.mpds_integration?window.parent.wmgui.notify(a):alert(a)}function e(a,c){var b=document.createElement("div");b.setAttribute("id",a);c&&(b.innerHTML=c);document.body.appendChild(b);return b}function f(a,c,b){b||(b=14540253);var d=new z.Geometry;d.vertices.push(new z.Vector3(a[0],a[1],a[2]));
d.vertices.push(new z.Vector3(c[0],c[1],c[2]));a=new z.LineBasicMaterial({color:b});q.atombox.add(new z.Line(d,a))}function h(a){var c=document.createElement("canvas"),b=c.getContext("2d"),d=3.5*b.measureText(a).width;c.width=d;c.height=30;b.font="normal 30px Exo2";b.textAlign="center";b.textBaseline="middle";b.fillStyle="W"==q.colorset?"#000000":"#FFFFFF";b.fillText(a,c.width/2,c.height/2);a=new z.Texture(c);a.needsUpdate=!0;a=new z.SpriteMaterial({map:a,depthTest:!1});a=new z.Sprite(a);a.renderOrder=
1;c=new z.Object3D;a.scale.set(d,30,1);c.add(a);c.name="label";return c}function k(){q.loaded=!0;q.container=e("player");q.scene=new z.Scene;q.camera=new z.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,2E4);q.camera.position.set(0,0,1800);var c=new z.AmbientLight(10066329);q.scene.add(c);c=new z.PointLight(6710886,1);c.position.set(1500,1500,1500);q.scene.add(c);q.renderer=q.webgl?new z.WebGLRenderer({antialias:!0,alpha:!0}):new z.CanvasRenderer;"W"==q.colorset?q.renderer.setClearColor(16777215,
1):q.renderer.setClearColor(0,1);q.renderer.setPixelRatio(window.devicePixelRatio);q.renderer.setSize(window.innerWidth,window.innerHeight);q.container.appendChild(q.renderer.domElement);e("zoompanel").onclick=function(c){a(c);c=c.pageY?c.pageY:c.clientY;var b=document.getElementById("zoompanel").offsetTop;q.camera.fov-=7.5*(50>c-b?1:-1);q.camera.updateProjectionMatrix()};q.mpds_integration&&(e("exitpanel").onclick=function(){window.parent.close_vibox()});q.controls=new z.TrackballControls(q.camera);
q.controls.rotateSpeed=7.5;q.controls.staticMoving=!0;s()}function s(){var a=q.scene.getObjectByName("atombox");if(a){q.scene.remove(a);var c=a.children.length-1;for(c;0<=c;c--){var b=a.children[c];b.geometry&&b.geometry.dispose();b.material&&b.material.dispose();b.dispose&&b.dispose()}q.controls.reset()}q.atombox=new z.Object3D;(a=document.getElementById("infopanel"))&&a.parentNode.removeChild(a);q.obj3d.descr&&(a=q.obj3d.mpds_data?"":q.obj3d.descr.symlabel?"<i>SG</i> "+q.obj3d.descr.symlabel:"",
e("infopanel","<span style=color:#900><i>a</i>="+(Math.round(1E3*parseFloat(q.obj3d.descr.a))/1E3).toFixed(3)+"&#8491;</span><br /><span style=color:#090><i>b</i>="+(Math.round(1E3*parseFloat(q.obj3d.descr.b))/1E3).toFixed(3)+"&#8491;</span><br /><span style=color:#09f><i>c</i>="+(Math.round(1E3*parseFloat(q.obj3d.descr.c))/1E3).toFixed(3)+"&#8491;</span><br /><i>&#945;</i>="+(Math.round(100*parseFloat(q.obj3d.descr.alpha))/100).toFixed(2)+"&deg;<br /><i>&#946;</i>="+(Math.round(100*parseFloat(q.obj3d.descr.beta))/
100).toFixed(2)+"&deg;<br /><i>&#947;</i>="+(Math.round(100*parseFloat(q.obj3d.descr.gamma))/100).toFixed(2)+"&deg;<br />"+a));(a=document.getElementById("optionpanel"))&&a.parentNode.removeChild(a);a=e("optionpanel","<input type=radio name=optionpanel class=optionpanel id=optionpanel_empty /><label for=optionpanel_empty>none</label>  <input type=radio name=optionpanel class=optionpanel id=optionpanel_S checked=checked /><label for=optionpanel_S>elements</label>");if(Object.keys(q.obj3d.overlayed).length)for(var d in q.obj3d.overlayed)a.innerHTML+=
"  <input type=radio name=optionpanel class=optionpanel id=optionpanel_"+d+" /><label for=optionpanel_"+d+">"+q.obj3d.overlayed[d]+"</label>",q.available_overlays.push(d);a=document.getElementsByClassName("optionpanel");for(d=a.length-1;0<=d;d--)a[d].onclick=function(){var a=this.id.replace("optionpanel_","");if(-1!==q.available_overlays.indexOf(a)){var c=q.scene.getObjectByName("atombox"),c=c.children,b=c.filter(function(a){return"label"==a.name}),d=0,e=b.length;for(d;d<e;d++)q.atombox.remove(b[d]),
q.scene.remove(b[d]);if("empty"!==a){c=c.filter(function(a){return"atom"==a.name});e=c.length;for(d=0;d<e;d++)b=h(c[d].overlays[a]),b.position.set(c[d].position.x,c[d].position.y,c[d].position.z),q.atombox.add(b);q.current_overlay=a}}q.renderer.render(q.scene,q.camera)};q.current_overlay=q.default_overlay;c=q.webgl?{w:10,h:8}:{w:8,h:6};d=0;a=q.obj3d.atoms.length;for(d;d<a;d++){var b=parseInt(100*q.obj3d.atoms[d].x),k=parseInt(100*q.obj3d.atoms[d].y),s=parseInt(100*q.obj3d.atoms[d].z),l=new z.Mesh(new z.SphereBufferGeometry(65*
q.obj3d.atoms[d].r,c.w,c.h),new z.MeshLambertMaterial({color:q.obj3d.atoms[d].c,overdraw:.75}));l.position.set(b,k,s);l.name="atom";l.overlays=q.obj3d.atoms[d].overlays;q.atombox.add(l);"empty"!==q.current_overlay&&(l=h(l.overlays[q.current_overlay]),l.position.set(b,k,s),q.atombox.add(l))}if(q.obj3d.cell.length){var x,a=[];for(d=0;3>d;d++)c=Math.round(1E3*parseFloat(q.obj3d.cell[d][0]))/10,b=Math.round(1E3*parseFloat(q.obj3d.cell[d][1]))/10,k=Math.round(1E3*parseFloat(q.obj3d.cell[d][2]))/10,a.push([c,
b,k]),0==d?x=10027008:1==d?x=39168:2==d&&(x=39423),q.atombox.add(new z.ArrowHelper((new z.Vector3(c,b,k)).normalize(),new z.Vector3(0,0,0),Math.sqrt(c*c+b*b+k*k),x,75,10));d=[a[0][0]+a[1][0],a[0][1]+a[1][1],a[0][2]+a[1][2]];c=[a[0][0]+a[2][0],a[0][1]+a[2][1],a[0][2]+a[2][2]];b=[d[0]+a[2][0],d[1]+a[2][1],d[2]+a[2][2]];k=[a[1][0]+a[2][0],a[1][1]+a[2][1],a[1][2]+a[2][2]];x=[];x.push([a[0],d]);x.push([a[0],c]);x.push([a[1],k]);x.push([a[1],d]);x.push([a[2],k]);x.push([a[2],c]);x.push([d,b]);x.push([c,
b]);x.push([b,k]);d=0;a=x.length;for(d;d<a;d++)f(x[d][0],x[d][1])}q.atombox.name="atombox";q.scene.add(q.atombox);y()}function x(){q.loaded&&(q.camera.aspect=window.innerWidth/window.innerHeight,q.camera.updateProjectionMatrix(),q.renderer.setSize(window.innerWidth,window.innerHeight),q.controls.handleResize(),y())}function y(){K(y);q.renderer.render(q.scene,q.camera);q.controls.update()}function p(){var a=document.location.hash.substr(1);if(-1==a.indexOf("://"))return q.loaded||u(),c("Error: not a valid url!");
r(a)}function u(){if(q.local_supported){var a=document.getElementById("landing");"B"==q.colorset&&(a.style.background="#222");a.style.display="block"}else l()}function l(c){a(c);n(q.sample,!1)}function r(a){var b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){4==b.readyState&&(200==b.status?n(b.responseText,!0):(c("Error: HTTP "+b.status+" status received during retrieving data from the server"),q.loaded||u()))};b.open("GET",a);b.send(1)}
function n(a,c){q.obj3d=m.to_player(a);q.obj3d?(document.getElementById("landing").style.display="none",q.loaded?s():k(),q.obj3d.info&&(document.title=q.obj3d.info),document.getElementById("demobox").style.display=q.obj3d.mpds_data&&q.obj3d.mpds_demo?"block":"none"):q.loaded||u()}function Q(b){a(b);if(1<b.dataTransfer.files.length)return c("Error: only one file at the time may be rendered!");b=b.dataTransfer.files[0];if(!b||!b.size)return c("Error: file cannot be read (unaccessible?)");var d=new FileReader;
d.onloadend=function(a){n(a.target.result,!1)};d.abort=function(){c("Error: file reading has been cancelled!")};d.onerror=function(a){c("Error: file reading has been cancelled: "+a.target.error.name)};d.readAsText(b)}function L(c){a(c);c.dataTransfer.dropEffect="copy"}var q={version:"0.16.6",loaded:!1,container:null,stats:null,camera:null,scene:null,renderer:null,controls:null,atombox:null,available_overlays:["empty","S"],default_overlay:"S"};q.current_overlay=q.default_overlay;q.obj3d=!1;q.local_supported=
window.File&&window.FileReader&&window.FileList&&window.Blob;q.mpds_integration=window.parent&&window.parent.wmgui;q.webgl=function(){try{var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(c){return!1}}();q.colorset="W";q.sample="data_example\n_cell_length_a 24\n_cell_length_b 5.91\n_cell_length_c 5.85\n_cell_angle_alpha 90\n_cell_angle_beta 90\n_cell_angle_gamma 90\n_symmetry_space_group_name_H-M 'P1'\nloop_\n_symmetry_equiv_pos_as_xyz\nx,y,z\nloop_\n_atom_site_label\n_atom_site_type_symbol\n_atom_site_fract_x\n_atom_site_fract_y\n_atom_site_fract_z\n_atom_site_charge\nO1 O 0.425 0.262 0.009 -2.0\nO2 O -0.425 0.262 0.009 -2.0\nH3 H 0.444 0.258 0.154 1.0\nH4 H -0.444 0.258 0.154 1.0\nH5 H 0.396 0.124 0.012 1.0\nH6 H -0.396 0.124 0.012 1.0\nO7 O 0.425 0.236 0.510 -2.0\nO8 O -0.425 0.236 0.510 -2.0\nH9 H 0.444 0.239 0.656 1.0\nH10 H -0.444 0.239 0.656 1.0\nH11 H 0.396 0.374 0.512 1.0\nH12 H -0.396 0.374 0.512 1.0\nSr13 Sr 0.342 0.964 0.467 2.0\nSr14 Sr -0.342 0.964 0.467 2.0\nSr15 Sr 0.342 0.535 0.967 2.0\nSr16 Sr -0.342 0.535 0.967 2.0\nO17 O 0.348 0.971 0.019 -2.0\nO18 O -0.348 0.971 0.019 -2.0\nO19 O 0.348 0.528 0.519 -2.0\nO20 O -0.348 0.528 0.519 -2.0\nO21 O 0.263 0.803 0.701 -2.0\nO22 O -0.263 0.803 0.701 -2.0\nO23 O 0.264 0.695 0.200 -2.0\nO24 O -0.264 0.695 0.200 -2.0\nZr25 Zr 0.261 0.000 0.998 4.0\nZr26 Zr -0.261 0.000 0.998 4.0\nZr27 Zr 0.261 0.499 0.498 4.0\nZr28 Zr -0.261 0.499 0.498 4.0\nO29 O 0.257 0.304 0.806 -2.0\nO30 O -0.257 0.304 0.806 -2.0\nO31 O 0.257 0.195 0.306 -2.0\nO32 O -0.257 0.195 0.306 -2.0\nSr33 Sr 0.173 0.993 0.524 2.0\nSr34 Sr -0.173 0.993 0.524 2.0\nSr35 Sr 0.173 0.506 0.024 2.0\nSr36 Sr -0.173 0.506 0.024 2.0\nO37 O 0.173 0.947 0.986 -2.0\nO38 O -0.173 0.947 0.986 -2.0\nO39 O 0.173 0.551 0.486 -2.0\nO40 O -0.173 0.551 0.486 -2.0\nO41 O 0.098 0.204 0.295 -2.0\nO42 O -0.098 0.204 0.295 -2.0\nO43 O 0.098 0.295 0.795 -2.0\nO44 O -0.098 0.295 0.795 -2.0\nZr45 Zr 0.086 0.004 0.998 4.0\nZr46 Zr -0.086 0.004 0.998 4.0\nZr47 Zr 0.086 0.495 0.498 4.0\nZr48 Zr -0.086 0.495 0.498 4.0\nO49 O 0.074 0.709 0.211 -2.0\nO50 O -0.074 0.709 0.211 -2.0\nO51 O 0.074 0.790 0.711 -2.0\nO52 O -0.074 0.790 0.711 -2.0\nSr53 Sr 0 0.991 0.467 2.0\nSr54 Sr 0 0.508 0.967 2.0\nO55 O 0 0.076 0.020 -2.0\nO56 O 0 0.423 0.520 -2.0";
var z=v.THREE||v,K=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1E3/60)};b(function(){q.webgl=!0;var a=e("notifybox",'<div id="cross"></div><div id="message"></div>');document.getElementById("cross").onclick=function(){a.style.display="none"};e("landing",'<h1>CIF and POSCAR web-viewer</h1><div id="legend">Choose a <b>CIF</b> or <b>POSCAR</b> file (drag and drop is supported). Files are processed offline in the browser, no remote server is used. <a href=/ id="play_demo">Example</a>.</div><div id="triangle"></div><input type="file" id="fileapi" />');
document.getElementById("play_demo").onclick=l;m=m(g,{warning:d,error:c});window.addEventListener("resize",x,!1);window.addEventListener("hashchange",p,!1);if(q.local_supported){window.addEventListener("dragover",L,!1);window.addEventListener("drop",Q,!1);var b=document.getElementById("fileapi"),f=new FileReader;b.onchange=function(){if(!this.files[0]||!this.files[0].size)return c("Error: file cannot be read (unaccessible?)");f.currentFilename=this.files[0].name;f.readAsText(this.files[0])};f.onloadend=
function(a){n(a.target.result,!1)}}window.parent&&window.parent.playerdata?(b="object"===typeof window.parent.playerdata&&document.location.search?window.parent.playerdata[document.location.search.substr(1)]:window.parent.playerdata,n(b,!1)):document.location.hash.length?p():u()})}).apply(null,t)}()},function(da,Z,$){"use strict";String.prototype.startswith=function(t){return 0===this.indexOf(t)};String.prototype.endswith=function(t,m){var g=this.toString();if(void 0===m||m>g.length)m=g.length;m-=
t.length;g=g.indexOf(t,m);return-1!==g&&g===m};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.isnumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)};Z=function(t,m){function g(a){if(0<a.indexOf("_cell_angle_gamma ")&&0<a.indexOf("loop_"))return"CIF";a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");for(var c=6;9>c&&a[c];c++)if("direct"==a[c].trim().toLowerCase().substr(0,6))return"POSCAR";return"unknown"}function v(a,c,b,d,e,y){if(!(a&&c&&
b&&d&&e&&y))return m.error("Error: invalid cell definition!"),!1;d=d*Math.PI/180;e=e*Math.PI/180;y=y*Math.PI/180;var p=[0,0,1],u=[1,0,0],p=t.divide(p,t.norm(p)),u=t.subtract(u,t.multiply(t.dot(u,p),p)),u=t.divide(u,t.norm(u)),l=t.cross(p,u);a=t.multiply(a,[1,0,0]);c=t.multiply(c,[t.cos(y),t.sin(y),0]);var r=t.cos(e);d=t.divide(t.subtract(t.cos(d),t.multiply(t.cos(e),t.cos(y))),t.sin(y));e=t.sqrt(t.subtract(t.subtract(1,t.multiply(r,r)),t.multiply(d,d)));b=t.multiply(b,[r,d,e]);return t.multiply([a,
c,b],[u,l,p])}function b(a){a.symops&&m.warning("Warning! Reading of symmetry operations is not yet implemented, expect error now.");var c;c=6==Object.keys(a.cell).length?v(a.cell.a,a.cell.b,a.cell.c,a.cell.alpha,a.cell.beta,a.cell.gamma):a.cell;var b=[],d=[],e=[],y=[],b=c[0].map(function(a,b){return c.map(function(a){return a[b]})}),d=d.concat.apply(d,b),p=0,u=a.atoms.length;if(a.types)for(p;p<u;p++)y.push([a.atoms[p].x,a.atoms[p].y,a.atoms[p].z]);else{var l=[],b={};for(p;p<u;p++)-1==Object.keys(b).indexOf(a.atoms[p].symbol)?
b[a.atoms[p].symbol]=[[a.atoms[p].x,a.atoms[p].y,a.atoms[p].z]]:b[a.atoms[p].symbol].push([a.atoms[p].x,a.atoms[p].y,a.atoms[p].z]);var p=1,r;for(r in b){for(u=0;u<b[r].length;u++)y.push(b[r][u]),l.push(p);p++}}e=e.concat.apply(e,y);return{cell:d,atoms:e,types:l||a.types,symlabel:a.sg_name||a.ng_name?(a.sg_name?a.sg_name:"")+(a.ng_name?" ("+a.ng_name+")":""):!1}}function a(a){var c=[],b=[],s=[];a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var x={cell:{},atoms:[]},y=!1,p=!1,u=!1,l="",r="",
n="",r=[],Q="a b c alpha beta gamma".split(" "),L=["_atom_site_label","_atom_site_type_symbol","_atom_site_fract_x","_atom_site_fract_y","_atom_site_fract_z"],q=["label","symbol","x","y","z"],z=[0,1],K=[],A;for(A in e)K.push(L.length),L.push(A);A=0;var C=a.length;for(A;A<C;A++)if(!a[A].startswith("#"))if(r=a[A].trim()){n=r.toLowerCase();p=!1;if(n.startswith("data_"))p=!0,y=!1,s=[],u=!1,l=r.substr(5);else if(n.startswith("_cell_")){y=!1;r=r.split(" ");p=r[0].split("_");p=p[p.length-1];-1!==Q.indexOf(p)&&
r[r.length-1]&&("a"==p&&(n=r[r.length-1].split("."),2==n[n.length-1].length&&(x.mpds_demo=!0)),x.cell[p]=parseFloat(r[r.length-1]));continue}else if(n.startswith("_symmetry_space_group_name_h-m")||n.startswith("_space_group.patterson_name_h-m")){y=!1;x.sg_name=a[A].substr(31).replace(/"/g,"").replace(/'/g,"").trim();continue}else if(n.startswith("_space_group.it_number")||n.startswith("_space_group_it_number")||n.startswith("_symmetry_int_tables_number")){y=!1;r=r.split(" ");x.ng_name=r[r.length-
1].trim();continue}else{if(n.startswith("_cif_error"))return m.error(r.substr(12,r.length-13)),!1;if(n.startswith("_pauling_file_entry")){x.mpds_data=!0;continue}else if(n.startswith("loop_")){y=!0;s=[];u=!1;continue}}if(y)if(r.startswith("_symmetry_equiv")||r.startswith("_space_group"))u=!0;else if(r.startswith("_"))s.push(r);else if(u)b.push(r.replace(/"/g,"").replace(/'/g,""));else{var p={overlays:{}},r=r.replace(/\t/g," ").split(" ").filter(function(a){return a?!0:!1}),n=0,F=s.length;for(n;n<
F;n++){var g=L.indexOf(s[n]);if(-1!=g){var E=z.indexOf(g);1==E?r[n]=r[n].charAt(0).toUpperCase()+r[n].slice(1).toLowerCase():0>E&&(r[n]=parseFloat(r[n]));-1<K.indexOf(g)?p.overlays[L[g]]=r[n]:p[q[g]]=r[n]}}void 0!==p.x&&void 0!==p.y&&void 0!==p.z&&(p.label&&(p.overlays.label=p.label,p.symbol||(p.symbol=p.label.replace(/[0-9]/g,""))),!d.JmolColors[p.symbol]&&p.symbol&&1<p.symbol.length&&(p.symbol=p.symbol.substr(0,p.symbol.length-1)),p.symbol&&x.atoms.push(p))}else p&&x.atoms.length&&(x.info=l,1<b.length&&
(x.symops=b),c.push(x),x={cell:{},atoms:[]},b=[])}else y=!1,s=[],u=!1;x.cell.gamma&&(x.info=l,1<b.length&&(x.symops=b),c.push(x));if(c.length)return c[c.length-1];m.error("Error: unexpected CIF format!");return!1}function c(a){a=a.toString().replace(/(\r\n|\r)/gm,"\n").split("\n");var c=[],b=[],e=1,x=[],y=[],p=[],u=[],l=["x","y","z","symbol"],r=0,n=0,Q=a.length,g=[],q=0,g=[],z=[];r;a:for(;r<Q;r++)if(0==r){g=a[r].split(" ").filter(function(a){return a?!0:!1});z=Object.keys(d.AseRadii);for(n=0;n<g.length;n++)if(-1==
z.indexOf(g[n]))continue a;y=g}else if(1==r)e=parseFloat(a[r]);else if(-1!==[2,3,4].indexOf(r))c.push(a[r].split(" ").filter(function(a){return a?!0:!1}).map(Number));else if(5==r)if(g=a[r].split(" ").filter(function(a){return a?!0:!1}),g[0].isnumeric())for(x=g.map(Number),n=0;n<x.length;n++)for(g=0;g<x[n];g++)u.push(n+1);else y=g;else if(6==r){if("direct"==a[r].trim().toLowerCase().substr(0,6))continue a;g=a[r].split(" ").filter(function(a){return a?!0:!1});if(g[0].isnumeric())for(x=g.map(Number),
n=0;n<x.length;n++)for(g=0;g<x[n];g++)u.push(n+1);else y=g}else if(6<r){if(9>r){if(y.length&&!p.length)for(n=0;n<y.length;n++)for(g=0;g<x[n];g++)p.push(y[n]);if(-1!==["direct","select"].indexOf(a[r].trim().toLowerCase().substr(0,6)))continue a}z={};g=a[r].replace("#","").replace("!","").split(" ").filter(function(a){return a?!0:!1});if(!g.length)break;else if(3==g.length)p.length?g.push(p[q]):g.push("Xx");else if(3>g.length)return m.error("Error: invalid atom definition!"),!1;for(n=0;4>n;n++)z[l[n]]=
3>n?parseFloat(g[n]):g[n];z.symbol=z.symbol.replace(/\W+/,"").replace(/\d+/,"");z.symbol.length||(z.symbol="Xx");b.push(z);q++}c=t.multiply(c,e);if(b.length)return{cell:c,atoms:b,types:u};m.error("Error: unexpected POSCAR format!");return!1}var d={JmolColors:{D:"#FFFFC0",H:"#FFFFFF",He:"#D9FFFF",Li:"#CC80FF",Be:"#C2FF00",B:"#FFB5B5",C:"#909090",N:"#3050F8",O:"#FF0D0D",F:"#90E050",Ne:"#B3E3F5",Na:"#AB5CF2",Mg:"#8AFF00",Al:"#BFA6A6",Si:"#F0C8A0",P:"#FF8000",S:"#FFFF30",Cl:"#1FF01F",Ar:"#80D1E3",K:"#8F40D4",
Ca:"#3DFF00",Sc:"#E6E6E6",Ti:"#BFC2C7",V:"#A6A6AB",Cr:"#8A99C7",Mn:"#9C7AC7",Fe:"#E06633",Co:"#F090A0",Ni:"#50D050",Cu:"#C88033",Zn:"#7D80B0",Ga:"#C28F8F",Ge:"#668F8F",As:"#BD80E3",Se:"#FFA100",Br:"#A62929",Kr:"#5CB8D1",Rb:"#702EB0",Sr:"#00FF00",Y:"#94FFFF",Zr:"#94E0E0",Nb:"#73C2C9",Mo:"#54B5B5",Tc:"#3B9E9E",Ru:"#248F8F",Rh:"#0A7D8C",Pd:"#006985",Ag:"#C0C0C0",Cd:"#FFD98F",In:"#A67573",Sn:"#668080",Sb:"#9E63B5",Te:"#D47A00",I:"#940094",Xe:"#429EB0",Cs:"#57178F",Ba:"#00C900",La:"#70D4FF",Ce:"#FFFFC7",
Pr:"#D9FFC7",Nd:"#C7FFC7",Pm:"#A3FFC7",Sm:"#8FFFC7",Eu:"#61FFC7",Gd:"#45FFC7",Tb:"#30FFC7",Dy:"#1FFFC7",Ho:"#00FF9C",Er:"#00E675",Tm:"#00D452",Yb:"#00BF38",Lu:"#00AB24",Hf:"#4DC2FF",Ta:"#4DA6FF",W:"#2194D6",Re:"#267DAB",Os:"#266696",Ir:"#175487",Pt:"#D0D0E0",Au:"#FFD123",Hg:"#B8B8D0",Tl:"#A6544D",Pb:"#575961",Bi:"#9E4FB5",Po:"#AB5C00",At:"#754F45",Rn:"#428296",Fr:"#420066",Ra:"#007D00",Ac:"#70ABFA",Th:"#00BAFF",Pa:"#00A1FF",U:"#008FFF",Np:"#0080FF",Pu:"#006BFF",Am:"#545CF2",Cm:"#785CE3",Bk:"#8A4FE3",
Cf:"#A136D4",Es:"#B31FD4",Fm:"#B31FBA",Md:"#B30DA6",No:"#BD0D87",Lr:"#C70066",Rf:"#CC0059",Db:"#D1004F",Sg:"#D90045",Bh:"#E00038",Hs:"#E6002E",Mt:"#EB0026"},AseRadii:{X:.66,H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.39,Fe:1.32,Co:1.26,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,
Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.87,Hf:1.75,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69,Bk:3,Cf:3,Es:3,Fm:3,Md:3,No:3,Lr:3,Rf:3,Db:3,Sg:3,Bh:3,Hs:3,Mt:3}},e={_atom_site_occupancy:"site occupancies",
_atom_site_charge:"formal charges",label:"labels"};return{to_player:function(b){var h;switch(g(b)){case "CIF":h=a(b);break;case "POSCAR":h=c(b);break;default:m.error("Error: file format cannot be recognized!")}if(!h)return!1;b=h;var k=!1;if(6==Object.keys(b.cell).length){h=v(b.cell.a,b.cell.b,b.cell.c,b.cell.alpha,b.cell.beta,b.cell.gamma);var k=b.cell,s=b.sg_name||b.ng_name?(b.sg_name?b.sg_name:"")+(b.ng_name?" ("+b.ng_name+")":""):!1;s&&(k.symlabel=s)}else h=b.cell;b.atoms.length||m.warning("Note: no atomic coordinates supplied");
var k={atoms:[],cell:h,descr:k,overlayed:{},info:b.info,mpds_data:b.mpds_data,mpds_demo:b.mpds_demo},x,y,p,s={},u=0,l=b.atoms.length,r={};for(u;u<l;u++){var n=[b.atoms[u].x,b.atoms[u].y,b.atoms[u].z],Q=n.join(",");if(r.hasOwnProperty(Q))for(p in k.atoms[r[Q]].overlays)x="S"==p?" "+b.atoms[u].symbol:"N"==p?", "+(u+1):"_atom_site_occupancy"==p?"+"+b.atoms[u].overlays[p]:" "+b.atoms[u].overlays[p],k.atoms[r[Q]].overlays[p]+=x;else{x=d.JmolColors[b.atoms[u].symbol]?d.JmolColors[b.atoms[u].symbol]:"0xffff00";
y=d.AseRadii[b.atoms[u].symbol]?d.AseRadii[b.atoms[u].symbol]:.66;s={S:b.atoms[u].symbol,N:u+1};for(p in b.atoms[u].overlays)s[p]=b.atoms[u].overlays[p];n=t.multiply(n,h);k.atoms.push({x:n[0],y:n[1],z:n[2],c:x,r:y,overlays:s});r[Q]=k.atoms.length-1}}for(var L in s)"S"!==L&&"N"!==L&&(k.overlayed[L]=e[L]);return k},to_flatten:function(d){var e;switch(g(d)){case "CIF":e=a(d);break;case "POSCAR":e=c(d);break;default:m.error("Error: file format cannot be recognized!")}return e?b(e):!1},version:"0.0.3.5"}};
"undefined"!==typeof da&&da.exports?da.exports=Z:"function"===typeof $(2).specified&&!(void 0!==Z&&(da.exports=Z))},function(da,Z,$){function t(g){return $(m(g))}function m(m){var b;if(!(b=g[m]))throw Error("Cannot find module '"+m+"'.");return b}var g={"./domReady":3,"./domReady.js":3,"./math.custom":4,"./math.custom.js":4,"./matinfio":1,"./matinfio.js":1,"./require":5,"./require.js":5,"./three.custom":6,"./three.custom.js":6};t.keys=function(){return Object.keys(g)};t.resolve=m;da.exports=t;t.id=
2},function(da,Z,$){var t;!(t=function(){function m(){if(!d){d=!0;a&&clearInterval(a);var b=f;if(d&&b.length){f=[];var c;for(c=0;c<b.length;c+=1)b[c](e)}}}function g(a){d?a(e):f.push(a);return g}var v,b,a,c="undefined"!==typeof window&&window.document,d=!c,e=c?document:null,f=[];if(c){if(document.addEventListener)document.addEventListener("DOMContentLoaded",m,!1),window.addEventListener("load",m,!1);else if(window.attachEvent){window.attachEvent("onload",m);b=document.createElement("div");try{v=null===
window.frameElement}catch(h){}b.doScroll&&v&&window.external&&(a=setInterval(function(){try{b.doScroll(),m()}catch(a){}},30))}"complete"===document.readyState&&m()}g.version="2.0.1";g.load=function(a,b,c,d){d.isBuild?c(null):g(c)};return g}.call(Z,$,Z,da),void 0!==t&&(da.exports=t))},function(da,Z,$){(function(t,m){da.exports=m()})(this,function(){return function(t){function m(v){if(g[v])return g[v].exports;var b=g[v]={exports:{},id:v,loaded:!1};t[v].call(b.exports,b,b.exports,m);b.loaded=!0;return b.exports}
var g={};m.m=t;m.c=g;m.p="";return m(0)}([function(t,m,g){m=g(1).create();m.import(g(13));m.import(g(23));m.import(g(24));m.import(g(26));m.import(g(27));m.import(g(28));m.import(g(55));m.import(g(43));m.import(g(60));m.import(g(62));m.import(g(63));t.exports=m},function(t,m,g){t.exports=g(2)},function(t,m,g){var v=g(3).isFactory;g(3);var b=g(4),a=g(8),c=g(10),d=g(12);m.create=function(e){function f(a){if(!v(a))throw Error("Factory object with properties `type`, `name`, and `factory` expected");var c=
h.indexOf(a);-1===c?(c=!0===a.math?a.factory(s.type,x,f,s.typed,s):a.factory(s.type,x,f,s.typed),h.push(a),k.push(c)):c=k[c];return c}if("function"!==typeof Object.create)throw Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var h=[],k=[],s=a.mixin({});s.type={};s.expression={transform:Object.create(s)};s.typed=b.create(s.type);var x={epsilon:1E-12,matrix:"Matrix",number:"number",precision:64,predictable:!1};s["import"]=f(c);s.config=
f(d);e&&s.config(e);return s}},function(t,m){m.clone=function v(b){var a=typeof b;if("number"===a||"string"===a||"boolean"===a||null===b||void 0===b)return b;if("function"===typeof b.clone)return b.clone();if(Array.isArray(b))return b.map(function(a){return v(a)});if(b instanceof Number)return new Number(b.valueOf());if(b instanceof String)return new String(b.valueOf());if(b instanceof Boolean)return new Boolean(b.valueOf());if(b instanceof Date)return new Date(b.valueOf());if(b&&!0===b.isBigNumber)return b;
if(b instanceof RegExp)throw new TypeError("Cannot clone "+b);var a={},c;for(c in b)b.hasOwnProperty(c)&&(a[c]=v(b[c]));return a};m.extend=function(m,b){for(var a in b)b.hasOwnProperty(a)&&(m[a]=b[a]);return m};m.deepExtend=function b(a,c){if(Array.isArray(c))throw new TypeError("Arrays are not supported by deepExtend");for(var d in c)if(c.hasOwnProperty(d))if(c[d]&&c[d].constructor===Object)void 0===a[d]&&(a[d]={}),a[d].constructor===Object?b(a[d],c[d]):a[d]=c[d];else{if(Array.isArray(c[d]))throw new TypeError("Arrays are not supported by deepExtend");
a[d]=c[d]}return a};m.deepEqual=function(b,a){var c,d;if(Array.isArray(b)){if(!Array.isArray(a)||b.length!=a.length)return!1;c=0;for(d=b.length;c<d;c++)if(!m.deepEqual(b[c],a[c]))return!1;return!0}if(b instanceof Object){if(Array.isArray(a)||!(a instanceof Object))return!1;for(c in b)if(!m.deepEqual(b[c],a[c]))return!1;for(c in a)if(!m.deepEqual(b[c],a[c]))return!1;return!0}return typeof b===typeof a&&b==a};m.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},
"x",{get:function(){}}),!0}catch(b){}return!1};m.lazy=function(b,a,c){if(m.canDefineProperty()){var d=!0,e;Object.defineProperty(b,a,{get:function(){d&&(e=c(),d=!1);return e},set:function(a){e=a;d=!1},configurable:!0,enumerable:!0})}else b[a]=c()};m.traverse=function(b,a){var c=b;if(a)for(var d=a.split("."),e=0;e<d.length;e++){var f=d[e];f in c||(c[f]={});c=c[f]}return c};m.isFactory=function(b){return b&&"function"===typeof b.factory}},function(t,m,g){var v=g(5),b=g(6).digits,a=function(){a=v.create;
return v};m.create=function(c){var d=a();d.types=[{name:"number",test:function(a){return"number"===typeof a}},{name:"Complex",test:function(a){return a&&a.isComplex}},{name:"BigNumber",test:function(a){return a&&a.isBigNumber}},{name:"Fraction",test:function(a){return a&&a.isFraction}},{name:"Unit",test:function(a){return a&&a.isUnit}},{name:"string",test:function(a){return"string"===typeof a}},{name:"Array",test:Array.isArray},{name:"Matrix",test:function(a){return a&&a.isMatrix}},{name:"DenseMatrix",
test:function(a){return a&&a.isDenseMatrix}},{name:"SparseMatrix",test:function(a){return a&&a.isSparseMatrix}},{name:"ImmutableDenseMatrix",test:function(a){return a&&a.isImmutableDenseMatrix}},{name:"Range",test:function(a){return a&&a.isRange}},{name:"Index",test:function(a){return a&&a.isIndex}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"ResultSet",test:function(a){return a&&a.isResultSet}},{name:"Help",test:function(a){return a&&a.isHelp}},{name:"function",test:function(a){return"function"===
typeof a}},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",test:function(a){return void 0===a}}];d.conversions=[{from:"number",to:"BigNumber",convert:function(a){if(15<b(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+a+"). Use function bignumber(x) to convert to BigNumber.");
return new c.BigNumber(a)}},{from:"number",to:"Complex",convert:function(a){return new c.Complex(a,0)}},{from:"number",to:"string",convert:function(a){return a+""}},{from:"BigNumber",to:"Complex",convert:function(a){return new c.Complex(a.toNumber(),0)}},{from:"Fraction",to:"Complex",convert:function(a){return new c.Complex(a.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(a){if(15<b(a))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to Fraction (value: "+
a+"). Use function fraction(x) to convert to Fraction.");return new c.Fraction(a)}},{from:"string",to:"number",convert:function(a){var c=Number(a);if(isNaN(c))throw Error('Cannot convert "'+a+'" to a number');return c}},{from:"boolean",to:"number",convert:function(a){return+a}},{from:"boolean",to:"BigNumber",convert:function(a){return new c.BigNumber(+a)}},{from:"boolean",to:"Fraction",convert:function(a){return new c.Fraction(+a)}},{from:"boolean",to:"string",convert:function(a){return+a}},{from:"null",
to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new c.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new c.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(a){return new c.DenseMatrix(a)}},{from:"Matrix",to:"Array",convert:function(a){return a.valueOf()}}];return d}},function(t,m,g){var v,b,a;"use strict";(function(c,d){!(b=[],v=d,a="function"===typeof v?v.apply(m,
b):v,void 0!==a&&(t.exports=a))})(this,function(){function a(){function b(a){for(var c,d=0;d<q.types.length;d++){var e=q.types[d];if(e.name===a){c=e.test;break}}if(!c){for(var f,d=0;d<q.types.length;d++)if(e=q.types[d],e.name.toLowerCase()==a.toLowerCase()){f=e.name;break}throw Error('Unknown type "'+a+'"'+(f?'. Did you mean "'+f+'"?':""));}return c}function e(a){for(var c="",b=0;b<a.length;b++){var d=a[b];if(d.signatures&&""!=d.name)if(""==c)c=d.name;else if(c!=d.name)throw a=Error("Function names do not match (expected: "+
c+", actual: "+d.name+")"),a.data={actual:d.name,expected:c},a;}return c}function f(a,c,b,d,e){var f=l(d);e=e?e.split(","):null;var k=a||"unnamed",h=e&&-1!==e.indexOf("any");a={fn:a,index:b,actual:d,expected:e};c=e?c>b&&!h?"Unexpected type of argument in function "+k+" (expected: "+e.join(" or ")+", actual: "+f+", index: "+b+")":"Too few arguments in function "+k+" (expected: "+e.join(" or ")+", index: "+b+")":"Too many arguments in function "+k+" (expected: "+b+", actual: "+c+")";c=new TypeError(c);
c.data=a;return c}function h(a){this.name=a||"refs";this.categories={}}function k(a,c){if("string"===typeof a){var b=a.trim(),d="..."===b.substr(0,3);d&&(b=b.substr(3));if(""===b)this.types=["any"];else for(this.types=b.split("|"),b=0;b<this.types.length;b++)this.types[b]=this.types[b].trim()}else if(Array.isArray(a))this.types=a;else{if(a instanceof k)return a.clone();throw Error("String or Array expected");}this.conversions=[];this.varArgs=d||c||!1;this.anyType=-1!==this.types.indexOf("any")}function s(a,
c){var b;if("string"===typeof a)b=""!==a?a.split(","):[];else if(Array.isArray(a))b=a;else throw Error("string or Array expected");this.params=Array(b.length);for(var d=0;d<b.length;d++){var e=new k(b[d]);this.params[d]=e;if(d===b.length-1)this.varArgs=e.varArgs;else if(e.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."');}this.fn=c}function x(a,b,c){this.path=a||[];this.param=a[a.length-1]||null;this.signature=b||null;this.childs=c||[]}function y(a){var b,c={},d=[],e,f;
for(f in a)if(a.hasOwnProperty(f)&&(b=new s(f,a[f]),!b.ignore()))for(b=b.expand(),e=0;e<b.length;e++){var k=b[e],h=k.toString(),l=c[h];if(l)if(l=s.compare(k,l),0>l)c[h]=k;else{if(0===l)throw Error('Signature "'+h+'" is defined twice');}else c[h]=k}for(h in c)c.hasOwnProperty(h)&&d.push(c[h]);d.sort(function(a,c){return s.compare(a,c)});for(e=0;e<d.length;e++)if(b=d[e],b.varArgs)for(a=b.params.length-1,c=b.params[a],f=0;f<c.types.length;){if(c.conversions[f])for(h=c.types[f],k=0;k<d.length;k++){var l=
d[k],x=l.params[a];if(l!==b&&x&&-1!==x.types.indexOf(h)&&!x.conversions[a]){c.types.splice(f,1);c.conversions.splice(f,1);f--;break}}f++}return d}function p(a,c){var b,d,e=c.length,f,h=[];for(b=0;b<a.length;b++)d=a[b],d.params.length!==e||f||(f=d),void 0!=d.params[e]&&h.push(d);h.sort(function(a,b){return k.compare(a.params[e],b.params[e])});var l=[];for(b=0;b<h.length;b++){d=h[b];var s=d.params[e],n=l.filter(function(a){return a.param.overlapping(s)})[0];if(n){if(n.param.varArgs)throw Error('Conflicting types "'+
n.param+'" and "'+s+'"');n.signatures.push(d)}else l.push({param:s,signatures:[d]})}d=Array(l.length);for(b=0;b<l.length;b++)h=l[b],d[b]=p(h.signatures,c.concat(h.param));return new x(c,f,d)}function u(a,b){var c=new h,d=y(b);if(0==d.length)throw Error("No signatures provided");for(var e=p(d,[]),k=[],l=a||"",s=0,x=0;x<d.length;x++){var n=d[x].params.length;n>s&&(s=n)}x=[];for(n=0;n<s;n++)x[n]="arg"+n;k.push("function "+l+"("+x.join(", ")+") {");k.push('  "use strict";');k.push("  var name = '"+l+
"';");k.push(e.toCode(c,"  "));k.push("}");e=[c.toCode(),"return "+k.join("\n")].join("\n");c=(new Function(c.name,"createError",e))(c,f);e={};for(k=0;k<d.length;k++)l=d[k],l.fn&&!l.hasConversions()&&(s=l.params.join(","),e[s]=l.fn);c.signatures=e;return c}function l(a){for(var b,c=0;c<q.types.length;c++){var d=q.types[c];if("Object"===d.name)b=d;else if(d.test(a))return d.name}return b&&b.test(a)?b.name:"unknown"}h.prototype.add=function(a,b){var c=b||"fn";this.categories[c]||(this.categories[c]=
[]);var d=this.categories[c].indexOf(a);-1==d&&(d=this.categories[c].length,this.categories[c].push(a));return c+d};h.prototype.toCode=function(){var a=[],c=this.name+".categories",b=this.categories,d;for(d in b)if(b.hasOwnProperty(d))for(var e=b[d],f=0;f<e.length;f++)a.push("var "+d+f+" = "+c+"['"+d+"']["+f+"];");return a.join("\n")};k.compare=function(a,b){if(a.anyType)return 1;if(b.anyType)return-1;if(-1!==a.types.indexOf("Object"))return 1;if(-1!==b.types.indexOf("Object"))return-1;if(a.hasConversions()){if(b.hasConversions()){var c,
d,e;for(c=0;c<a.conversions.length;c++)if(void 0!==a.conversions[c]){d=a.conversions[c];break}for(c=0;c<b.conversions.length;c++)if(void 0!==b.conversions[c]){e=b.conversions[c];break}return q.conversions.indexOf(d)-q.conversions.indexOf(e)}return 1}if(b.hasConversions())return-1;var f,k;for(c=0;c<q.types.length;c++)if(q.types[c].name===a.types[0]){f=c;break}for(c=0;c<q.types.length;c++)if(q.types[c].name===b.types[0]){k=c;break}return f-k};k.prototype.overlapping=function(a){for(var c=0;c<this.types.length;c++)if(-1!==
a.types.indexOf(this.types[c]))return!0;return!1};k.prototype.clone=function(){var a=new k(this.types.slice(),this.varArgs);a.conversions=this.conversions.slice();return a};k.prototype.hasConversions=function(){return 0<this.conversions.length};k.prototype.contains=function(a){for(var c=0;c<this.types.length;c++)if(a[this.types[c]])return!0;return!1};k.prototype.toString=function(a){for(var c=[],b={},d=0;d<this.types.length;d++){var e=this.conversions[d],e=a&&e?e.to:this.types[d];e in b||(b[e]=!0,
c.push(e))}return(this.varArgs?"...":"")+c.join("|")};s.prototype.clone=function(){return new s(this.params.slice(),this.fn)};s.prototype.expand=function(){function a(b,d){if(d.length<b.params.length){var e,f,h,l=b.params[d.length];if(l.varArgs){f=l.clone();for(e=0;e<q.conversions.length;e++)if(h=q.conversions[e],-1===l.types.indexOf(h.from)&&-1!==l.types.indexOf(h.to)){var x=f.types.length;f.types[x]=h.from;f.conversions[x]=h}a(b,d.concat(f))}else{for(e=0;e<l.types.length;e++)a(b,d.concat(new k(l.types[e])));
for(e=0;e<q.conversions.length;e++)h=q.conversions[e],-1===l.types.indexOf(h.from)&&-1!==l.types.indexOf(h.to)&&(f=new k(h.from),f.conversions[0]=h,a(b,d.concat(f)))}}else c.push(new s(d,b.fn))}var c=[];a(this,[]);return c};s.compare=function(a,c){if(a.params.length>c.params.length)return 1;if(a.params.length<c.params.length)return-1;var b,d=a.params.length,e=0,f=0;for(b=0;b<d;b++)a.params[b].hasConversions()&&e++,c.params[b].hasConversions()&&f++;if(e>f)return 1;if(e<f)return-1;for(b=0;b<a.params.length;b++)if(d=
k.compare(a.params[b],c.params[b]),0!==d)return d;return 0};s.prototype.hasConversions=function(){for(var a=0;a<this.params.length;a++)if(this.params[a].hasConversions())return!0;return!1};s.prototype.ignore=function(){for(var a={},c=0;c<q.ignore.length;c++)a[q.ignore[c]]=!0;for(c=0;c<this.params.length;c++)if(this.params[c].contains(a))return!0;return!1};s.prototype.toCode=function(a,c){for(var b=Array(this.params.length),d=0;d<this.params.length;d++){var e=this.params[d],f=e.conversions[0];b[d]=
e.varArgs?"varArgs":f?a.add(f.convert,"convert")+"(arg"+d+")":"arg"+d}return(d=this.fn?a.add(this.fn,"signature"):void 0)?c+"return "+d+"("+b.join(", ")+"); // signature: "+this.params.join(", "):""};s.prototype.toString=function(){return this.params.join(", ")};x.prototype.toCode=function(a,c,e){var f=[];if(this.param){var k=this.path.length-1,h=this.param.conversions[0],h="// type: "+(h?h.from+" (convert to "+h.to+")":this.param);if(this.param.varArgs){if(this.param.anyType)f.push(c+"if (arguments.length > "+
k+") {"),f.push(c+"  var varArgs = [];"),f.push(c+"  for (var i = "+k+"; i < arguments.length; i++) {"),f.push(c+"    varArgs.push(arguments[i]);");else{var l=function(c,e){for(var f=[],k=0;k<c.length;k++)f[k]=a.add(b(c[k]),"test")+"("+e+")";return f.join(" || ")}.bind(this);e=this.param.types;for(var s=[],x=0;x<e.length;x++)void 0===this.param.conversions[x]&&s.push(e[x]);f.push(c+"if ("+l(e,"arg"+k)+") { "+h);f.push(c+"  var varArgs = [arg"+k+"];");f.push(c+"  for (var i = "+(k+1)+"; i < arguments.length; i++) {");
f.push(c+"    if ("+l(s,"arguments[i]")+") {");f.push(c+"      varArgs.push(arguments[i]);");for(x=0;x<e.length;x++)if(k=this.param.conversions[x])l=a.add(b(e[x]),"test"),k=a.add(k.convert,"convert"),f.push(c+"    }"),f.push(c+"    else if ("+l+"(arguments[i])) {"),f.push(c+"      varArgs.push("+k+"(arguments[i]));");f.push(c+"    } else {");f.push(c+"      throw createError(name, arguments.length, i, arguments[i], '"+s.join(",")+"');");f.push(c+"    }")}f.push(c+"  }");f.push(this.signature.toCode(a,
c+"  "));f.push(c+"}")}else this.param.anyType?(f.push(c+"// type: any"),f.push(this._innerCode(a,c,e))):(s=this.param.types[0],l="any"!==s?a.add(b(s),"test"):null,f.push(c+"if ("+l+"(arg"+k+")) { "+h),f.push(this._innerCode(a,c+"  ",e)),f.push(c+"}"))}else f.push(this._innerCode(a,c,e));return f.join("\n")};x.prototype._innerCode=function(a,c,b){var d=[],e;this.signature&&(d.push(c+"if (arguments.length === "+this.path.length+") {"),d.push(this.signature.toCode(a,c+"  ")),d.push(c+"}"));var f;for(e=
0;e<this.childs.length;e++)if(this.childs[e].param.anyType){f=this.childs[e];break}for(e=0;e<this.childs.length;e++)d.push(this.childs[e].toCode(a,c,f));b&&!this.param.anyType&&d.push(b.toCode(a,c,f));(a=this._exceptions(a,c))&&d.push(a);return d.join("\n")};x.prototype._exceptions=function(a,c){var b=this.path.length;if(0===this.childs.length)return[c+"if (arguments.length > "+b+") {",c+"  throw createError(name, arguments.length, "+b+", arguments["+b+"]);",c+"}"].join("\n");for(var d={},e=[],f=
0;f<this.childs.length;f++){var k=this.childs[f];if(k.param)for(var h=0;h<k.param.types.length;h++){var l=k.param.types[h];l in d||k.param.conversions[h]||(d[l]=!0,e.push(l))}}return c+"throw createError(name, arguments.length, "+b+", arguments["+b+"], '"+e.join(",")+"');"};var r=[{name:"number",test:function(a){return"number"===typeof a}},{name:"string",test:function(a){return"string"===typeof a}},{name:"boolean",test:function(a){return"boolean"===typeof a}},{name:"Function",test:function(a){return"function"===
typeof a}},{name:"Array",test:Array.isArray},{name:"Date",test:function(a){return a instanceof Date}},{name:"RegExp",test:function(a){return a instanceof RegExp}},{name:"Object",test:function(a){return"object"===typeof a}},{name:"null",test:function(a){return null===a}},{name:"undefined",test:function(a){return void 0===a}}],n={},Q=[],g=[],q={config:n,types:r,conversions:Q,ignore:g},q=u("typed",{Object:function(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);c=e(c);return u(c,a)},"string, Object":u,
"...Function":function(a){for(var c=e(a),b={},d=0;d<a.length;d++){var f=a[d];if("object"!==typeof f.signatures)throw a=new TypeError("Function is no typed-function (index: "+d+")"),a.data={index:d},a;for(var k in f.signatures)if(f.signatures.hasOwnProperty(k))if(b.hasOwnProperty(k)){if(f.signatures[k]!==b[k])throw a=Error('Signature "'+k+'" is defined twice'),a.data={signature:k},a;}else b[k]=f.signatures[k]}return u(c,b)}});q.config=n;q.types=r;q.conversions=Q;q.ignore=g;q.create=a;q.find=function(a,
c){if(!a.signatures)throw new TypeError("Function is no typed-function");var b;if("string"===typeof c){b=c.split(",");for(var d=0;d<b.length;d++)b[d]=b[d].trim()}else if(Array.isArray(c))b=c;else throw new TypeError("String array or a comma separated string expected");d=b.join(",");if(d=a.signatures[d])return d;throw new TypeError("Signature not found (signature: "+(a.name||"unnamed")+"("+b.join(", ")+"))");};q.convert=function(a,c){var b=l(a);if(c===b)return a;for(var d=0;d<q.conversions.length;d++){var e=
q.conversions[d];if(e.from===b&&e.to===c)return e.convert(a)}throw Error("Cannot convert from "+b+" to "+c);};q.addType=function(a){if(!a||"string"!==typeof a.name||"function"!==typeof a.test)throw new TypeError("Object with properties {name: string, test: function} expected");q.types.push(a)};q.addConversion=function(a){if(!a||"string"!==typeof a.from||"string"!==typeof a.to||"function"!==typeof a.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");
q.conversions.push(a)};return q}return a()})},function(t,m,g){var v=g(7);m.isNumber=function(b){return"number"===typeof b};m.isInteger=function(b){return isFinite(b)?b==Math.round(b):!1};m.sign=Math.sign||function(b){return 0<b?1:0>b?-1:0};m.format=function(b,a){if("function"===typeof a)return a(b);if(Infinity===b)return"Infinity";if(-Infinity===b)return"-Infinity";if(isNaN(b))return"NaN";var c="auto",d=void 0;a&&(a.notation&&(c=a.notation),m.isNumber(a)?d=a:a.precision&&(d=a.precision));switch(c){case "fixed":return m.toFixed(b,
d);case "exponential":return m.toExponential(b,d);case "engineering":return m.toEngineering(b,d);case "auto":return m.toPrecision(b,d,a&&a.exponential).replace(/((\.\d*?)(0+))($|e)/,function(a,c,b,d,s){return"."!==b?b+s:s});default:throw Error('Unknown notation "'+c+'". Choose "auto", "exponential", or "fixed".');}};m.toExponential=function(b,a){return(new v(b)).toExponential(a)};m.toEngineering=function(b,a){return(new v(b)).toEngineering(a)};m.toFixed=function(b,a){return(new v(b)).toFixed(a)};
m.toPrecision=function(b,a,c){return(new v(b)).toPrecision(a,c)};m.digits=function(b){return b.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length};m.DBL_EPSILON=Number.EPSILON||2.220446049250313E-16;m.nearlyEqual=function(b,a,c){if(null==c)return b==a;if(b==a)return!0;if(isNaN(b)||isNaN(a))return!1;if(isFinite(b)&&isFinite(a)){var d=Math.abs(b-a);return d<m.DBL_EPSILON?!0:d<=Math.max(Math.abs(b),Math.abs(a))*c}return!1}},function(t,m){function g(b){var a=String(b).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);
if(!a)throw new SyntaxError("Invalid number");b=a[1];var c=a[2],d=parseFloat(a[4]||"0"),a=c.indexOf("."),d=d+(-1!==a?a-1:c.length-1);this.sign=b;this.coefficients=c.replace(".","").replace(/^0*/,function(a){d-=a.length;return""}).replace(/0*$/,"").split("").map(function(a){return parseInt(a)});0===this.coefficients.length&&(this.coefficients.push(0),d++);this.exponent=d}function v(b){for(var a=[],c=0;c<b;c++)a.push(0);return a}g.prototype.toEngineering=function(b){b=this.roundDigits(b);var a=b.exponent,
c=b.coefficients,d=0===a%3?a:0>a?a-3-a%3:a-a%3,e=0<=a?a:Math.abs(d);c.length-1<e&&(c=c.concat(v(e-(c.length-1))));for(var f=Math.abs(a-d),e=1,h="";0<=--f;)e++;f=c.slice(e).join("");f=f.match(/[1-9]/)?"."+f:"";h=c.slice(0,e).join("")+f;h+="e"+(0<=a?"+":"")+d.toString();return b.sign+h};g.prototype.toFixed=function(b){var a=this.roundDigits(this.exponent+1+(b||0)),c=a.coefficients,a=a.exponent+1,d=a+(b||0);c.length<d&&(c=c.concat(v(d-c.length)));0>a&&(c=v(-a+1).concat(c),a=1);b&&c.splice(a,0,0===a?
"0.":".");return this.sign+c.join("")};g.prototype.toExponential=function(b){var a=b?this.roundDigits(b):this.clone(),c=a.coefficients,a=a.exponent;c.length<b&&(c=c.concat(v(b-c.length)));b=c.shift();return this.sign+b+(0<c.length?"."+c.join(""):"")+"e"+(0<=a?"+":"")+a};g.prototype.toPrecision=function(b,a){var c=a&&void 0!==a.lower?a.lower:.001,d=a&&void 0!==a.upper?a.upper:1E5,e=Math.abs(Math.pow(10,this.exponent));if(e<c||e>=d)return this.toExponential(b);d=b?this.roundDigits(b):this.clone();c=
d.coefficients;d=d.exponent;c.length<b&&(c=c.concat(v(b-c.length)));c=c.concat(v(d-c.length+1+(c.length<b?b-c.length:0)));c=v(-d).concat(c);d=0<d?d:0;d<c.length-1&&c.splice(d+1,0,".");return this.sign+c.join("")};g.prototype.clone=function(){var b=new g("0");b.sign=this.sign;b.coefficients=this.coefficients.slice(0);b.exponent=this.exponent;return b};g.prototype.roundDigits=function(b){for(var a=this.clone(),c=a.coefficients;0>=b;)c.unshift(0),a.exponent++,b++;if(c.length>b&&5<=c.splice(b,c.length-
b)[0])for(b-=1,c[b]++;10===c[b];)c.pop(),0===b&&(c.unshift(0),a.exponent++,b++),b--,c[b]++;return a};t.exports=g},function(t,m,g){var v=g(9);m.mixin=function(b){var a=new v;b.on=a.on.bind(a);b.off=a.off.bind(a);b.once=a.once.bind(a);b.emit=a.emit.bind(a);return b}},function(t,m){function g(){}g.prototype={on:function(g,b,a){var c=this.e||(this.e={});(c[g]||(c[g]=[])).push({fn:b,ctx:a});return this},once:function(g,b,a){function c(){d.off(g,c);b.apply(a,arguments)}var d=this;c._=b;return this.on(g,
c,a)},emit:function(g){var b=[].slice.call(arguments,1),a=((this.e||(this.e={}))[g]||[]).slice(),c=0,d=a.length;for(c;c<d;c++)a[c].fn.apply(a[c].ctx,b);return this},off:function(g,b){var a=this.e||(this.e={}),c=a[g],d=[];if(c&&b)for(var e=0,f=c.length;e<f;e++)c[e].fn!==b&&c[e].fn._!==b&&d.push(c[e]);d.length?a[g]=d:delete a[g];return this}};t.exports=g},function(t,m,g){var v=g(3).lazy,b=g(3).isFactory,a=g(3).traverse;g(3);var c=g(11);m.math=!0;m.name="import";m.factory=function(d,e,f,h,k){function s(a,
d){var e=arguments.length;if(1!=e&&2!=e)throw new c("import",e,1,2);d||(d={});if(b(a))u(a,d);else if(Array.isArray(a))a.forEach(function(a){s(a,d)});else if("object"===typeof a)for(var f in a)a.hasOwnProperty(f)&&(e=a[f],"function"==typeof e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||null===e||e&&!0===e.isUnit||e&&!0===e.isComplex||e&&!0===e.isBigNumber||e&&!0===e.isFraction||e&&!0===e.isMatrix||e&&!0===Array.isArray(e)?x(f,e,d):b(a)?u(a,d):s(e,d));else if(!d.silent)throw new TypeError("Factory, Object, or Array expected");
}function x(a,c,b){b.wrap&&"function"===typeof c&&(c=p(c));if(l(k[a])&&l(c))c=b.override?h(a,c.signatures):h(k[a],c),k[a]=c,y(a,c),k.emit("import",a,function(){return c});else if(void 0===k[a]||b.override)k[a]=c,y(a,c),k.emit("import",a,function(){return c});else if(!b.silent)throw Error('Cannot import "'+a+'": already exists');}function y(a,c){c&&"function"===typeof c.transform&&(k.expression.transform[a]=c.transform)}function p(a){var c=function(){for(var c=[],b=0,d=arguments.length;b<d;b++){var e=
arguments[b];c[b]=e&&e.valueOf()}return a.apply(k,c)};a.transform&&(c.transform=a.transform);return c}function u(c,b){if("string"===typeof c.name){var d=c.name,e=c.path?a(k,c.path):k,s=e.hasOwnProperty(d)?e[d]:void 0,x=function(){var a=f(c);if(l(s)&&l(a))return b.override||(a=h(s,a)),a;if(void 0===s||b.override)return a;if(!b.silent)throw Error('Cannot import "'+d+'": already exists');};!1!==c.lazy?v(e,d,x):e[d]=x();k.emit("import",d,x,c.path)}else f(c)}function l(a){return"function"===typeof a&&
"object"===typeof a.signatures}return s};m.lazy=!0},function(t,m){function g(m,b,a,c){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");this.fn=m;this.count=b;this.min=a;this.max=c;this.message="Wrong number of arguments in function "+m+" ("+b+" provided, "+a+(void 0!=c?"-"+c:"")+" expected)";this.stack=Error().stack}g.prototype=Error();g.prototype.constructor=Error;g.prototype.name="ArgumentsError";g.prototype.isArgumentsError=!0;t.exports=g},function(t,
m,g){function v(a,b){return a.map(function(a){return a.toLowerCase()}).indexOf(b.toLowerCase())}function b(a,b,e){if(void 0!==a[b]&&-1===e.indexOf(a[b])){var f=v(e,a[b]);-1!==f?(console.warn('Warning: Wrong casing for configuration option "'+b+'", should be "'+e[f]+'" instead of "'+a[b]+'".'),a[b]=e[f]):console.warn('Warning: Unknown value "'+a[b]+'" for configuration option "'+b+'". Available options: '+e.map(JSON.stringify).join(", ")+".")}}var a=g(3);m.name="config";m.math=!0;m.factory=function(c,
d,e,f,h){function k(c){if(c){var e=a.clone(d);b(c,"matrix",s);b(c,"number",x);a.deepExtend(d,c);c=a.clone(d);h.emit("config",c,e);return c}return a.clone(d)}var s=["Matrix","Array"],x=["number","BigNumber","Fraction"];k.MATRIX=s;k.NUMBER=x;return k}},function(t,m,g){var v=g(14).string.isString;m.name="Matrix";m.path="type";m.factory=function(b,a,c,d){function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");}e.prototype.type="Matrix";e.prototype.isMatrix=
!0;e.storage=function(a){if(!v(a))throw new TypeError("format must be a string value");var c=e._storage[a];if(!c)throw new SyntaxError("Unsupported matrix storage format: "+a);return c};e._storage={};e.prototype.storage=function(){throw Error("Cannot invoke storage on a Matrix interface");};e.prototype.datatype=function(){throw Error("Cannot invoke datatype on a Matrix interface");};e.prototype.create=function(a,c){throw Error("Cannot invoke create on a Matrix interface");};e.prototype.subset=function(a,
c,b){throw Error("Cannot invoke subset on a Matrix interface");};e.prototype.get=function(a){throw Error("Cannot invoke get on a Matrix interface");};e.prototype.set=function(a,c,b){throw Error("Cannot invoke set on a Matrix interface");};e.prototype.resize=function(a,c){throw Error("Cannot invoke resize on a Matrix interface");};e.prototype.clone=function(){throw Error("Cannot invoke clone on a Matrix interface");};e.prototype.size=function(){throw Error("Cannot invoke size on a Matrix interface");
};e.prototype.map=function(a,c){throw Error("Cannot invoke map on a Matrix interface");};e.prototype.forEach=function(a){throw Error("Cannot invoke forEach on a Matrix interface");};e.prototype.toArray=function(){throw Error("Cannot invoke toArray on a Matrix interface");};e.prototype.valueOf=function(){throw Error("Cannot invoke valueOf on a Matrix interface");};e.prototype.format=function(a){throw Error("Cannot invoke format on a Matrix interface");};e.prototype.toString=function(){throw Error("Cannot invoke toString on a Matrix interface");
};return e}},function(t,m,g){m.array=g(15);m["boolean"]=g(21);m["function"]=g(22);m.number=g(6);m.object=g(3);m.string=g(16);m.types=g(18);m.emitter=g(8)},function(t,m,g){function v(a,c,b){var d=a.length;if(d!=c[b])throw new f(d,c[b]);if(b<c.length-1){var e=b+1;for(b=0;b<d;b++){if(!Array.isArray(a[b]))throw new f(c.length-1,c.length,"<");v(a[b],c,e)}}else for(b=0;b<d;b++)if(Array.isArray(a[b]))throw new f(c.length+1,c.length,">");}function b(a,c,d,e){var f,h=c[d],l=Math.min(a.length,h);a.length=h;
if(d<c.length-1){var r=d+1;for(d=0;d<l;d++)f=a[d],Array.isArray(f)||(f=[f],a[d]=f),b(f,c,r,e);for(d=l;d<h;d++)f=[],a[d]=f,b(f,c,r,e)}else{for(d=0;d<l;d++)for(;Array.isArray(a[d]);)a[d]=a[d][0];if(e!==m.UNINITIALIZED)for(d=l;d<h;d++)a[d]=e}}function a(c,b,d){var e;if(d<b){var f=d+1;d=0;for(e=c.length;d<e;d++)c[d]=a(c[d],b,f)}else for(;Array.isArray(c);)c=c[0];return c}function c(a,b,d){var e;if(Array.isArray(a)){var f=d+1;d=0;for(e=a.length;d<e;d++)a[d]=c(a[d],b,f)}else for(;d<b;d++)a=[a];return a}
var d=g(6),e=g(16);g(3);g(18);var f=g(19),h=g(20);m.size=function(a){for(var c=[];Array.isArray(a);)c.push(a.length),a=a[0];return c};m.validate=function(a,c){if(0==c.length){if(Array.isArray(a))throw new f(a.length,0);}else v(a,c,0)};m.validateIndex=function(a,c){if(!d.isNumber(a)||!d.isInteger(a))throw new TypeError("Index must be an integer (value: "+a+")");if(0>a||"number"===typeof c&&a>=c)throw new h(a,c);};m.UNINITIALIZED={};m.resize=function(a,c,f){if(!Array.isArray(a)||!Array.isArray(c))throw new TypeError("Array expected");
if(0===c.length)throw Error("Resizing to scalar is not supported");c.forEach(function(a){if(!d.isNumber(a)||!d.isInteger(a)||0>a)throw new TypeError("Invalid size, must contain positive integers (size: "+e.format(c)+")");});b(a,c,0,void 0!==f?f:0);return a};m.squeeze=function(c,b){for(var d=b||m.size(c);Array.isArray(c)&&1===c.length;)c=c[0],d.shift();for(var e=d.length;1===d[e-1];)e--;e<d.length&&(c=a(c,e,0),d.length=e);return c};m.unsqueeze=function(a,b,d,e){e=e||m.size(a);if(d)for(var f=0;f<d;f++)a=
[a],e.unshift(1);for(a=c(a,b,0);e.length<b;)e.push(1);return a};m.flatten=function(a){if(!Array.isArray(a))return a;var c=[];a.forEach(function y(a){Array.isArray(a)?a.forEach(y):c.push(a)});return c};m.isArray=Array.isArray},function(t,m,g){function v(a,b){if(Array.isArray(a)){for(var e="[",f=a.length,h=0;h<f;h++)0!=h&&(e+=", "),e+=v(a[h],b);return e+"]"}return m.format(a,b)}var b=g(6).format,a=g(17).format;m.isString=function(a){return"string"===typeof a};m.endsWith=function(a,b){return a.substring(a.length-
b.length,a.length)===b};m.format=function(c,d){if("number"===typeof c)return b(c,d);if(c&&!0===c.isBigNumber)return a(c,d);if(c&&!0===c.isFraction)return d&&"decimal"===d.fraction?c.toString():c.s*c.n+"/"+c.d;if(Array.isArray(c))return v(c,d);if(m.isString(c))return'"'+c+'"';if("function"===typeof c)return c.syntax?String(c.syntax):"function";if(c&&"object"===typeof c){if("function"===typeof c.format)return c.format(d);if(c&&c.toString()!=={}.toString())return c.toString();var e=[],f;for(f in c)c.hasOwnProperty(f)&&
e.push('"'+f+'": '+m.format(c[f],d));return"{"+e.join(", ")+"}"}return String(c)}},function(t,m){m.format=function(g,v){if("function"===typeof v)return v(g);if(!g.isFinite())return g.isNaN()?"NaN":g.gt(0)?"Infinity":"-Infinity";var b="auto",a=void 0;void 0!==v&&(v.notation&&(b=v.notation),"number"===typeof v?a=v:v.precision&&(a=v.precision));switch(b){case "fixed":return m.toFixed(g,a);case "exponential":return m.toExponential(g,a);case "auto":var b=.001,c=1E5;v&&v.exponential&&(void 0!==v.exponential.lower&&
(b=v.exponential.lower),void 0!==v.exponential.upper&&(c=v.exponential.upper));g.constructor.config({toExpNeg:Math.round(Math.log(b)/Math.LN10),toExpPos:Math.round(Math.log(c)/Math.LN10)});if(g.isZero())return"0";var d=g.abs();return(d.gte(b)&&d.lt(c)?g.toSignificantDigits(a).toFixed():m.toExponential(g,a)).replace(/((\.\d*?)(0+))($|e)/,function(a,c,b,d,s){return"."!==b?b+s:s});default:throw Error('Unknown notation "'+b+'". Choose "auto", "exponential", or "fixed".');}};m.toExponential=function(g,
m){return void 0!==m?g.toExponential(m-1):g.toExponential()};m.toFixed=function(g,m){return g.toFixed(m||0)}},function(t,m){m.type=function(g){var m=typeof g;return"object"===m?null===g?"null":g instanceof Boolean?"boolean":g instanceof Number?"number":g instanceof String?"string":Array.isArray(g)?"Array":g instanceof Date?"Date":g instanceof RegExp?"RegExp":"Object":"function"===m?"Function":m};m.isScalar=function(g){return!(g&&g.isMatrix||Array.isArray(g))}},function(t,m){function g(m,b,a){if(!(this instanceof
g))throw new SyntaxError("Constructor must be called with the new operator");this.actual=m;this.expected=b;this.relation=a;this.message="Dimension mismatch ("+(Array.isArray(m)?"["+m.join(", ")+"]":m)+" "+(this.relation||"!=")+" "+(Array.isArray(b)?"["+b.join(", ")+"]":b)+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="DimensionError";g.prototype.isDimensionError=!0;t.exports=g},function(t,m){function g(m,b,a){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");
this.index=m;3>arguments.length?(this.min=0,this.max=b):(this.min=b,this.max=a);this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")";this.stack=Error().stack}g.prototype=new RangeError;g.prototype.constructor=RangeError;g.prototype.name="IndexError";g.prototype.isIndexError=!0;t.exports=g},function(t,m){m.isBoolean=
function(g){return"boolean"==typeof g}},function(t,m){m.memoize=function(g,m){return function a(){"object"!==typeof a.cache&&(a.cache={});for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];d=m?m(c):JSON.stringify(c);return d in a.cache?a.cache[d]:a.cache[d]=g.apply(g,c)}}},function(t,m,g){var v=g(14),b=g(19),a=v.string,c=v.array,d=v.object;t=v.number;var e=Array.isArray,f=t.isNumber,h=t.isInteger,k=a.isString,s=c.validateIndex;m.name="DenseMatrix";m.path="type";m.factory=function(x,y,p,u){function l(a,
b){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");if(b&&!k(b))throw Error("Invalid datatype: "+b);if(a&&!0===a.isMatrix)"DenseMatrix"===a.type?(this._data=d.clone(a._data),this._size=d.clone(a._size)):(this._data=a.toArray(),this._size=a.size()),this._datatype=b||a._datatype;else if(a&&e(a.data)&&e(a.size))this._data=a.data,this._size=a.size,this._datatype=b||a.datatype;else{if(e(a))this._data=q(a),this._size=c.size(this._data),c.validate(this._data,
this._size);else{if(a)throw new TypeError("Unsupported type of data ("+v.types.type(a)+")");this._data=[];this._size=[0]}this._datatype=b}}function r(a,c,b,d){var e=d==b-1,f=c.dimension(d);return e?f.map(function(c){return a[c]}).valueOf():f.map(function(e){return r(a[e],c,b,d+1)}).valueOf()}function n(a,e,f,k){if(!e||!0!==e.isIndex)throw new TypeError("Invalid index");var h=e.size(),l=e.isScalar(),s;f&&!0===f.isMatrix?(s=f.size(),f=f.valueOf()):s=c.size(f);if(l){if(0!==s.length)throw new TypeError("Scalar expected");
a.set(e.min(),f,k)}else{if(h.length<a._size.length)throw new b(h.length,a._size.length,"<");if(s.length<h.length){for(var x=l=0;1===h[l]&&1===s[l];)l++;for(;1===h[l];)x++,l++;f=c.unsqueeze(f,h.length,x,s)}if(!d.deepEqual(h,s))throw new b(h,s,">");s=e.max().map(function(a){return a+1});m(a,s,k);Q(a._data,e,f,h.length,0)}return a}function Q(a,c,b,d,e){var f=e==d-1,k=c.dimension(e);f?k.forEach(function(c,d){s(c);a[c]=b[d[0]]}):k.forEach(function(f,k){s(f);Q(a[f],c,b[k[0]],d,e+1)})}function m(a,c,b){for(var d=
a._size.slice(0),e=!1;d.length<c.length;)d.push(0),e=!0;for(var f=0,k=c.length;f<k;f++)c[f]>d[f]&&(d[f]=c[f],e=!0);e&&z(a,d,b)}function q(a){for(var c=0,b=a.length;c<b;c++){var d=a[c];e(d)?a[c]=q(d):d&&!0===d.isMatrix&&(a[c]=q(d.valueOf()))}return a}y=p(g(13));l.prototype=new y;l.prototype.type="DenseMatrix";l.prototype.isDenseMatrix=!0;l.prototype.storage=function(){return"dense"};l.prototype.datatype=function(){return this._datatype};l.prototype.create=function(a,c){return new l(a,c)};l.prototype.subset=
function(a,c,d){switch(arguments.length){case 1:var e;if(!a||!0!==a.isIndex)throw new TypeError("Invalid index");if(a.isScalar())e=this.get(a.min());else{e=a.size();if(e.length!=this._size.length)throw new b(e.length,this._size.length);for(var f=a.min(),k=a.max(),h=0,x=this._size.length;h<x;h++)s(f[h],this._size[h]),s(k[h],this._size[h]);e=new l(r(this._data,a,e.length,0),this._datatype)}return e;case 2:case 3:return n(this,a,c,d);default:throw new SyntaxError("Wrong number of arguments");}};l.prototype.get=
function(a){if(!e(a))throw new TypeError("Array expected");if(a.length!=this._size.length)throw new b(a.length,this._size.length);for(var c=0;c<a.length;c++)s(a[c],this._size[c]);for(var c=this._data,d=0,f=a.length;d<f;d++){var k=a[d];s(k,c.length);c=c[k]}return c};l.prototype.set=function(a,c,d){if(!e(a))throw new TypeError("Array expected");if(a.length<this._size.length)throw new b(a.length,this._size.length,"<");var f,k;f=a.map(function(a){return a+1});m(this,f,d);var h=this._data;d=0;for(f=a.length-
1;d<f;d++)k=a[d],s(k,h.length),h=h[k];k=a[a.length-1];s(k,h.length);h[k]=c;return this};l.prototype.resize=function(a,c,b){if(!e(a))throw new TypeError("Array expected");b=b?this.clone():this;return z(b,a,c)};var z=function(a,b,d){if(0===b.length){for(a=a._data;e(a);)a=a[0];return a}a._size=b.slice(0);a._data=c.resize(a._data,a._size,d);return a};l.prototype.clone=function(){return new l({data:d.clone(this._data),size:d.clone(this._size),datatype:this._datatype})};l.prototype.size=function(){return this._size.slice(0)};
l.prototype.map=function(a){var c=this,b=function(d,f){return e(d)?d.map(function(a,c){return b(a,f.concat(c))}):a(d,f,c)};return new l({data:b(this._data,[]),size:d.clone(this._size),datatype:this._datatype})};l.prototype.forEach=function(a){var c=this,b=function(d,f){e(d)?d.forEach(function(a,c){b(a,f.concat(c))}):a(d,f,c)};b(this._data,[])};l.prototype.toArray=function(){return d.clone(this._data)};l.prototype.valueOf=function(){return this._data};l.prototype.format=function(c){return a.format(this._data,
c)};l.prototype.toString=function(){return a.format(this._data)};l.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}};l.prototype.diagonal=function(a){if(a){if(!0===a.isBigNumber&&(a=a.toNumber()),!f(a)||!h(a))throw new TypeError("The parameter k must be an integer number");}else a=0;var c=0<a?a:0;a=0>a?-a:0;for(var b=Math.min(this._size[0]-a,this._size[1]-c),d=[],e=0;e<b;e++)d[e]=this._data[e+a][e+c];return new l({data:d,size:[b],datatype:this._datatype})};
l.diagonal=function(a,b,d,s,n){if(!e(a))throw new TypeError("Array expected, size parameter");if(2!==a.length)throw Error("Only two dimensions matrix are supported");a=a.map(function(a){a&&!0===a.isBigNumber&&(a=a.toNumber());if(!f(a)||!h(a)||1>a)throw Error("Size values must be positive integers");return a});if(d){if(d&&!0===d.isBigNumber&&(d=d.toNumber()),!f(d)||!h(d))throw new TypeError("The parameter k must be an integer number");}else d=0;s&&k(n)&&(s=u.convert(s,n));n=0<d?d:0;d=0>d?-d:0;var y=
a[0],r=a[1],p=Math.min(y-d,r-n),q;if(e(b)){if(b.length!==p)throw Error("Invalid value array length");q=function(a){return b[a]}}else if(b&&!0===b.isMatrix){q=b.size();if(1!==q.length||q[0]!==p)throw Error("Invalid matrix length");q=function(a){return b.get([a])}}else q=function(){return b};s||(s=q(0)&&!0===q(0).isBigNumber?new x.BigNumber(0):0);var g=[];if(0<a.length)for(g=c.resize(g,a,s),a=0;a<p;a++)g[a+d][a+n]=q(a);return new l({data:g,size:[y,r]})};l.fromJSON=function(a){return new l(a)};l.prototype.swapRows=
function(a,c){if(!(f(a)&&h(a)&&f(c)&&h(c)))throw Error("Row index must be positive integers");if(2!==this._size.length)throw Error("Only two dimensional matrix is supported");s(a,this._size[0]);s(c,this._size[0]);l._swapRows(a,c,this._data);return this};l._swapRows=function(a,c,b){var d=b[a];b[a]=b[c];b[c]=d};x.Matrix._storage.dense=l;return x.Matrix._storage["default"]=l};m.lazy=!1},function(t,m,g){var v=g(25);m.name="sin";m.factory=function(b,a,c,d){var e=d("sin",{number:Math.sin,Complex:function(a){return a.sin()},
BigNumber:function(a){return a.sin()},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function sin is no angle");return e(a.value)},"Array | Matrix":function(a){return v(a,e,!0)}});e.toTex={1:"\\sin\\left(${args[0]}\\right)"};return e}},function(t,m){t.exports=function v(b,a,c){return b&&"function"===typeof b.map?b.map(function(b){return v(b,a,c)}):a(b)}},function(t,m,g){var v=g(25);m.name="cos";m.factory=function(b,a,c,d){var e=d("cos",{number:Math.cos,Complex:function(a){return a.cos()},
BigNumber:function(a){return a.cos()},Unit:function(a){if(!a.hasBase(b.Unit.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cos is no angle");return e(a.value)},"Array | Matrix":function(a){return v(a,e)}});e.toTex={1:"\\cos\\left(${args[0]}\\right)"};return e}},function(t,m,g){var v=g(25);m.name="sqrt";m.factory=function(b,a,c,d){function e(c){return 0<=c||a.predictable?Math.sqrt(c):(new b.Complex(c,0)).sqrt()}var f=d("sqrt",{number:e,Complex:function(a){return a.sqrt()},BigNumber:function(c){return!c.isNegative()||
a.predictable?c.sqrt():e(c.toNumber())},"Array | Matrix":function(a){return v(a,f,!0)},Unit:function(a){return a.pow(.5)}});f.toTex={1:"\\sqrt{${args[0]}}"};return f}},function(t,m,g){m.name="norm";m.factory=function(m,b,a,c){function d(a,c){var b=a.size();if(1==b.length){if(c===Number.POSITIVE_INFINITY||"inf"===c){var n=0;a.forEach(function(a){a=e(a);y(a,n)&&(n=a)},!0);return n}if(c===Number.NEGATIVE_INFINITY||"-inf"===c){var u;a.forEach(function(a){a=e(a);if(!u||p(a,u))u=a},!0);return u||0}if("fro"===
c)return d(a,2);if("number"===typeof c&&!isNaN(c)){if(!x(c,0)){var g=0;a.forEach(function(a){g=f(h(e(a),c),g)},!0);return h(g,1/c)}return Number.POSITIVE_INFINITY}throw Error("Unsupported parameter value");}if(2==b.length){if(1===c){var m=[],F=0;a.forEach(function(a,c){var b=c[1],d=f(m[b]||0,e(a));y(d,F)&&(F=d);m[b]=d},!0);return F}if(c===Number.POSITIVE_INFINITY||"inf"===c){var v=[],E=0;a.forEach(function(a,c){var b=c[0],d=f(v[b]||0,e(a));y(d,E)&&(E=d);v[b]=d},!0);return E}if("fro"===c)return k(l(s(r(a),
a)));if(2===c)throw Error("Unsupported parameter value, missing implementation of matrix singular value decomposition");throw Error("Unsupported parameter value");}}var e=a(g(29)),f=a(g(30)),h=a(g(41)),k=a(g(27)),s=a(g(43)),x=a(g(36)),y=a(g(48)),p=a(g(52)),u=a(g(31)),l=a(g(53)),r=a(g(54)),n=c("norm",{number:Math.abs,Complex:function(a){return a.abs()},BigNumber:function(a){return a.abs()},"boolean | null":function(a){return Math.abs(a)},Array:function(a){return d(u(a),2)},Matrix:function(a){return d(a,
2)},"number | Complex | BigNumber | boolean | null, number | BigNumber | string":function(a){return n(a)},"Array, number | BigNumber | string":function(a,c){return d(u(a),c)},"Matrix, number | BigNumber | string":function(a,c){return d(a,c)}});n.toTex={1:"\\left\\|${args[0]}\\right\\|",2:void 0};return n}},function(t,m,g){var v=g(25);m.name="abs";m.factory=function(b,a,c,d){var e=d("abs",{number:Math.abs,Complex:function(a){return a.abs()},BigNumber:function(a){return a.abs()},Fraction:function(a){return a.abs()},
"Array | Matrix":function(a){return v(a,e,!0)},Unit:function(a){return a.abs()}});e.toTex={1:"\\left|${args[0]}\\right|"};return e}},function(t,m,g){var v=g(3).extend;m.name="add";m.factory=function(b,a,c,d){var e=c(g(31)),f=c(g(32));b=g(33);var h=c(g(34)),k=c(g(35)),s=c(g(38)),x=c(g(39)),y=c(g(40)),p=d("add",v({"Matrix, Matrix":function(a,c){var b;switch(a.storage()){case "sparse":switch(c.storage()){case "sparse":b=k(a,c,f);break;default:b=h(c,a,f,!0)}break;default:switch(c.storage()){case "sparse":b=
h(a,c,f,!1);break;default:b=x(a,c,f)}}return b},"Array, Array":function(a,c){return p(e(a),e(c)).valueOf()},"Array, Matrix":function(a,c){return p(e(a),c)},"Matrix, Array":function(a,c){return p(a,e(c))},"Matrix, any":function(a,c){var b;switch(a.storage()){case "sparse":b=s(a,c,f,!1);break;default:b=y(a,c,f,!1)}return b},"any, Matrix":function(a,c){var b;switch(c.storage()){case "sparse":b=s(c,a,f,!0);break;default:b=y(c,a,f,!0)}return b},"Array, any":function(a,c){return y(e(a),c,f,!1).valueOf()},
"any, Array":function(a,c){return y(e(c),a,f,!0).valueOf()}},f.signatures));p.toTex={2:"\\left(${args[0]}"+b.operators.add+"${args[1]}\\right)"};return p}},function(t,m){m.name="matrix";m.factory=function(g,m,b,a){function c(a,c,b){return new (g.Matrix.storage(c||"default"))(a,b)}m=a("matrix",{"":function(){return c([])},string:function(a){return c([],a)},"string, string":function(a,b){return c([],a,b)},Array:function(a){return c(a)},Matrix:function(a){return c(a,a.storage())},"Array | Matrix, string":c,
"Array | Matrix, string, string":c});m.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"};return m}},function(t,m){m.factory=function(g,m,b,a){var c=a("add",{"number, number":function(a,c){return a+c},"Complex, Complex":function(a,c){return a.add(c)},"BigNumber, BigNumber":function(a,c){return a.plus(c)},"Fraction, Fraction":function(a,c){return a.add(c)},"Unit, Unit":function(a,b){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");
if(null==b.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(b))throw Error("Units do not match");var f=a.clone();f.value=c(f.value,b.value);f.fixPrefix=!1;return f}});return c}},function(t,m){m.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",
Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega","true":"\\mathrm{True}",
"false":"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"};m.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",
largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"};m.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var g={deg:"^\\circ"};m.toSymbol=function(v,b){if("undefined"===typeof b?0:b)return g.hasOwnProperty(v)?g[v]:"\\mathrm{"+v+"}";if(m.symbols.hasOwnProperty(v))return m.symbols[v];if(-1!==v.indexOf("_")){var a=v.indexOf("_");return m.toSymbol(v.substring(0,a))+"_{"+m.toSymbol(v.substring(a+1))+"}"}return v}},function(t,m,g){var v=g(19);
m.name="algorithm01";m.factory=function(b,a,c,d){var e=b.DenseMatrix;return function(a,c,b,s){var x=a._data,y=a._size,p=a._datatype;a=c._values;var u=c._index,l=c._ptr,r=c._size,n=c._datatype;if(y.length!==r.length)throw new v(y.length,r.length);if(y[0]!==r[0]||y[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+y+") must match Matrix B ("+r+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");c=y[0];y=y[1];b=(p="string"===typeof p&&p===n?p:void 0)?
d.find(b,[p,p]):b;for(var g=[],n=0;n<c;n++)g[n]=[];for(var m=[],q=[],r=0;r<y;r++){for(var z=r+1,K=l[r+1],A=l[r];A<K;A++)n=u[A],m[n]=s?b(a[A],x[n][r]):b(x[n][r],a[A]),q[n]=z;for(n=0;n<c;n++)g[n][r]=q[n]===z?m[n]:x[n][r]}return new e({data:g,size:[c,y],datatype:p})}}},function(t,m,g){var v=g(19);m.name="algorithm04";m.factory=function(b,a,c,d){var e=c(g(36)),f=b.SparseMatrix;return function(a,c,b){var x=a._values,y=a._index,p=a._ptr,u=a._size,l=a._datatype;a=c._values;var r=c._index,n=c._ptr,g=c._size,
m=c._datatype;if(u.length!==g.length)throw new v(u.length,g.length);if(u[0]!==g[0]||u[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+g+")");var q=u[0],u=u[1],z;c=e;var g=0,K=b;"string"===typeof l&&l===m&&(z=l,c=d.find(e,[z,z]),g=d.convert(0,z),K=d.find(b,[z,z]));b=x&&a?[]:void 0;l=[];m=[];z=new f({values:b,index:l,ptr:m,size:[q,u],datatype:z});var q=x&&a?[]:void 0,A=x&&a?[]:void 0,C=[],F=[],H,E,t,M;for(E=0;E<u;E++){m[E]=l.length;var O=E+1;H=p[E];M=p[E+
1];for(t=H;t<M;t++)H=y[t],l.push(H),C[H]=O,q&&(q[H]=x[t]);H=n[E];M=n[E+1];for(t=H;t<M;t++)if(H=r[t],C[H]===O){if(q){var I=K(q[H],a[t]);c(I,g)?C[H]=null:q[H]=I}}else l.push(H),F[H]=O,A&&(A[H]=a[t]);if(q&&A)for(t=m[E];t<l.length;)H=l[t],C[H]===O?(b[t]=q[H],t++):F[H]===O?(b[t]=A[H],t++):l.splice(t,1)}m[u]=l.length;return z}}},function(t,m,g){var v=g(6).nearlyEqual,b=g(37);m.factory=function(a,c,d,e){var f=e("equalScalar",{"boolean, boolean":function(a,c){return a===c},"number, number":function(a,b){return a===
b||v(a,b,c.epsilon)},"BigNumber, BigNumber":function(a,d){return a.eq(d)||b(a,d,c.epsilon)},"Fraction, Fraction":function(a,c){return a.equals(c)},"Complex, Complex":function(a,c){return a.equals(c)},"Unit, Unit":function(a,c){if(!a.equalBase(c))throw Error("Cannot compare units with different base");return f(a.value,c.value)},"string, string":function(a,c){return a===c}});return f}},function(t,m){t.exports=function(g,m,b){if(null==b)return g.eq(m);if(g.eq(m))return!0;if(g.isNaN()||m.isNaN())return!1;
if(g.isFinite()&&m.isFinite()){var a=g.minus(m).abs();if(a.isZero())return!0;g=g.constructor.max(g.abs(),m.abs());return a.lte(g.times(b))}return!1}},function(t,m){m.name="algorithm10";m.factory=function(g,m,b,a){var c=g.DenseMatrix;return function(b,e,f,h){var k=b._values,s=b._index,x=b._ptr,y=b._size,p=b._datatype;if(!k)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");b=y[0];var y=y[1],u,l=f;"string"===typeof p&&(u=p,e=a.convert(e,u),l=a.find(f,[u,u]));f=[];u=new c({data:f,
size:[b,y],datatype:u});for(var p=[],r=[],n=0;n<y;n++){for(var g=n+1,m=x[n+1],q=x[n];q<m;q++){var z=s[q];p[z]=k[q];r[z]=g}for(m=0;m<b;m++)0===n&&(f[m]=[]),f[m][n]=r[m]===g?h?l(e,p[m]):l(p[m],e):e}return u}}},function(t,m,g){g(14);var v=g(19);m.name="algorithm13";m.factory=function(b,a,c,d){var e=b.DenseMatrix,f=function(a,c,b,d,e,p){var u=[];if(c===b.length-1)for(c=0;c<d;c++)u[c]=a(e[c],p[c]);else for(var l=0;l<d;l++)u[l]=f(a,c+1,b,b[c+1],e[l],p[l]);return u};return function(a,c,b){var x=a._data,
y=a._size,p=a._datatype,u=c._data,l=c._size,r=c._datatype;a=[];if(y.length!==l.length)throw new v(y.length,l.length);for(var n=0;n<y.length;n++){if(y[n]!==l[n])throw new RangeError("Dimension mismatch. Matrix A ("+y+") must match Matrix B ("+l+")");a[n]=y[n]}var g,y=b;"string"===typeof p&&p===r&&(g=p,d.convert(c,g),y=d.find(b,[g,g]));c=0<a.length?f(y,0,a,a[0],x,u):[];return new e({data:c,size:a,datatype:g})}}},function(t,m,g){var v=g(3).clone;m.name="algorithm14";m.factory=function(b,a,c,d){var e=
b.DenseMatrix,f=function(a,c,b,d,e,p,u){var l=[];if(c===b.length-1)for(c=0;c<d;c++)l[c]=u?a(p,e[c]):a(e[c],p);else for(var r=0;r<d;r++)l[r]=f(a,c+1,b,b[c+1],e[r],p,u);return l};return function(a,c,b,x){var y=a._data,p=a._size;a=a._datatype;var u,l=b;"string"===typeof a&&(u=a,c=d.convert(c,u),l=d.find(b,[u,u]));c=0<p.length?f(l,0,p,p[0],y,c,x):[];return new e({data:c,size:v(p),datatype:u})}}},function(t,m,g){var v=g(6).isInteger,b=g(15).size;m.name="pow";m.factory=function(a,c,d,e){function f(b,d){if(c.predictable&&
!v(d)&&0>b)try{var e=u(d),f=l(e);if((d===f||1E-14>Math.abs((d-f)/d))&&1===e.d%2)return(0===e.n%2?1:-1)*Math.pow(-b,d)}catch(k){}return v(d)||0<=b||c.predictable?Math.pow(b,d):(new a.Complex(b,0)).pow(d,0)}function h(a,c){if(!v(c)||0>c)throw new TypeError("For A^b, b must be a positive integer (value is "+c+")");var d=b(a);if(2!=d.length)throw Error("For A^b, A must be 2 dimensional (A has "+d.length+" dimensions)");if(d[0]!=d[1])throw Error("For A^b, A must be square (size is "+d[0]+"x"+d[1]+")");
for(var d=x(d[0]).valueOf(),e=a;1<=c;)1==(c&1)&&(d=y(e,d)),c>>=1,e=y(e,e);return d}function k(a,c){return p(h(a.valueOf(),c))}var s=g(33),x=d(g(42)),y=d(g(43)),p=d(g(31)),u=d(g(46)),l=d(g(47));d=e("pow",{"number, number":f,"Complex, Complex":function(a,c){return a.pow(c)},"BigNumber, BigNumber":function(b,d){return d.isInteger()||0<=b||c.predictable?b.pow(d):(new a.Complex(b.toNumber(),0)).pow(d.toNumber(),0)},"Fraction, Fraction":function(a,b){if(1!==b.d){if(c.predictable)throw Error("Function pow does not support non-integer exponents for fractions.");
return f(a.valueOf(),b.valueOf())}return a.pow(b)},"Array, number":h,"Array, BigNumber":function(a,c){return h(a,c.toNumber())},"Matrix, number":k,"Matrix, BigNumber":function(a,c){return k(a,c.toNumber())},"Unit, number":function(a,c){return a.pow(c)}});d.toTex={2:"\\left(${args[0]}\\right)"+s.operators.pow+"{${args[1]}}"};return d}},function(t,m,g){var v=g(15),b=g(6).isInteger;m.name="eye";m.factory=function(a,c,d,e){function f(a,c){switch(a.length){case 0:return c?k(c):[];case 1:return h(a[0],
a[0],c);case 2:return h(a[0],a[1],c);default:throw Error("Vector containing two values expected");}}function h(c,d,e){var f=c&&!0===c.isBigNumber?a.BigNumber:d&&!0===d.isBigNumber?a.BigNumber:null;c&&!0===c.isBigNumber&&(c=c.toNumber());d&&!0===d.isBigNumber&&(d=d.toNumber());if(!b(c)||1>c)throw Error("Parameters in function eye must be positive integers");if(!b(d)||1>d)throw Error("Parameters in function eye must be positive integers");var k=f?new a.BigNumber(1):1,f=f?new f(0):0,h=[c,d];if(e)return a.Matrix.storage(e).diagonal(h,
k,0,f);e=v.resize([],h,f);c=c<d?c:d;for(d=0;d<c;d++)e[d][d]=k;return e}var k=d(g(31));d=e("eye",{"":function(){return"Matrix"===c.matrix?k([]):[]},string:function(a){return k(a)},"number | BigNumber":function(a){return h(a,a,"Matrix"===c.matrix?"default":void 0)},"number | BigNumber, string":function(a,c){return h(a,a,c)},"number | BigNumber, number | BigNumber":function(a,b){return h(a,b,"Matrix"===c.matrix?"default":void 0)},"number | BigNumber, number | BigNumber, string":function(a,c,b){return h(a,
c,b)},Array:function(a){return f(a)},"Array, string":function(a,c){return f(a,c)},Matrix:function(a){return f(a.valueOf(),a.storage())},"Matrix, string":function(a,c){return f(a.valueOf(),c)}});d.toTex=void 0;return d}},function(t,m,g){var v=g(3).extend,b=g(15);m.name="multiply";m.factory=function(a,c,d,e){c=g(33);var f=d(g(31)),h=d(g(32)),k=d(g(44)),s=d(g(36)),x=d(g(45)),y=d(g(40)),p=a.DenseMatrix,u=a.SparseMatrix,l=e("multiply",v({"Array, Array":function(a,c){r(b.size(a),b.size(c));var d=l(f(a),
f(c));return d&&!0===d.isMatrix?d.valueOf():d},"Matrix, Matrix":function(a,c){var b=a.size(),d=c.size();r(b,d);if(1===b.length){if(1===d.length){var f=b[0];if(0===f)throw Error("Cannot multiply two empty vectors");var l=a._data,x=a._datatype,y=c._data,g=c._datatype,b=h,d=k;x&&g&&x===g&&"string"===typeof x&&(b=e.find(h,[x,x]),d=e.find(k,[x,x]));x=d(l[0],y[0]);for(g=1;g<f;g++)x=b(x,d(l[g],y[g]));return x}a:{switch(c.storage()){case "dense":var f=a._data,m=a._datatype,l=c._data,v=c._datatype,b=a._size[0],
d=c._size[1],x=h,g=k;m&&v&&m===v&&"string"===typeof m&&(y=m,x=e.find(h,[y,y]),g=e.find(k,[y,y]));m=[];for(v=0;v<d;v++){for(var t=g(f[0],l[0][v]),O=1;O<b;O++)t=x(t,g(f[O],l[O][v]));m[v]=t}f=new p({data:m,size:[d],datatype:y});break a}throw Error("Not implemented");}return f}if(1===d.length){a:{switch(a.storage()){case "dense":f=a._data;d=a._size;m=a._datatype;y=c._data;v=c._datatype;b=d[0];d=d[1];x=h;g=k;m&&v&&m===v&&"string"===typeof m&&(l=m,x=e.find(h,[l,l]),g=e.find(k,[l,l]));m=[];for(v=0;v<b;v++){for(var t=
f[v],O=g(t[0],y[0]),I=1;I<d;I++)O=x(O,g(t[I],y[I]));m[v]=O}f=new p({data:m,size:[b],datatype:l});break a;case "sparse":var x=a._values,g=a._index,m=a._ptr,D=a._datatype;if(!x)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var v=c._data,S=c._datatype,l=a._size[0],t=c._size[0],y=[],b=[],d=[],O=h,I=k,B=s,N=0;D&&S&&D===S&&"string"===typeof D&&(f=D,O=e.find(h,[f,f]),I=e.find(k,[f,f]),B=e.find(s,[f,f]),N=e.convert(0,f));for(var D=[],S=[],G=d[0]=0;G<t;G++){var P=v[G];if(!B(P,N))for(var J=
m[G+1],V=m[G];V<J;V++){var U=g[V];S[U]?D[U]=O(D[U],I(P,x[V])):(S[U]=!0,b.push(U),D[U]=I(P,x[V]))}}x=b.length;for(g=0;g<x;g++)y[g]=D[b[g]];d[1]=b.length;f=new u({values:y,index:b,ptr:d,size:[l,1],datatype:f});break a}f=void 0}return f}return n(a,c)},"Matrix, Array":function(a,c){return l(a,f(c))},"Array, Matrix":function(a,c){return l(f(a,c.storage()),c)},"Matrix, any":function(a,c){var b;switch(a.storage()){case "sparse":b=x(a,c,k,!1);break;case "dense":b=y(a,c,k,!1)}return b},"any, Matrix":function(a,
c){var b;switch(c.storage()){case "sparse":b=x(c,a,k,!0);break;case "dense":b=y(c,a,k,!0)}return b},"Array, any":function(a,c){return y(f(a),c,k,!1).valueOf()},"any, Array":function(a,c){return y(f(c),a,k,!0).valueOf()}},k.signatures)),r=function(a,c){switch(a.length){case 1:switch(c.length){case 1:if(a[0]!==c[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(a[0]!==c[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+
a[0]+") must match Matrix rows ("+c[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+c.length+" dimensions)");}break;case 2:switch(c.length){case 1:if(a[1]!==c[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+a[1]+") must match Vector length ("+c[0]+")");break;case 2:if(a[1]!==c[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+a[1]+") must match Matrix B rows ("+c[0]+")");break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+
c.length+" dimensions)");}break;default:throw Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+a.length+" dimensions)");}},n=function(a,c){switch(a.storage()){case "dense":switch(c.storage()){case "dense":var b=a._data,d=a._size,f=a._datatype,l=c._data,x=c._datatype,y=d[0],n=d[1],r=c._size[1],g,m=h,v=k;f&&x&&f===x&&"string"===typeof f&&(g=f,m=e.find(h,[g,g]),v=e.find(k,[g,g]));for(var t=[],D=0;D<y;D++){var S=b[D];t[D]=[];for(var B=0;B<r;B++){for(var N=v(S[0],l[0][B]),G=1;G<n;G++)N=
m(N,v(S[G],l[G][B]));t[D][B]=N}}return new p({data:t,size:[y,r],datatype:g});case "sparse":var P=a._data,J=a._size,V=a._datatype,U=c._values,sa=c._index,Na=c._ptr,ca=c._size,ua=c._datatype;if(!U)throw Error("Cannot multiply Dense Matrix times Pattern only Matrix");var Y=J[0],ta=ca[1],ra,ja=h,pa=k,Ca=s,Da=0;V&&ua&&V===ua&&"string"===typeof V&&(ra=V,ja=e.find(h,[ra,ra]),pa=e.find(k,[ra,ra]),Ca=e.find(s,[ra,ra]),Da=e.convert(0,ra));for(var R=[],xa=[],ya=[],Ka=new u({values:R,index:xa,ptr:ya,size:[Y,
ta],datatype:ra}),la=0;la<ta;la++){ya[la]=xa.length;var W=Na[la],Ga=Na[la+1];if(Ga>W)for(var ia=0,aa=0;aa<Y;aa++){for(var fa=aa+1,za,ga=W;ga<Ga;ga++){var ma=sa[ga];ia!==fa?(za=pa(P[aa][ma],U[ga]),ia=fa):za=ja(za,pa(P[aa][ma],U[ga]))}ia!==fa||Ca(za,Da)||(xa.push(aa),R.push(za))}}ya[ta]=xa.length;return Ka}break;case "sparse":switch(c.storage()){case "dense":var ba=a._values,na=a._index,da=a._ptr,Z=a._datatype;if(!ba)throw Error("Cannot multiply Pattern only Matrix times Dense Matrix");var $=c._data,
Ea=c._datatype,Aa=a._size[0],oa=c._size[0],Ba=c._size[1],va,eb=h,ab=k,fb=s,Ra=0;Z&&Ea&&Z===Ea&&"string"===typeof Z&&(va=Z,eb=e.find(h,[va,va]),ab=e.find(k,[va,va]),fb=e.find(s,[va,va]),Ra=e.convert(0,va));for(var qa=[],ea=[],Ha=[],Oa=new u({values:qa,index:ea,ptr:Ha,size:[Aa,Ba],datatype:va}),w=[],gb=[],Pa=0;Pa<Ba;Pa++){Ha[Pa]=ea.length;for(var ka=Pa+1,wa=0;wa<oa;wa++){var T=$[wa][Pa];if(!fb(T,Ra))for(var ha=da[wa+1],Ia=da[wa];Ia<ha;Ia++){var Fa=na[Ia];gb[Fa]!==ka?(gb[Fa]=ka,ea.push(Fa),w[Fa]=ab(T,
ba[Ia])):w[Fa]=eb(w[Fa],ab(T,ba[Ia]))}}for(var Ua=ea.length,Va=Ha[Pa];Va<Ua;Va++)qa[Va]=w[ea[Va]]}Ha[Ba]=ea.length;return Oa;case "sparse":var bb=a._values,cb=a._index,Wa=a._ptr,Xa=a._datatype,Ya=c._values,yb=c._index,sb=c._ptr,tb=c._datatype,zb=a._size[0],qb=c._size[1],hb=bb&&Ya,Za,ub=h,rb=k;Xa&&tb&&Xa===tb&&"string"===typeof Xa&&(Za=Xa,ub=e.find(h,[Za,Za]),rb=e.find(k,[Za,Za]));for(var vb=hb?[]:void 0,Sa=[],ib=[],Ab=new u({values:vb,index:Sa,ptr:ib,size:[zb,qb],datatype:Za}),jb=hb?[]:void 0,kb=
[],Ma,lb,mb,$a,wb,xb,Ja,db,Ta=0;Ta<qb;Ta++){ib[Ta]=Sa.length;var nb=Ta+1;wb=sb[Ta];xb=sb[Ta+1];for($a=wb;$a<xb;$a++)if(db=yb[$a],hb)for(lb=Wa[db],mb=Wa[db+1],Ma=lb;Ma<mb;Ma++)Ja=cb[Ma],kb[Ja]!==nb?(kb[Ja]=nb,Sa.push(Ja),jb[Ja]=rb(Ya[$a],bb[Ma])):jb[Ja]=ub(jb[Ja],rb(Ya[$a],bb[Ma]));else for(lb=Wa[db],mb=Wa[db+1],Ma=lb;Ma<mb;Ma++)Ja=cb[Ma],kb[Ja]!==nb&&(kb[Ja]=nb,Sa.push(Ja));if(hb)for(var Bb=Sa.length,ob=ib[Ta];ob<Bb;ob++)vb[ob]=jb[Sa[ob]]}ib[qb]=Sa.length;return Ab}}};l.toTex={2:"\\left(${args[0]}"+
c.operators.multiply+"${args[1]}\\right)"};return l}},function(t,m){m.factory=function(g,m,b,a){var c=a("multiplyScalar",{"number, number":function(a,c){return a*c},"Complex, Complex":function(a,c){return a.mul(c)},"BigNumber, BigNumber":function(a,c){return a.times(c)},"Fraction, Fraction":function(a,c){return a.mul(c)},"number | Fraction | BigNumber | Complex, Unit":function(a,b){var f=b.clone();f.value=null===f.value?f._normalize(a):c(f.value,a);return f},"Unit, number | Fraction | BigNumber | Complex":function(a,
b){var f=a.clone();f.value=null===f.value?f._normalize(b):c(f.value,b);return f},"Unit, Unit":function(a,c){return a.multiply(c)}});return c}},function(t,m,g){m.name="algorithm11";m.factory=function(m,b,a,c){var d=a(g(36)),e=m.SparseMatrix;return function(a,b,k,s){var x=a._values,y=a._index,p=a._ptr,u=a._size,l=a._datatype;if(!x)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var r=u[0],u=u[1],n;a=d;var g=0,m=k;"string"===typeof l&&(n=l,a=c.find(d,[n,n]),g=c.convert(0,
n),b=c.convert(b,n),m=c.find(k,[n,n]));k=[];var l=[],q=[];n=new e({values:k,index:l,ptr:q,size:[r,u],datatype:n});for(r=0;r<u;r++){q[r]=l.length;for(var z=p[r+1],v=p[r];v<z;v++){var A=y[v],t=s?m(b,x[v]):m(x[v],b);a(t,g)||(l.push(A),k.push(t))}}q[u]=l.length;return n}}},function(t,m,g){var v=g(25);m.name="fraction";m.factory=function(b,a,c,d){var e=d("fraction",{number:function(a){if(!isFinite(a)||isNaN(a))throw Error(a+" cannot be represented as a fraction");return new b.Fraction(a)},string:function(a){return new b.Fraction(a)},
"number, number":function(a,c){return new b.Fraction(a,c)},BigNumber:function(a){return new b.Fraction(a.toString())},Fraction:function(a){return a},Object:function(a){return new b.Fraction(a)},"Array | Matrix":function(a){return v(a,e)}});return e}},function(t,m,g){var v=g(25);m.name="number";m.factory=function(b,a,c,d){var e=d("number",{"":function(){return 0},number:function(a){return a},string:function(a){var c=Number(a);if(isNaN(c))throw new SyntaxError('String "'+a+'" is no valid number');return c},
BigNumber:function(a){return a.toNumber()},Fraction:function(a){return a.valueOf()},Unit:function(a){throw Error("Second argument with valueless unit expected");},"Unit, string | Unit":function(a,c){return a.toNumber(c)},"Array | Matrix":function(a){return v(a,e)}});e.toTex={0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"};return e}},function(t,m,g){var v=g(6).nearlyEqual,b=g(37);m.name="larger";m.factory=function(a,c,d,e){var f=d(g(31)),h=d(g(49)),k=d(g(50)),
s=d(g(51)),x=d(g(39)),y=d(g(40));a=g(33);var p=e("larger",{"boolean, boolean":function(a,c){return a>c},"number, number":function(a,b){return a>b&&!v(a,b,c.epsilon)},"BigNumber, BigNumber":function(a,d){return a.gt(d)&&!b(a,d,c.epsilon)},"Fraction, Fraction":function(a,c){return 1===a.compare(c)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,c){if(!a.equalBase(c))throw Error("Cannot compare units with different base");
return p(a.value,c.value)},"string, string":function(a,c){return a>c},"Matrix, Matrix":function(a,c){var b;switch(a.storage()){case "sparse":switch(c.storage()){case "sparse":b=k(a,c,p);break;default:b=h(c,a,p,!0)}break;default:switch(c.storage()){case "sparse":b=h(a,c,p,!1);break;default:b=x(a,c,p)}}return b},"Array, Array":function(a,c){return p(f(a),f(c)).valueOf()},"Array, Matrix":function(a,c){return p(f(a),c)},"Matrix, Array":function(a,c){return p(a,f(c))},"Matrix, any":function(a,c){var b;
switch(a.storage()){case "sparse":b=s(a,c,p,!1);break;default:b=y(a,c,p,!1)}return b},"any, Matrix":function(a,c){var b;switch(c.storage()){case "sparse":b=s(c,a,p,!0);break;default:b=y(c,a,p,!0)}return b},"Array, any":function(a,c){return y(f(a),c,p,!1).valueOf()},"any, Array":function(a,c){return y(f(c),a,p,!0).valueOf()}});p.toTex={2:"\\left(${args[0]}"+a.operators.larger+"${args[1]}\\right)"};return p}},function(t,m,g){var v=g(19);m.name="algorithm03";m.factory=function(b,a,c,d){var e=b.DenseMatrix;
return function(a,c,b,s){var x=a._data,y=a._size,p=a._datatype;a=c._values;var u=c._index,l=c._ptr,r=c._size,n=c._datatype;if(y.length!==r.length)throw new v(y.length,r.length);if(y[0]!==r[0]||y[1]!==r[1])throw new RangeError("Dimension mismatch. Matrix A ("+y+") must match Matrix B ("+r+")");if(!a)throw Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");c=y[0];var y=y[1],g,r=0,m=b;"string"===typeof p&&p===n&&(g=p,r=d.convert(0,g),m=d.find(b,[g,g]));b=[];for(p=0;p<c;p++)b[p]=
[];for(var p=[],n=[],q=0;q<y;q++){for(var z=q+1,t=l[q+1],A=l[q];A<t;A++){var C=u[A];p[C]=s?m(a[A],x[C][q]):m(x[C][q],a[A]);n[C]=z}for(t=0;t<c;t++)b[t][q]=n[t]===z?p[t]:s?m(r,x[t][q]):m(x[t][q],r)}return new e({data:b,size:[c,y],datatype:g})}}},function(t,m,g){var v=g(19);m.name="algorithm07";m.factory=function(b,a,c,d){var e=b.DenseMatrix,f=function(a,c,b,d,e){var f=a._values,u=a._index,l=a._ptr;a=l[c];for(c=l[c+1];a<c;a++)l=u[a],b[l]=e,d[l]=f[a]};return function(a,c,b){var x=a._size,y=a._datatype,
p=c._size,u=c._datatype;if(x.length!==p.length)throw new v(x.length,p.length);if(x[0]!==p[0]||x[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+x+") must match Matrix B ("+p+")");var p=x[0],x=x[1],l,r=0,n=b;"string"===typeof y&&y===u&&(l=y,r=d.convert(0,l),n=d.find(b,[l,l]));y=[];for(b=0;b<p;b++)y[b]=[];var u=new e({data:y,size:[p,x],datatype:l}),g=[],m=[],q=[],z=[];for(l=0;l<x;l++){var t=l+1;f(a,l,q,g,t);f(c,l,z,m,t);for(b=0;b<p;b++)y[b][l]=n(q[b]===t?g[b]:r,z[b]===t?m[b]:r)}return u}}},
function(t,m){m.name="algorithm12";m.factory=function(g,m,b,a){var c=g.DenseMatrix;return function(b,e,f,h){var k=b._values,s=b._index,x=b._ptr,y=b._size,p=b._datatype;if(!k)throw Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");b=y[0];var y=y[1],u,l=f;"string"===typeof p&&(u=p,e=a.convert(e,u),l=a.find(f,[u,u]));f=[];u=new c({data:f,size:[b,y],datatype:u});for(var p=[],r=[],n=0;n<y;n++){for(var g=n+1,m=x[n+1],q=x[n];q<m;q++){var z=s[q];p[z]=k[q];r[z]=g}for(m=0;m<b;m++)0===
n&&(f[m]=[]),f[m][n]=r[m]===g?h?l(e,p[m]):l(p[m],e):h?l(e,0):l(0,e)}return u}}},function(t,m,g){var v=g(6).nearlyEqual,b=g(37);m.name="smaller";m.factory=function(a,c,d,e){var f=d(g(31)),h=d(g(49)),k=d(g(50)),s=d(g(51)),x=d(g(39)),y=d(g(40));a=g(33);var p=e("smaller",{"boolean, boolean":function(a,c){return a<c},"number, number":function(a,b){return a<b&&!v(a,b,c.epsilon)},"BigNumber, BigNumber":function(a,d){return a.lt(d)&&!b(a,d,c.epsilon)},"Fraction, Fraction":function(a,c){return-1===a.compare(c)},
"Complex, Complex":function(a,c){throw new TypeError("No ordering relation is defined for complex numbers");},"Unit, Unit":function(a,c){if(!a.equalBase(c))throw Error("Cannot compare units with different base");return p(a.value,c.value)},"string, string":function(a,c){return a<c},"Matrix, Matrix":function(a,c){var b;switch(a.storage()){case "sparse":switch(c.storage()){case "sparse":b=k(a,c,p);break;default:b=h(c,a,p,!0)}break;default:switch(c.storage()){case "sparse":b=h(a,c,p,!1);break;default:b=
x(a,c,p)}}return b},"Array, Array":function(a,c){return p(f(a),f(c)).valueOf()},"Array, Matrix":function(a,c){return p(f(a),c)},"Matrix, Array":function(a,c){return p(a,f(c))},"Matrix, any":function(a,c){var b;switch(a.storage()){case "sparse":b=s(a,c,p,!1);break;default:b=y(a,c,p,!1)}return b},"any, Matrix":function(a,c){var b;switch(c.storage()){case "sparse":b=s(c,a,p,!0);break;default:b=y(c,a,p,!0)}return b},"Array, any":function(a,c){return y(f(a),c,p,!1).valueOf()},"any, Array":function(a,c){return y(f(c),
a,p,!0).valueOf()}});p.toTex={2:"\\left(${args[0]}"+a.operators.smaller+"${args[1]}\\right)"};return p}},function(t,m,g){var v=g(3).clone,b=g(16).format;m.name="trace";m.factory=function(a,c,d,e){var f=d(g(31)),h=d(g(30)),k=e("trace",{Array:function(a){return k(f(a))},Matrix:function(a){var c;switch(a.storage()){case "dense":a:{var d=a._size;c=a._data;switch(d.length){case 1:if(1==d[0]){c=v(c[0]);break a}throw new RangeError("Matrix must be square (size: "+b(d)+")");case 2:var e=d[0];if(e===d[1]){for(a=
d=0;a<e;a++)d=h(d,c[a][a]);c=d;break a}throw new RangeError("Matrix must be square (size: "+b(d)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+b(d)+")");}}break;case "sparse":c=a._values;var e=a._index,d=a._ptr,f=a._size;a=f[1];if(f[0]===a){f=0;if(0<c.length)for(var k=0;k<a;k++)for(var r=d[k+1],n=d[k];n<r;n++){var g=e[n];if(g===k){f=h(f,c[n]);break}if(g>k)break}c=f}else throw new RangeError("Matrix must be square (size: "+b(f)+")");}return c},any:v});k.toTex={1:"\\mathrm{tr}\\left(${args[0]}\\right)"};
return k}},function(t,m,g){var v=g(3).clone,b=g(16).format;m.name="transpose";m.factory=function(a,c,d,e){c=g(33);var f=d(g(31)),h=a.DenseMatrix,k=a.SparseMatrix,s=e("transpose",{Array:function(a){return s(f(a)).valueOf()},Matrix:function(a){var c=a.size(),d;switch(c.length){case 1:d=a.clone();break;case 2:var e=c[0],f=c[1];if(0===f)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+b(c)+")");switch(a.storage()){case "dense":c=a._data;d=[];for(var s,n=0;n<f;n++){s=d[n]=[];
for(var g=0;g<e;g++)s[g]=v(c[g][n])}d=new h({data:d,size:[f,e],datatype:a._datatype});break;case "sparse":c=a._values;d=a._index;s=a._ptr;for(var n=c?[]:void 0,g=[],m=[],q=[],z=0;z<e;z++)q[z]=0;var t,z=0;for(t=d.length;z<t;z++)q[d[z]]++;for(t=z=0;t<e;t++)m.push(z),z+=q[t],q[t]=m[t];m.push(z);for(z=0;z<f;z++){t=s[z+1];for(var A=s[z];A<t;A++){var C=q[d[A]]++;g[C]=z;c&&(n[C]=v(c[A]))}}d=new k({values:n,index:g,ptr:m,size:[f,e],datatype:a._datatype})}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+
b(this._size)+")");}return d},any:function(a){return v(a)}});s.toTex={1:"\\left(${args[0]}\\right)"+c.operators.transpose};return s}},function(t,m,g){var v=g(3).extend;m.name="divide";m.factory=function(b,a,c,d){var e=c(g(56)),f=c(g(43)),h=c(g(57)),k=c(g(31)),s=c(g(45)),x=c(g(40));b=d("divide",v({"Array | Matrix, Array | Matrix":function(a,c){return f(a,h(c))},"Matrix, any":function(a,c){var b;switch(a.storage()){case "sparse":b=s(a,c,e,!1);break;case "dense":b=x(a,c,e,!1)}return b},"Array, any":function(a,
c){return x(k(a),c,e,!1).valueOf()},"any, Array | Matrix":function(a,c){return f(a,h(c))}},e.signatures));b.toTex={2:"\\frac{${args[0]}}{${args[1]}}"};return b}},function(t,m,g){m.factory=function(m,b,a,c){var d=a(g(44)),e=c("divide",{"number, number":function(a,c){return a/c},"Complex, Complex":function(a,c){return a.div(c)},"BigNumber, BigNumber":function(a,c){return a.div(c)},"Fraction, Fraction":function(a,c){return a.div(c)},"Unit, number | Fraction | BigNumber":function(a,c){var b=a.clone();
b.value=e(null===b.value?b._normalize(1):b.value,c);return b},"number | Fraction | BigNumber, Unit":function(a,c){var b=c.pow(-1);b.value=d(null===b.value?b._normalize(1):b.value,a);return b},"Unit, Unit":function(a,c){return a.divide(c)}});return e}},function(t,m,g){var v=g(14);m.name="inv";m.factory=function(b,a,c,d){function e(a,c,b){var d,e;if(1==c){c=a[0][0];if(0==c)throw Error("Cannot calculate inverse, determinant is zero");return[[h(1,c)]]}if(2==c){c=y(a);if(0==c)throw Error("Cannot calculate inverse, determinant is zero");
return[[h(a[1][1],c),h(x(a[0][1]),c)],[h(x(a[1][0]),c),h(a[0][0],c)]]}var f=a.concat();for(a=0;a<c;a++)f[a]=f[a].concat();for(var g=p(c).valueOf(),m=0;m<b;m++){for(a=m;a<c&&0==f[a][m];)a++;if(a==c||0==f[a][m])throw Error("Cannot calculate inverse, determinant is zero");a!=m&&(d=f[m],f[m]=f[a],f[a]=d,d=g[m],g[m]=g[a],g[a]=d);var t=f[m],A=g[m];for(a=0;a<c;a++){var v=f[a],F=g[a];if(a!=m){if(0!=v[m]){e=h(x(v[m]),t[m]);for(d=m;d<b;d++)v[d]=k(v[d],s(e,t[d]));for(d=0;d<b;d++)F[d]=k(F[d],s(e,A[d]))}}else{e=
t[m];for(d=m;d<b;d++)v[d]=h(v[d],e);for(d=0;d<b;d++)F[d]=h(F[d],e)}}}return g}var f=c(g(31)),h=c(g(56)),k=c(g(32)),s=c(g(43)),x=c(g(58)),y=c(g(59)),p=c(g(42));b=d("inv",{"Array | Matrix":function(a){var c=!0===a.isMatrix?a.size():v.array.size(a);switch(c.length){case 1:if(1==c[0])return!0===a.isMatrix?f([h(1,a.valueOf()[0])]):[h(1,a[0])];throw new RangeError("Matrix must be square (size: "+v.string.format(c)+")");case 2:var b=c[0],d=c[1];if(b==d)return!0===a.isMatrix?f(e(a.valueOf(),b,d),a.storage()):
e(a,b,d);throw new RangeError("Matrix must be square (size: "+v.string.format(c)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+v.string.format(c)+")");}},any:function(a){return h(1,a)}});b.toTex={1:"\\left(${args[0]}\\right)^{-1}"};return b}},function(t,m,g){var v=g(25);m.name="unaryMinus";m.factory=function(b,a,c,d){b=g(33);var e=d("unaryMinus",{number:function(a){return-a},Complex:function(a){return a.neg()},BigNumber:function(a){return a.neg()},Fraction:function(a){return a.neg()},
Unit:function(a){var c=a.clone();c.value=e(a.value);return c},"Array | Matrix":function(a){return v(a,e,!0)}});e.toTex={1:b.operators.unaryMinus+"\\left(${args[0]}\\right)"};return e}},function(t,m,g){t=g(14);var v=t.object,b=t.string;m.name="det";m.factory=function(a,c,d,e){var f=d(g(31)),h=d(g(30)),k=d(g(60)),s=d(g(43)),x=d(g(58));a=e("det",{any:function(a){return v.clone(a)},"Array | Matrix":function(a){var c;a&&!0===a.isMatrix?c=a.size():Array.isArray(a)?(a=f(a),c=a.size()):c=[];switch(c.length){case 0:return v.clone(a);
case 1:if(1==c[0])return v.clone(a.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+b.format(c)+")");case 2:var d=c[0];if(d==c[1]){a=a.clone().valueOf();if(1==d)d=v.clone(a[0][0]);else if(2==d)d=k(s(a[0][0],a[1][1]),s(a[1][0],a[0][1]));else{var e=a;for(c=0;c<d-1;c++){for(var g=void 0,n=void 0,m=Array(e.length),t=0,g=1;g<e.length;g++)t=h(t,e[g][g]);for(g=0;g<e.length;g++){m[g]=Array(e.length);m[g][g]=x(t);for(n=0;n<g;n++)m[g][n]=0;for(n=g+1;n<e.length;n++)m[g][n]=e[g][n];g+1<e.length&&
(t=k(t,e[g+1][g+1]))}e=s(m,a)}d=0==d%2?x(e[0][0]):e[0][0]}return d}throw new RangeError("Matrix must be square (size: "+b.format(c)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+b.format(c)+")");}}});a.toTex={1:"\\det\\left(${args[0]}\\right)"};return a}},function(t,m,g){var v=g(19);m.name="subtract";m.factory=function(b,a,c,d){b=g(33);var e=c(g(31)),f=c(g(32)),h=c(g(58)),k=c(g(34)),s=c(g(49)),x=c(g(61)),y=c(g(38)),p=c(g(39)),m=c(g(40)),l=d("subtract",{"number, number":function(a,
c){return a-c},"Complex, Complex":function(a,c){return a.sub(c)},"BigNumber, BigNumber":function(a,c){return a.minus(c)},"Fraction, Fraction":function(a,c){return a.sub(c)},"Unit, Unit":function(a,c){if(null==a.value)throw Error("Parameter x contains a unit with undefined value");if(null==c.value)throw Error("Parameter y contains a unit with undefined value");if(!a.equalBase(c))throw Error("Units do not match");var b=a.clone();b.value=l(b.value,c.value);b.fixPrefix=!1;return b},"Matrix, Matrix":function(a,
c){var b=a.size(),d=c.size();if(b.length!==d.length)throw new v(b.length,d.length);switch(a.storage()){case "sparse":switch(c.storage()){case "sparse":b=x(a,c,l);break;default:b=s(c,a,l,!0)}break;default:switch(c.storage()){case "sparse":b=k(a,c,l,!1);break;default:b=p(a,c,l)}}return b},"Array, Array":function(a,c){return l(e(a),e(c)).valueOf()},"Array, Matrix":function(a,c){return l(e(a),c)},"Matrix, Array":function(a,c){return l(a,e(c))},"Matrix, any":function(a,c){var b;switch(a.storage()){case "sparse":b=
y(a,h(c),f);break;default:b=m(a,c,l)}return b},"any, Matrix":function(a,c){var b;switch(c.storage()){case "sparse":b=y(c,a,l,!0);break;default:b=m(c,a,l,!0)}return b},"Array, any":function(a,c){return m(e(a),c,l,!1).valueOf()},"any, Array":function(a,c){return m(e(c),a,l,!0).valueOf()}});l.toTex={2:"\\left(${args[0]}"+b.operators.subtract+"${args[1]}\\right)"};return l}},function(t,m,g){var v=g(19);m.name="algorithm05";m.factory=function(b,a,c,d){var e=c(g(36)),f=b.SparseMatrix;return function(a,
c,b){var x=a._values,g=a._index,m=a._ptr,u=a._size,l=a._datatype;a=c._values;var r=c._index,n=c._ptr,t=c._size,L=c._datatype;if(u.length!==t.length)throw new v(u.length,t.length);if(u[0]!==t[0]||u[1]!==t[1])throw new RangeError("Dimension mismatch. Matrix A ("+u+") must match Matrix B ("+t+")");var q=u[0],u=u[1],z;c=e;var t=0,K=b;"string"===typeof l&&l===L&&(z=l,c=d.find(e,[z,z]),t=d.convert(0,z),K=d.find(b,[z,z]));b=x&&a?[]:void 0;l=[];L=[];z=new f({values:b,index:l,ptr:L,size:[q,u],datatype:z});
var q=b?[]:void 0,A=b?[]:void 0,C=[],F=[],H,E,X,M;for(E=0;E<u;E++){L[E]=l.length;var O=E+1;X=m[E];for(M=m[E+1];X<M;X++)H=g[X],l.push(H),C[H]=O,q&&(q[H]=x[X]);X=n[E];for(M=n[E+1];X<M;X++)H=r[X],C[H]!==O&&l.push(H),F[H]=O,A&&(A[H]=a[X]);if(b)for(X=L[E];X<l.length;){H=l[X];M=C[H];var I=F[H];if(M===O||I===O)H=K(M===O?q[H]:t,I===O?A[H]:t),c(H,t)?l.splice(X,1):(b.push(H),X++)}}L[u]=l.length;return z}}},function(t,m,g){var v=g(15).size;m.name="cross";m.factory=function(b,a,c,d){function e(a,c){var b=v(a),
d=v(c);if(1!=b.length||1!=d.length||3!=b[0]||3!=d[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+b.join(", ")+"], B = ["+d.join(", ")+"])");return[h(k(a[1],c[2]),k(a[2],c[1])),h(k(a[2],c[0]),k(a[0],c[2])),h(k(a[0],c[1]),k(a[1],c[0]))]}var f=c(g(31)),h=c(g(60)),k=c(g(43));b=d("cross",{"Matrix, Matrix":function(a,c){return f(e(a.toArray(),c.toArray()))},"Matrix, Array":function(a,c){return f(e(a.toArray(),c))},"Array, Matrix":function(a,c){return f(e(a,c.toArray()))},"Array, Array":e});
b.toTex={2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"};return b}},function(t,m,g){var v=g(15).size;m.name="dot";m.factory=function(b,a,c,d){function e(a,c){var b=v(a),d=v(c),e=b[0];if(1!==b.length||1!==d.length)throw new RangeError("Vector expected");if(b[0]!=d[0])throw new RangeError("Vectors must have equal length ("+b[0]+" != "+d[0]+")");if(0==e)throw new RangeError("Cannot calculate the dot product of empty vectors");for(d=b=0;d<e;d++)b=f(b,h(a[d],c[d]));return b}var f=c(g(30)),
h=c(g(43));b=d("dot",{"Matrix, Matrix":function(a,c){return e(a.toArray(),c.toArray())},"Matrix, Array":function(a,c){return e(a.toArray(),c)},"Array, Matrix":function(a,c){return e(a,c.toArray())},"Array, Array":e});b.toTex={2:"\\left(${args[0]}\\cdot${args[1]}\\right)"};return b}}])})},function(da,Z,$){var t,m,g;(function(v){function b(a){return"[object Function]"===M.call(a)}function a(a){return"[object Array]"===M.call(a)}function c(a,c){if(a){var b;for(b=0;b<a.length&&(!a[b]||!c(a[b],b,a));b+=
1);}}function d(a,c){if(a){var b;for(b=a.length-1;-1<b&&(!a[b]||!c(a[b],b,a));b-=1);}}function e(a,c){return O.call(a,c)}function f(a,c){return e(a,c)&&a[c]}function h(a,c){for(var b in a)if(e(a,b)&&c(a[b],b))break}function k(c,d,f,l){d&&h(d,function(d,h){if(f||!e(c,h))!l||"object"!==typeof d||!d||a(d)||b(d)||d instanceof RegExp?c[h]=d:(c[h]||(c[h]={}),k(c[h],d,f,l))});return c}function s(a,c){return function(){return c.apply(a,arguments)}}function x(a){throw a;}function y(a){if(!a)return a;var b=
v;c(a.split("."),function(a){b=b[a]});return b}function p(a,c,b,d){c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+a);c.requireType=a;c.requireModules=d;b&&(c.originalError=b);return c}function u(g){function n(a,c,b){var d,e,k,h,l,s,x,g;c=c&&c.split("/");var y=aa.map,m=y&&y["*"];if(a){a=a.split("/");e=a.length-1;aa.nodeIdCompat&&E.test(a[e])&&(a[e]=a[e].replace(E,""));"."===a[0].charAt(0)&&c&&(e=c.slice(0,c.length-1),a=e.concat(a));e=a;for(k=0;k<e.length;k++)(h=e[k],"."===h)?(e.splice(k,1),k-=
1):".."===h&&0!==k&&(1!==k||".."!==e[2])&&".."!==e[k-1]&&0<k&&(e.splice(k-1,2),k-=2);a=a.join("/")}if(b&&y&&(c||m)){e=a.split("/");k=e.length;a:for(;0<k;k-=1){l=e.slice(0,k).join("/");if(c)for(h=c.length;0<h;h-=1)if(b=f(y,c.slice(0,h).join("/")))if(b=f(b,l)){d=b;s=k;break a}!x&&m&&f(m,l)&&(x=f(m,l),g=k)}!d&&x&&(d=x,s=g);d&&(e.splice(0,s,d),a=e.join("/"))}return(d=f(aa.pkgs,a))?d:a}function m(a){I&&c(document.getElementsByTagName("script"),function(c){if(c.getAttribute("data-requiremodule")===a&&c.getAttribute("data-requirecontext")===
W.contextName)return c.parentNode.removeChild(c),!0})}function r(c){var b=f(aa.paths,c);if(b&&a(b)&&1<b.length)return b.shift(),W.require.undef(c),W.makeRequire(null,{skipMap:!0})([c]),!0}function u(a){var c,b=a?a.indexOf("!"):-1;-1<b&&(c=a.substring(0,b),a=a.substring(b+1,a.length));return[c,a]}function q(a,c,b,d){var e,k,h=null,l=c?c.name:null,s=a,x=!0,g="";a||(x=!1,a="_@r"+($+=1));a=u(a);h=a[0];a=a[1];h&&(h=n(h,l,d),k=f(ba,h));a&&(h?g=k&&k.normalize?k.normalize(a,function(a){return n(a,l,d)}):
-1===a.indexOf("!")?n(a,l,d):a:(g=n(a,l,d),a=u(g),h=a[0],g=a[1],b=!0,e=W.nameToUrl(g)));b=!h||k||b?"":"_unnormalized"+(La+=1);return{prefix:h,name:g,parentMap:c,unnormalized:!!b,url:e,originalName:s,isDefine:x,id:(h?h+"!"+g:g)+b}}function A(a){var c=a.id,b=f(fa,c);b||(b=fa[c]=new W.Module(a));return b}function t(a,c,b){var d=a.id,k=f(fa,d);if(!e(ba,d)||k&&!k.defineEmitComplete)if(k=A(a),k.error&&"error"===c)b(k.error);else k.on(c,b);else"defined"===c&&b(ba[d])}function G(a,b){var d=a.requireModules,
e=!1;if(b)b(a);else if(c(d,function(c){if(c=f(fa,c))c.error=a,c.events.error&&(e=!0,c.emit("error",a))}),!e)l.onError(a)}function Q(){P.length&&(c(P,function(a){var c=a[0];"string"===typeof c&&(W.defQueueMap[c]=!0);ma.push(a)}),P=[])}function F(a){delete fa[a];delete Z[a]}function C(a,b,d){var e=a.map.id;a.error?a.emit("error",a.error):(b[e]=!0,c(a.depMaps,function(c,e){var k=c.id,h=f(fa,k);h&&!a.depMatched[e]&&!d[k]&&(f(b,k)?(a.defineDep(e,ba[k]),a.check()):C(h,b,d))}),d[e]=!0)}function H(){var a,
b,d=(a=1E3*aa.waitSeconds)&&W.startTime+a<(new Date).getTime(),e=[],f=[],k=!1,l=!0;if(!M){M=!0;h(Z,function(a){var c=a.map,h=c.id;if(a.enabled&&(c.isDefine||f.push(a),!a.error))if(!a.inited&&d)r(h)?k=b=!0:(e.push(h),m(h));else if(!a.inited&&a.fetched&&c.isDefine&&(k=!0,!c.prefix))return l=!1});if(d&&e.length)return a=p("timeout","Load timeout for modules: "+e,null,e),a.contextName=W.contextName,G(a);l&&c(f,function(a){C(a,{},{})});d&&!b||!k||!I&&!D||ia||(ia=setTimeout(function(){ia=0;H()},50));M=
!1}}function L(a){e(ba,a[0])||A(q(a[0],null,!0)).init(a[1],a[2])}function O(a){a=a.currentTarget||a.srcElement;var c=W.onScriptLoad;a.detachEvent&&!B?a.detachEvent("onreadystatechange",c):a.removeEventListener("load",c,!1);c=W.onScriptError;a.detachEvent&&!B||a.removeEventListener("error",c,!1);return{node:a,id:a&&a.getAttribute("data-requiremodule")}}function K(){var a;for(Q();ma.length;){a=ma.shift();if(null===a[0])return G(p("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));L(a)}W.defQueueMap=
{}}var M,N,W,Ga,ia,aa={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},fa={},Z={},ga={},ma=[],ba={},na={},da={},$=1,La=1;Ga={require:function(a){return a.require?a.require:a.require=W.makeRequire(a.map)},exports:function(a){a.usingExports=!0;if(a.map.isDefine)return a.exports?ba[a.map.id]=a.exports:a.exports=ba[a.map.id]={}},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return f(aa.config,a.map.id)||{}},exports:a.exports||
(a.exports={})}}};N=function(a){this.events=f(ga,a.id)||{};this.map=a;this.shim=f(aa.shim,a.id);this.depExports=[];this.depMaps=[];this.depMatched=[];this.pluginMaps={};this.depCount=0};N.prototype={init:function(a,c,b,d){d=d||{};if(!this.inited){this.factory=c;if(b)this.on("error",b);else this.events.error&&(b=s(this,function(a){this.emit("error",a)}));this.depMaps=a&&a.slice(0);this.errback=b;this.inited=!0;this.ignore=d.ignore;d.enabled||this.enabled?this.enable():this.check()}},defineDep:function(a,
c){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=c)},fetch:function(){if(!this.fetched){this.fetched=!0;W.startTime=(new Date).getTime();var a=this.map;if(this.shim)W.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],s(this,function(){return a.prefix?this.callPlugin():this.load()}));else return a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;na[a]||(na[a]=!0,W.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,
c,d=this.map.id;c=this.depExports;var f=this.exports,k=this.factory;if(this.inited)if(this.error)this.emit("error",this.error);else{if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(b(k)){if(this.events.error&&this.map.isDefine||l.onError!==x)try{f=W.execCb(d,k,c,f)}catch(h){a=h}else f=W.execCb(d,k,c,f);this.map.isDefine&&void 0===f&&((c=this.module)?f=c.exports:this.usingExports&&(f=this.exports));if(a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:
null,a.requireType=this.map.isDefine?"define":"require",G(this.error=a)}else f=k;this.exports=f;if(this.map.isDefine&&!this.ignore&&(ba[d]=f,l.onResourceLoad))l.onResourceLoad(W,this.map,this.depMaps);F(d);this.defined=!0}this.defining=!1;this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else e(W.defQueueMap,d)||this.fetch()}},callPlugin:function(){var a=this.map,c=a.id,b=q(a.prefix);this.depMaps.push(b);t(b,"defined",s(this,function(b){var d,
k;k=f(da,this.map.id);var x=this.map.name,g=this.map.parentMap?this.map.parentMap.name:null,y=W.makeRequire(a.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(b.normalize&&(x=b.normalize(x,function(a){return n(a,g,!0)})||""),b=q(a.prefix+"!"+x,this.map.parentMap),t(b,"defined",s(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=f(fa,b.id)){this.depMaps.push(b);if(this.events.error)k.on("error",s(this,function(a){this.emit("error",a)}));k.enable()}}else k?
(this.map.url=W.nameToUrl(k),this.load()):(d=s(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),d.error=s(this,function(a){this.inited=!0;this.error=a;a.requireModules=[c];h(fa,function(a){0===a.map.id.indexOf(c+"_unnormalized")&&F(a.map.id)});G(a)}),d.fromText=s(this,function(b,f){var k=a.name,h=q(k),s=J;f&&(b=f);s&&(J=!1);A(h);e(aa.config,c)&&(aa.config[k]=aa.config[c]);try{l.exec(b)}catch(x){return G(p("fromtexteval","fromText eval for "+c+" failed: "+x,x,[c]))}s&&(J=!0);
this.depMaps.push(h);W.completeLoad(k);y([k],d)}),b.load(a.name,y,d,aa))}));W.enable(b,this);this.pluginMaps[b.id]=b},enable:function(){Z[this.map.id]=this;this.enabling=this.enabled=!0;c(this.depMaps,s(this,function(a,c){var b,d;if("string"===typeof a){a=q(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap);this.depMaps[c]=a;if(b=f(Ga,a.id)){this.depExports[c]=b(this);return}this.depCount+=1;t(a,"defined",s(this,function(a){this.undefed||(this.defineDep(c,a),this.check())}));this.errback?
t(a,"error",s(this,this.errback)):this.events.error&&t(a,"error",s(this,function(a){this.emit("error",a)}))}b=a.id;d=fa[b];!e(Ga,b)&&d&&!d.enabled&&W.enable(a,this)}));h(this.pluginMaps,s(this,function(a){var c=f(fa,a.id);c&&!c.enabled&&W.enable(a,this)}));this.enabling=!1;this.check()},on:function(a,c){var b=this.events[a];b||(b=this.events[a]=[]);b.push(c)},emit:function(a,b){c(this.events[a],function(a){a(b)});"error"===a&&delete this.events[a]}};W={config:aa,contextName:g,registry:fa,defined:ba,
urlFetched:na,defQueue:ma,defQueueMap:{},Module:N,makeModuleMap:q,nextTick:l.nextTick,onError:G,configure:function(b){b.baseUrl&&"/"!==b.baseUrl.charAt(b.baseUrl.length-1)&&(b.baseUrl+="/");var d=aa.shim,e={paths:!0,bundles:!0,config:!0,map:!0};h(b,function(a,c){e[c]?(aa[c]||(aa[c]={}),k(aa[c],a,!0,!0)):aa[c]=a});b.bundles&&h(b.bundles,function(a,b){c(a,function(a){a!==b&&(da[a]=b)})});b.shim&&(h(b.shim,function(c,b){a(c)&&(c={deps:c});!c.exports&&!c.init||c.exportsFn||(c.exportsFn=W.makeShimExports(c));
d[b]=c}),aa.shim=d);b.packages&&c(b.packages,function(a){var c;a="string"===typeof a?{name:a}:a;c=a.name;a.location&&(aa.paths[c]=a.location);aa.pkgs[c]=a.name+"/"+(a.main||"main").replace(X,"").replace(E,"")});h(fa,function(a,c){a.inited||a.map.unnormalized||(a.map=q(c,null,!0))});(b.deps||b.callback)&&W.require(b.deps||[],b.callback)},makeShimExports:function(a){return function(){var c;a.init&&(c=a.init.apply(v,arguments));return c||a.exports&&y(a.exports)}},makeRequire:function(a,c){function h(d,
f,k){var s,x;c.enableBuildCallback&&f&&b(f)&&(f.__requireJsBuild=!0);if("string"===typeof d){if(b(f))return G(p("requireargs","Invalid require call"),k);if(a&&e(Ga,d))return Ga[d](fa[a.id]);if(l.get)return l.get(W,d,a,h);s=q(d,a,!1,!0);s=s.id;return e(ba,s)?ba[s]:G(p("notloaded",'Module name "'+s+'" has not been loaded yet for context: '+g+(a?"":". Use require([])")))}K();W.nextTick(function(){K();x=A(q(null,a));x.skipMap=c.skipMap;x.init(d,f,k,{enabled:!0});H()});return h}c=c||{};k(h,{isBrowser:I,
toUrl:function(c){var b,d=c.lastIndexOf("."),e=c.split("/")[0];-1!==d&&("."!==e&&".."!==e||1<d)&&(b=c.substring(d,c.length),c=c.substring(0,d));return W.nameToUrl(n(c,a&&a.id,!0),b,!0)},defined:function(c){return e(ba,q(c,a,!1,!0).id)},specified:function(c){c=q(c,a,!1,!0).id;return e(ba,c)||e(fa,c)}});a||(h.undef=function(c){Q();var b=q(c,a,!0),e=f(fa,c);e.undefed=!0;m(c);delete ba[c];delete na[b.url];delete ga[c];d(ma,function(a,b){a[0]===c&&ma.splice(b,1)});delete W.defQueueMap[c];e&&(e.events.defined&&
(ga[c]=e.events),F(c))});return h},enable:function(a){f(fa,a.id)&&A(a).enable()},completeLoad:function(a){var c,b,d=f(aa.shim,a)||{},k=d.exports;for(Q();ma.length;){b=ma.shift();if(null===b[0]){b[0]=a;if(c)break;c=!0}else b[0]===a&&(c=!0);L(b)}W.defQueueMap={};b=f(fa,a);if(!c&&!e(ba,a)&&b&&!b.inited){if(aa.enforceDefine&&(!k||!y(k)))return r(a)?void 0:G(p("nodefine","No define call for "+a,null,[a]));L([a,d.deps||[],d.exportsFn])}H()},nameToUrl:function(c,b,d){var e,k,h;(e=f(aa.pkgs,c))&&(c=e);if(e=
f(da,c))return W.nameToUrl(e,b,d);if(l.jsExtRegExp.test(c))e=c+(b||"");else{e=aa.paths;c=c.split("/");for(k=c.length;0<k;k-=1)if(h=c.slice(0,k).join("/"),h=f(e,h)){a(h)&&(h=h[0]);c.splice(0,k,h);break}e=c.join("/");e+=b||(/^data\:|\?/.test(e)||d?"":".js");e=("/"===e.charAt(0)||e.match(/^[\w\+\.\-]+:/)?"":aa.baseUrl)+e}return aa.urlArgs?e+((-1===e.indexOf("?")?"?":"&")+aa.urlArgs):e},load:function(a,c){l.load(W,a,c)},execCb:function(a,c,b,d){return c.apply(d,b)},onScriptLoad:function(a){if("load"===
a.type||S.test((a.currentTarget||a.srcElement).readyState))z=null,a=O(a),W.completeLoad(a.id)},onScriptError:function(a){var c=O(a);if(!r(c.id))return G(p("scripterror","Script error for: "+c.id,a,[c.id]))}};W.require=W.makeRequire();return W}var l,r,n,Q,L,q,z,K,A,C,F=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,H=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,E=/\.js$/,X=/^\.\//;r=Object.prototype;var M=r.toString,O=r.hasOwnProperty,I=!("undefined"===typeof window||"undefined"===typeof navigator||
!window.document),D=!I&&"undefined"!==typeof importScripts,S=I&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,B="undefined"!==typeof opera&&"[object Opera]"===opera.toString(),N={},G={},P=[],J=!1;if("undefined"===typeof g){if("undefined"!==typeof m){if(b(m))return;G=m;m=void 0}"undefined"!==typeof t&&!b(t)&&(G=t,t=void 0);l=m=function(c,b,d,e){var k,h="_";!a(c)&&"string"!==typeof c&&(k=c,a(b)?(c=b,b=d,d=e):c=[]);k&&k.context&&(h=k.context);(e=f(N,h))||(e=N[h]=l.s.newContext(h));
k&&e.configure(k);return e.require(c,b,d)};l.config=function(a){return l(a)};l.nextTick="undefined"!==typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()};t||(t=l);l.version="2.1.20";l.jsExtRegExp=/^\/|:|\?|\.js$/;l.isBrowser=I;r=l.s={contexts:N,newContext:u};l({});c(["toUrl","undef","defined","specified"],function(a){l[a]=function(){var c=N._;return c.require[a].apply(c,arguments)}});I&&(n=r.head=document.getElementsByTagName("head")[0],Q=document.getElementsByTagName("base")[0])&&(n=
r.head=Q.parentNode);l.onError=x;l.createNode=function(a){var c=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");c.type=a.scriptType||"text/javascript";c.charset="utf-8";c.async=!0;return c};l.load=function(a,c,b){var d=a&&a.config||{},e;if(I){e=l.createNode(d,c,b);if(d.onNodeCreated)d.onNodeCreated(e,d,c,b);e.setAttribute("data-requirecontext",a.contextName);e.setAttribute("data-requiremodule",c);!e.attachEvent||e.attachEvent.toString&&
0>e.attachEvent.toString().indexOf("[native code")||B?(e.addEventListener("load",a.onScriptLoad,!1),e.addEventListener("error",a.onScriptError,!1)):(J=!0,e.attachEvent("onreadystatechange",a.onScriptLoad));e.src=b;K=e;Q?n.insertBefore(e,Q):n.appendChild(e);K=null;return e}if(D)try{importScripts(b),a.completeLoad(c)}catch(f){a.onError(p("importscripts","importScripts failed for "+c+" at "+b,f,[c]))}};I&&!G.skipDataMain&&d(document.getElementsByTagName("script"),function(a){n||(n=a.parentNode);if(L=
a.getAttribute("data-main"))return A=L,G.baseUrl||(q=A.split("/"),A=q.pop(),C=q.length?q.join("/")+"/":"./",G.baseUrl=C),A=A.replace(E,""),l.jsExtRegExp.test(A)&&(A=L),G.deps=G.deps?G.deps.concat(A):[A],!0});g=function(c,e,f){var k,h;"string"!==typeof c&&(f=e,e=c,c=null);a(e)||(f=e,e=null);!e&&b(f)&&(e=[],f.length&&(f.toString().replace(F,"").replace(H,function(a,c){e.push(c)}),e=(1===f.length?["require"]:["require","exports","module"]).concat(e)));J&&((k=K)||(z&&"interactive"===z.readyState||d(document.getElementsByTagName("script"),
function(a){if("interactive"===a.readyState)return z=a}),k=z),k&&(c||(c=k.getAttribute("data-requiremodule")),h=N[k.getAttribute("data-requirecontext")]));h?(h.defQueue.push([c,e,f]),h.defQueueMap[c]=!0):P.push([c,e,f])};g.amd={jQuery:!0};l.exec=function(a){return eval(a)};l(G)}})(this)},function(da,Z,$){var t,m,g;(function(v,b){!(m=[Z],t=b,g="function"===typeof t?t.apply(Z,m):t,void 0!==g&&(da.exports=g))})(this,function(m){var b={REVISION:"76"};!(t=b,g="function"===typeof t?t.call(m,$,m,da):t,void 0!==
g&&(da.exports=g));void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");
for(var c=Object(a),b=1,e=arguments.length;b!==e;++b){var f=arguments[b];if(void 0!==f&&null!==f)for(var f=Object(f),h=Object.keys(f),k=0,s=h.length;k!==s;++k){var x=h[k],g=Object.getOwnPropertyDescriptor(f,x);void 0!==g&&g.enumerable&&(c[x]=f[x])}}return c}});b.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};b.CullFaceNone=0;b.CullFaceBack=1;b.CullFaceFront=2;b.CullFaceFrontBack=3;b.FrontFaceDirectionCW=0;b.FrontFaceDirectionCCW=1;b.BasicShadowMap=0;b.PCFShadowMap=1;b.PCFSoftShadowMap=2;b.FrontSide=0;b.BackSide=
1;b.DoubleSide=2;b.FlatShading=1;b.SmoothShading=2;b.NoColors=0;b.FaceColors=1;b.VertexColors=2;b.NoBlending=0;b.NormalBlending=1;b.AdditiveBlending=2;b.SubtractiveBlending=3;b.MultiplyBlending=4;b.CustomBlending=5;b.AddEquation=100;b.SubtractEquation=101;b.ReverseSubtractEquation=102;b.MinEquation=103;b.MaxEquation=104;b.ZeroFactor=200;b.OneFactor=201;b.SrcColorFactor=202;b.OneMinusSrcColorFactor=203;b.SrcAlphaFactor=204;b.OneMinusSrcAlphaFactor=205;b.DstAlphaFactor=206;b.OneMinusDstAlphaFactor=
207;b.DstColorFactor=208;b.OneMinusDstColorFactor=209;b.SrcAlphaSaturateFactor=210;b.NeverDepth=0;b.AlwaysDepth=1;b.LessDepth=2;b.LessEqualDepth=3;b.EqualDepth=4;b.GreaterEqualDepth=5;b.GreaterDepth=6;b.NotEqualDepth=7;b.MultiplyOperation=0;b.MixOperation=1;b.AddOperation=2;b.NoToneMapping=0;b.LinearToneMapping=1;b.ReinhardToneMapping=2;b.Uncharted2ToneMapping=3;b.CineonToneMapping=4;b.UVMapping=300;b.CubeReflectionMapping=301;b.CubeRefractionMapping=302;b.EquirectangularReflectionMapping=303;b.EquirectangularRefractionMapping=
304;b.SphericalReflectionMapping=305;b.CubeUVReflectionMapping=306;b.CubeUVRefractionMapping=307;b.RepeatWrapping=1E3;b.ClampToEdgeWrapping=1001;b.MirroredRepeatWrapping=1002;b.NearestFilter=1003;b.NearestMipMapNearestFilter=1004;b.NearestMipMapLinearFilter=1005;b.LinearFilter=1006;b.LinearMipMapNearestFilter=1007;b.LinearMipMapLinearFilter=1008;b.UnsignedByteType=1009;b.ByteType=1010;b.ShortType=1011;b.UnsignedShortType=1012;b.IntType=1013;b.UnsignedIntType=1014;b.FloatType=1015;b.HalfFloatType=
1025;b.UnsignedShort4444Type=1016;b.UnsignedShort5551Type=1017;b.UnsignedShort565Type=1018;b.AlphaFormat=1019;b.RGBFormat=1020;b.RGBAFormat=1021;b.LuminanceFormat=1022;b.LuminanceAlphaFormat=1023;b.RGBEFormat=b.RGBAFormat;b.DepthFormat=1026;b.RGB_S3TC_DXT1_Format=2001;b.RGBA_S3TC_DXT1_Format=2002;b.RGBA_S3TC_DXT3_Format=2003;b.RGBA_S3TC_DXT5_Format=2004;b.RGB_PVRTC_4BPPV1_Format=2100;b.RGB_PVRTC_2BPPV1_Format=2101;b.RGBA_PVRTC_4BPPV1_Format=2102;b.RGBA_PVRTC_2BPPV1_Format=2103;b.RGB_ETC1_Format=2151;
b.LoopOnce=2200;b.LoopRepeat=2201;b.LoopPingPong=2202;b.InterpolateDiscrete=2300;b.InterpolateLinear=2301;b.InterpolateSmooth=2302;b.ZeroCurvatureEnding=2400;b.ZeroSlopeEnding=2401;b.WrapAroundEnding=2402;b.TrianglesDrawMode=0;b.TriangleStripDrawMode=1;b.TriangleFanDrawMode=2;b.LinearEncoding=3E3;b.sRGBEncoding=3001;b.GammaEncoding=3007;b.RGBEEncoding=3002;b.LogLuvEncoding=3003;b.RGBM7Encoding=3004;b.RGBM16Encoding=3005;b.RGBDEncoding=3006;b.BasicDepthPacking=3200;b.RGBADepthPacking=3201;b.Color=
function(a){return 3===arguments.length?this.fromArray(arguments):this.set(a)};b.Color.prototype={constructor:b.Color,r:1,g:1,b:1,set:function(a){a instanceof b.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,c,b){this.r=a;this.g=c;this.b=b;return this},setHSL:function(){function a(a,
b,e){0>e&&(e+=1);1<e&&(e-=1);return e<1/6?a+6*(b-a)*e:.5>e?b:e<2/3?a+6*(b-a)*(2/3-e):a}return function(c,d,e){c=b.Math.euclideanModulo(c,1);d=b.Math.clamp(d,0,1);e=b.Math.clamp(e,0,1);0===d?this.r=this.g=this.b=e:(d=.5>=e?e*(1+d):e+d-e*d,e=2*e-d,this.r=a(e,d,c+1/3),this.g=a(e,d,c),this.b=a(e,d,c-1/3));return this}}(),setStyle:function(a){function c(c){void 0!==c&&1>parseFloat(c)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var d;if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var e=
d[2];switch(d[1]){case "rgb":case "rgba":if(d=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=Math.min(255,parseInt(d[1],10))/255,this.g=Math.min(255,parseInt(d[2],10))/255,this.b=Math.min(255,parseInt(d[3],10))/255,c(d[5]),this;if(d=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e))return this.r=Math.min(100,parseInt(d[1],10))/100,this.g=Math.min(100,parseInt(d[2],10))/100,this.b=Math.min(100,parseInt(d[3],10))/100,c(d[5]),this;break;
case "hsl":case "hsla":if(d=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(e)){var e=parseFloat(d[1])/360,f=parseInt(d[2],10)/100,h=parseInt(d[3],10)/100;c(d[5]);return this.setHSL(e,f,h)}}}else if(d=/^\#([A-Fa-f0-9]+)$/.exec(a)){d=d[1];e=d.length;if(3===e)return this.r=parseInt(d.charAt(0)+d.charAt(0),16)/255,this.g=parseInt(d.charAt(1)+d.charAt(1),16)/255,this.b=parseInt(d.charAt(2)+d.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(d.charAt(0)+d.charAt(1),
16)/255,this.g=parseInt(d.charAt(2)+d.charAt(3),16)/255,this.b=parseInt(d.charAt(4)+d.charAt(5),16)/255,this}a&&0<a.length&&(d=b.ColorKeywords[a],void 0!==d?this.setHex(d):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,c){void 0===c&&(c=2);this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this},copyLinearToGamma:function(a,
c){void 0===c&&(c=2);var b=0<c?1/c:1;this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},convertGammaToLinear:function(){var a=this.r,c=this.g,b=this.b;this.r=a*a;this.g=c*c;this.b=b*b;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=
a||{h:0,s:0,l:0};var c=this.r,b=this.g,e=this.b,f=Math.max(c,b,e),h=Math.min(c,b,e),k,s=(h+f)/2;if(h===f)h=k=0;else{var x=f-h,h=.5>=s?x/(f+h):x/(2-f-h);switch(f){case c:k=(b-e)/x+(b<e?6:0);break;case b:k=(e-c)/x+2;break;case e:k=(c-b)/x+4}k/=6}a.h=k;a.s=h;a.l=s;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,c,b){var e=this.getHSL();e.h+=a;e.s+=c;e.l+=b;this.setHSL(e.h,e.s,e.l);return this},add:function(a){this.r+=a.r;this.g+=
a.g;this.b+=a.b;return this},addColors:function(a,c){this.r=a.r+c.r;this.g=a.g+c.g;this.b=a.b+c.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,c){this.r+=(a.r-this.r)*c;this.g+=(a.g-this.g)*c;this.b+=(a.b-this.b)*c;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,
c){void 0===c&&(c=0);this.r=a[c];this.g=a[c+1];this.b=a[c+2];return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this.r;a[c+1]=this.g;a[c+2]=this.b;return a}};b.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,
cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,
floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,
lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,
moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,
silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b.Quaternion=function(a,c,b,e){this._x=a||0;this._y=c||0;this._z=b||0;this._w=void 0!==e?e:1};b.Quaternion.prototype={constructor:b.Quaternion,get x(){return this._x},set x(a){this._x=a;
this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,c,b,e){this._x=a;this._y=c;this._z=b;this._w=e;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},
setFromEuler:function(a,c){if(!1===a instanceof b.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var d=Math.cos(a._x/2),e=Math.cos(a._y/2),f=Math.cos(a._z/2),h=Math.sin(a._x/2),k=Math.sin(a._y/2),s=Math.sin(a._z/2),x=a.order;"XYZ"===x?(this._x=h*e*f+d*k*s,this._y=d*k*f-h*e*s,this._z=d*e*s+h*k*f,this._w=d*e*f-h*k*s):"YXZ"===x?(this._x=h*e*f+d*k*s,this._y=d*k*f-h*e*s,this._z=d*e*s-h*k*f,this._w=d*e*f+h*k*s):"ZXY"===x?(this._x=h*e*
f-d*k*s,this._y=d*k*f+h*e*s,this._z=d*e*s+h*k*f,this._w=d*e*f-h*k*s):"ZYX"===x?(this._x=h*e*f-d*k*s,this._y=d*k*f+h*e*s,this._z=d*e*s-h*k*f,this._w=d*e*f+h*k*s):"YZX"===x?(this._x=h*e*f+d*k*s,this._y=d*k*f+h*e*s,this._z=d*e*s-h*k*f,this._w=d*e*f-h*k*s):"XZY"===x&&(this._x=h*e*f-d*k*s,this._y=d*k*f-h*e*s,this._z=d*e*s+h*k*f,this._w=d*e*f+h*k*s);if(!1!==c)this.onChangeCallback();return this},setFromAxisAngle:function(a,c){var b=c/2,e=Math.sin(b);this._x=a.x*e;this._y=a.y*e;this._z=a.z*e;this._w=Math.cos(b);
this.onChangeCallback();return this},setFromRotationMatrix:function(a){var c=a.elements,b=c[0];a=c[4];var e=c[8],f=c[1],h=c[5],k=c[9],s=c[2],x=c[6],c=c[10],g=b+h+c;0<g?(b=.5/Math.sqrt(g+1),this._w=.25/b,this._x=(x-k)*b,this._y=(e-s)*b,this._z=(f-a)*b):b>h&&b>c?(b=2*Math.sqrt(1+b-h-c),this._w=(x-k)/b,this._x=.25*b,this._y=(a+f)/b,this._z=(e+s)/b):h>c?(b=2*Math.sqrt(1+h-b-c),this._w=(e-s)/b,this._x=(a+f)/b,this._y=.25*b,this._z=(k+x)/b):(b=2*Math.sqrt(1+c-b-h),this._w=(f-a)/b,this._x=(e+s)/b,this._y=
(k+x)/b,this._z=.25*b);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,c;return function(d,e){void 0===a&&(a=new b.Vector3);c=d.dot(e)+1;1E-6>c?(c=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e);this._x=a.x;this._y=a.y;this._z=a.z;this._w=c;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*
a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,c)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,c){var b=a._x,e=a._y,f=a._z,h=a._w,k=c._x,s=c._y,x=c._z,g=c._w;this._x=b*g+h*k+e*x-f*s;this._y=e*g+h*s+f*k-b*x;this._z=f*g+h*x+b*s-e*k;this._w=h*g-b*k-e*s-f*x;this.onChangeCallback();return this},slerp:function(a,c){if(0===c)return this;if(1===c)return this.copy(a);var b=this._x,e=this._y,f=this._z,h=this._w,k=h*a._w+b*a._x+e*a._y+f*a._z;0>k?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,k=-k):
this.copy(a);if(1<=k)return this._w=h,this._x=b,this._y=e,this._z=f,this;var s=Math.sqrt(1-k*k);if(.001>Math.abs(s))return this._w=.5*(h+this._w),this._x=.5*(b+this._x),this._y=.5*(e+this._y),this._z=.5*(f+this._z),this;var x=Math.atan2(s,k),k=Math.sin((1-c)*x)/s,s=Math.sin(c*x)/s;this._w=h*k+this._w*s;this._x=b*k+this._x*s;this._y=e*k+this._y*s;this._z=f*k+this._z*s;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,
c){void 0===c&&(c=0);this._x=a[c];this._y=a[c+1];this._z=a[c+2];this._w=a[c+3];this.onChangeCallback();return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this._x;a[c+1]=this._y;a[c+2]=this._z;a[c+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};Object.assign(b.Quaternion,{slerp:function(a,c,b,e){return b.copy(a).slerp(c,e)},slerpFlat:function(a,c,b,e,f,h,k){var s=b[e+0],x=b[e+1],g=b[e+2];b=b[e+3];e=f[h+0];var m=
f[h+1],u=f[h+2];f=f[h+3];if(b!==f||s!==e||x!==m||g!==u){h=1-k;var l=s*e+x*m+g*u+b*f,r=0<=l?1:-1,n=1-l*l;n>Number.EPSILON&&(n=Math.sqrt(n),l=Math.atan2(n,l*r),h=Math.sin(h*l)/n,k=Math.sin(k*l)/n);r*=k;s=s*h+e*r;x=x*h+m*r;g=g*h+u*r;b=b*h+f*r;h===1-k&&(k=1/Math.sqrt(s*s+x*x+g*g+b*b),s*=k,x*=k,g*=k,b*=k)}a[c]=s;a[c+1]=x;a[c+2]=g;a[c+3]=b}});b.Vector2=function(a,c){this.x=a||0;this.y=c||0};b.Vector2.prototype={constructor:b.Vector2,get width(){return this.x},set width(a){this.x=a},get height(){return this.y},
set height(a){this.y=a},set:function(a,c){this.x=a;this.y=c;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,c){if(void 0!==c)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,c);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,c){this.x=a.x+c.x;this.y=a.y+c.y;return this},addScaledVector:function(a,c){this.x+=a.x*c;this.y+=a.y*c;return this},sub:function(a,c){if(void 0!==c)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,c);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,c){this.x=a.x-c.x;this.y=a.y-c.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a):this.y=this.x=0;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,c){this.x=Math.max(a.x,Math.min(c.x,this.x));this.y=Math.max(a.y,Math.min(c.y,this.y));return this},clampScalar:function(){var a,c;return function(d,e){void 0===a&&(a=new b.Vector2,c=new b.Vector2);a.set(d,d);c.set(e,e);return this.clamp(a,c)}}(),clampLength:function(a,c){var b=this.length();this.multiplyScalar(Math.max(a,Math.min(c,b))/b);return this},floor:function(){this.x=Math.floor(this.x);
this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},
length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var c=this.x-a.x;a=this.y-a.y;return c*c+a*a},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,
c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;return this},lerpVectors:function(a,c,b){this.subVectors(c,a).multiplyScalar(b).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,c){void 0===c&&(c=0);this.x=a[c];this.y=a[c+1];return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this.x;a[c+1]=this.y;return a},fromAttribute:function(a,c,b){void 0===b&&(b=0);c=c*a.itemSize+b;this.x=a.array[c];this.y=a.array[c+1];return this},rotateAround:function(a,
c){var b=Math.cos(c),e=Math.sin(c),f=this.x-a.x,h=this.y-a.y;this.x=f*b-h*e+a.x;this.y=f*e+h*b+a.y;return this}};b.Vector3=function(a,c,b){this.x=a||0;this.y=c||0;this.z=b||0};b.Vector3.prototype={constructor:b.Vector3,set:function(a,c,b){this.x=a;this.y=c;this.z=b;return this},setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,c){switch(a){case 0:this.x=
c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,c){if(void 0!==c)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(a,c);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,c){this.x=a.x+c.x;this.y=a.y+c.y;this.z=a.z+c.z;return this},addScaledVector:function(a,c){this.x+=a.x*c;this.y+=a.y*c;this.z+=a.z*c;return this},sub:function(a,c){if(void 0!==c)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,c);this.x-=a.x;this.y-=a.y;this.z-=a.z;
return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,c){this.x=a.x-c.x;this.y=a.y-c.y;this.z=a.z-c.z;return this},multiply:function(a,c){if(void 0!==c)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,c);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},multiplyVectors:function(a,
c){this.x=a.x*c.x;this.y=a.y*c.y;this.z=a.z*c.z;return this},applyEuler:function(){var a;return function(c){!1===c instanceof b.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new b.Quaternion);this.applyQuaternion(a.setFromEuler(c));return this}}(),applyAxisAngle:function(){var a;return function(c,d){void 0===a&&(a=new b.Quaternion);this.applyQuaternion(a.setFromAxisAngle(c,d));return this}}(),applyMatrix3:function(a){var c=
this.x,b=this.y,e=this.z;a=a.elements;this.x=a[0]*c+a[3]*b+a[6]*e;this.y=a[1]*c+a[4]*b+a[7]*e;this.z=a[2]*c+a[5]*b+a[8]*e;return this},applyMatrix4:function(a){var c=this.x,b=this.y,e=this.z;a=a.elements;this.x=a[0]*c+a[4]*b+a[8]*e+a[12];this.y=a[1]*c+a[5]*b+a[9]*e+a[13];this.z=a[2]*c+a[6]*b+a[10]*e+a[14];return this},applyProjection:function(a){var c=this.x,b=this.y,e=this.z;a=a.elements;var f=1/(a[3]*c+a[7]*b+a[11]*e+a[15]);this.x=(a[0]*c+a[4]*b+a[8]*e+a[12])*f;this.y=(a[1]*c+a[5]*b+a[9]*e+a[13])*
f;this.z=(a[2]*c+a[6]*b+a[10]*e+a[14])*f;return this},applyQuaternion:function(a){var c=this.x,b=this.y,e=this.z,f=a.x,h=a.y,k=a.z;a=a.w;var s=a*c+h*e-k*b,x=a*b+k*c-f*e,g=a*e+f*b-h*c,c=-f*c-h*b-k*e;this.x=s*a+c*-f+x*-k-g*-h;this.y=x*a+c*-h+g*-f-s*-k;this.z=g*a+c*-k+s*-h-x*-f;return this},project:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.multiplyMatrices(c.projectionMatrix,a.getInverse(c.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function(c){void 0===
a&&(a=new b.Matrix4);a.multiplyMatrices(c.matrixWorld,a.getInverse(c.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var c=this.x,b=this.y,e=this.z;a=a.elements;this.x=a[0]*c+a[4]*b+a[8]*e;this.y=a[1]*c+a[5]*b+a[9]*e;this.z=a[2]*c+a[6]*b+a[10]*e;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,c){this.x=Math.max(a.x,Math.min(c.x,this.x));this.y=Math.max(a.y,Math.min(c.y,this.y));this.z=Math.max(a.z,Math.min(c.z,this.z));return this},clampScalar:function(){var a,c;return function(d,e){void 0===a&&(a=new b.Vector3,c=new b.Vector3);a.set(d,d,d);c.set(e,e,e);return this.clamp(a,c)}}(),clampLength:function(a,c){var b=
this.length();this.multiplyScalar(Math.max(a,Math.min(c,b))/b);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;this.z+=(a.z-this.z)*c;return this},lerpVectors:function(a,c,b){this.subVectors(c,a).multiplyScalar(b).add(a);return this},cross:function(a,c){if(void 0!==c)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,c);var b=this.x,e=this.y,f=this.z;this.x=e*a.z-f*a.y;this.y=f*a.x-b*a.z;this.z=
b*a.y-e*a.x;return this},crossVectors:function(a,c){var b=a.x,e=a.y,f=a.z,h=c.x,k=c.y,s=c.z;this.x=e*s-f*k;this.y=f*h-b*s;this.z=b*k-e*h;return this},projectOnVector:function(){var a,c;return function(d){void 0===a&&(a=new b.Vector3);a.copy(d).normalize();c=this.dot(a);return this.copy(a).multiplyScalar(c)}}(),projectOnPlane:function(){var a;return function(c){void 0===a&&(a=new b.Vector3);a.copy(this).projectOnVector(c);return this.sub(a)}}(),reflect:function(){var a;return function(c){void 0===
a&&(a=new b.Vector3);return this.sub(a.copy(c).multiplyScalar(2*this.dot(c)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(b.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var c=this.x-a.x,b=this.y-a.y;a=this.z-a.z;return c*c+b*b+a*a},setFromSpherical:function(a){var c=Math.sin(a.phi)*a.radius;this.x=c*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=c*Math.cos(a.theta);
return this},setFromMatrixPosition:function(a){return this.setFromMatrixColumn(a,3)},setFromMatrixScale:function(a){var c=this.setFromMatrixColumn(a,0).length(),b=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=c;this.y=b;this.z=a;return this},setFromMatrixColumn:function(a,c){"number"===typeof a&&(console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index )."),c=a=c);return this.fromArray(a.elements,4*c)},equals:function(a){return a.x===this.x&&
a.y===this.y&&a.z===this.z},fromArray:function(a,c){void 0===c&&(c=0);this.x=a[c];this.y=a[c+1];this.z=a[c+2];return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this.x;a[c+1]=this.y;a[c+2]=this.z;return a},fromAttribute:function(a,c,b){void 0===b&&(b=0);c=c*a.itemSize+b;this.x=a.array[c];this.y=a.array[c+1];this.z=a.array[c+2];return this}};b.Vector4=function(a,c,b,e){this.x=a||0;this.y=c||0;this.z=b||0;this.w=void 0!==e?e:1};b.Vector4.prototype={constructor:b.Vector4,set:function(a,
c,b,e){this.x=a;this.y=c;this.z=b;this.w=e;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,c){switch(a){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,c){if(void 0!==c)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,c);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},
addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,c){this.x=a.x+c.x;this.y=a.y+c.y;this.z=a.z+c.z;this.w=a.w+c.w;return this},addScaledVector:function(a,c){this.x+=a.x*c;this.y+=a.y*c;this.z+=a.z*c;this.w+=a.w*c;return this},sub:function(a,c){if(void 0!==c)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,c);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=
a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,c){this.x=a.x-c.x;this.y=a.y-c.y;this.z=a.z-c.z;this.w=a.w-c.w;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a,this.w*=a):this.w=this.z=this.y=this.x=0;return this},applyMatrix4:function(a){var c=this.x,b=this.y,e=this.z,f=this.w;a=a.elements;this.x=a[0]*c+a[4]*b+a[8]*e+a[12]*f;this.y=a[1]*c+a[5]*b+a[9]*e+a[13]*f;this.z=a[2]*c+a[6]*b+a[10]*e+a[14]*f;this.w=a[3]*c+a[7]*b+a[11]*e+a[15]*f;return this},
divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var c=Math.sqrt(1-a.w*a.w);1E-4>c?(this.x=1,this.z=this.y=0):(this.x=a.x/c,this.y=a.y/c,this.z=a.z/c);return this},setAxisAngleFromRotationMatrix:function(a){var c,b,e;a=a.elements;var f=a[0];e=a[4];var h=a[8],k=a[1],s=a[5],x=a[9];b=a[2];c=a[6];var g=a[10];if(.01>Math.abs(e-k)&&.01>Math.abs(h-b)&&.01>Math.abs(x-c)){if(.1>Math.abs(e+k)&&.1>Math.abs(h+b)&&.1>Math.abs(x+c)&&.1>Math.abs(f+
s+g-3))return this.set(1,0,0,0),this;a=Math.PI;f=(f+1)/2;s=(s+1)/2;g=(g+1)/2;e=(e+k)/4;h=(h+b)/4;x=(x+c)/4;f>s&&f>g?.01>f?(c=0,e=b=.707106781):(c=Math.sqrt(f),b=e/c,e=h/c):s>g?.01>s?(c=.707106781,b=0,e=.707106781):(b=Math.sqrt(s),c=e/b,e=x/b):.01>g?(b=c=.707106781,e=0):(e=Math.sqrt(g),c=h/e,b=x/e);this.set(c,b,e,a);return this}a=Math.sqrt((c-x)*(c-x)+(h-b)*(h-b)+(k-e)*(k-e));.001>Math.abs(a)&&(a=1);this.x=(c-x)/a;this.y=(h-b)/a;this.z=(k-e)/a;this.w=Math.acos((f+s+g-1)/2);return this},min:function(a){this.x=
Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,c){this.x=Math.max(a.x,Math.min(c.x,this.x));this.y=Math.max(a.y,Math.min(c.y,this.y));this.z=Math.max(a.z,Math.min(c.z,this.z));this.w=Math.max(a.w,Math.min(c.w,this.w));return this},clampScalar:function(){var a,c;return function(d,
e){void 0===a&&(a=new b.Vector4,c=new b.Vector4);a.set(d,d,d,d);c.set(e,e,e,e);return this.clamp(a,c)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},
roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,c){this.x+=(a.x-this.x)*c;this.y+=(a.y-this.y)*c;this.z+=(a.z-this.z)*c;this.w+=(a.w-this.w)*c;return this},lerpVectors:function(a,c,b){this.subVectors(c,a).multiplyScalar(b).add(a);return this},equals:function(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,c){void 0===c&&(c=0);this.x=a[c];this.y=a[c+1];this.z=a[c+2];this.w=a[c+3];return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this.x;a[c+1]=this.y;a[c+2]=this.z;a[c+3]=this.w;return a},fromAttribute:function(a,c,b){void 0===b&&(b=0);c=c*a.itemSize+b;this.x=a.array[c];this.y=a.array[c+1];this.z=a.array[c+2];this.w=a.array[c+3];return this}};b.Euler=function(a,c,d,e){this._x=a||0;this._y=c||0;this._z=d||
0;this._order=e||b.Euler.DefaultOrder};b.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");b.Euler.DefaultOrder="XYZ";b.Euler.prototype={constructor:b.Euler,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,c,b,e){this._x=a;this._y=c;this._z=
b;this._order=e||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,c,d){var e=b.Math.clamp,f=a.elements;a=f[0];var h=f[4],k=f[8],s=f[1],x=f[5],g=f[9],m=f[2],u=f[6],f=f[10];c=c||this._order;"XYZ"===c?(this._y=Math.asin(e(k,-1,1)),.99999>Math.abs(k)?(this._x=Math.atan2(-g,f),
this._z=Math.atan2(-h,a)):(this._x=Math.atan2(u,x),this._z=0)):"YXZ"===c?(this._x=Math.asin(-e(g,-1,1)),.99999>Math.abs(g)?(this._y=Math.atan2(k,f),this._z=Math.atan2(s,x)):(this._y=Math.atan2(-m,a),this._z=0)):"ZXY"===c?(this._x=Math.asin(e(u,-1,1)),.99999>Math.abs(u)?(this._y=Math.atan2(-m,f),this._z=Math.atan2(-h,x)):(this._y=0,this._z=Math.atan2(s,a))):"ZYX"===c?(this._y=Math.asin(-e(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(u,f),this._z=Math.atan2(s,a)):(this._x=0,this._z=Math.atan2(-h,
x))):"YZX"===c?(this._z=Math.asin(e(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-g,x),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(k,f))):"XZY"===c?(this._z=Math.asin(-e(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(u,x),this._y=Math.atan2(k,a)):(this._x=Math.atan2(-g,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+c);this._order=c;if(!1!==d)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(c,d,e){void 0===
a&&(a=new b.Matrix4);a.makeRotationFromQuaternion(c);this.setFromRotationMatrix(a,d,e);return this}}(),setFromVector3:function(a,c){return this.set(a.x,a.y,a.z,c||this._order)},reorder:function(){var a=new b.Quaternion;return function(c){a.setFromEuler(this);this.setFromQuaternion(a,c)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();
return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);a[c]=this._x;a[c+1]=this._y;a[c+2]=this._z;a[c+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new b.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};b.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
b.Matrix3.prototype={constructor:b.Matrix3,set:function(a,c,b,e,f,h,k,s,x){var g=this.elements;g[0]=a;g[1]=e;g[2]=k;g[3]=c;g[4]=f;g[5]=s;g[6]=b;g[7]=h;g[8]=x;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},
applyToVector3Array:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Vector3);void 0===d&&(d=0);void 0===e&&(e=c.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(c,d),a.applyMatrix3(this),a.toArray(c,d);return c}}(),applyToBuffer:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Vector3);void 0===d&&(d=0);void 0===e&&(e=c.length/c.itemSize);for(var f=0;f<e;f++,d++)a.x=c.getX(d),a.y=c.getY(d),a.z=c.getZ(d),a.applyMatrix3(this),c.setXYZ(a.x,a.y,a.z);return c}}(),multiplyScalar:function(a){var c=
this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=a;c[4]*=a;c[7]*=a;c[2]*=a;c[5]*=a;c[8]*=a;return this},determinant:function(){var a=this.elements,c=a[0],b=a[1],e=a[2],f=a[3],h=a[4],k=a[5],s=a[6],x=a[7],a=a[8];return c*h*a-c*k*x-b*f*a+b*k*s+e*f*x-e*h*s},getInverse:function(a,c){a instanceof b.Matrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var d=a.elements,e=this.elements,f=d[0],h=d[1],k=d[2],s=d[3],x=d[4],g=d[5],m=d[6],u=d[7],d=d[8],l=d*x-g*u,r=g*m-d*s,n=u*s-x*m,
t=f*l+h*r+k*n;if(0===t){if(c)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return this.identity()}e[0]=l;e[1]=k*u-d*h;e[2]=g*h-k*x;e[3]=r;e[4]=d*f-k*m;e[5]=k*s-g*f;e[6]=n;e[7]=h*m-u*f;e[8]=x*f-h*s;return this.multiplyScalar(1/t)},transpose:function(){var a,c=this.elements;a=c[1];c[1]=c[3];c[3]=a;a=c[2];c[2]=c[6];c[6]=a;a=c[5];c[5]=c[7];c[7]=a;return this},flattenToArrayOffset:function(a,
c){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.");return this.toArray(a,c)},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var c=this.elements;a[0]=c[0];a[1]=c[3];a[2]=c[6];a[3]=c[1];a[4]=c[4];a[5]=c[7];a[6]=c[2];a[7]=c[5];a[8]=c[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);var b=this.elements;
a[c]=b[0];a[c+1]=b[1];a[c+2]=b[2];a[c+3]=b[3];a[c+4]=b[4];a[c+5]=b[5];a[c+6]=b[6];a[c+7]=b[7];a[c+8]=b[8];return a}};b.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};b.Matrix4.prototype={constructor:b.Matrix4,set:function(a,c,b,e,f,h,k,s,g,m,p,u,l,r,n,t){var v=this.elements;v[0]=a;v[4]=c;v[8]=b;v[12]=e;v[1]=f;v[5]=h;v[9]=k;v[13]=s;v[2]=g;v[6]=m;
v[10]=p;v[14]=u;v[3]=l;v[7]=r;v[11]=n;v[15]=t;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new b.Matrix4).fromArray(this.elements)},copy:function(a){this.elements.set(a.elements);return this},copyPosition:function(a){var c=this.elements;a=a.elements;c[12]=a[12];c[13]=a[13];c[14]=a[14];return this},extractBasis:function(a,c,b){a.setFromMatrixColumn(this,0);c.setFromMatrixColumn(this,1);b.setFromMatrixColumn(this,2);return this},makeBasis:function(a,
c,b){this.set(a.x,c.x,b.x,0,a.y,c.y,b.y,0,a.z,c.z,b.z,0,0,0,0,1);return this},extractRotation:function(){var a;return function(c){void 0===a&&(a=new b.Vector3);var d=this.elements,e=c.elements,f=1/a.setFromMatrixColumn(c,0).length(),h=1/a.setFromMatrixColumn(c,1).length();c=1/a.setFromMatrixColumn(c,2).length();d[0]=e[0]*f;d[1]=e[1]*f;d[2]=e[2]*f;d[4]=e[4]*h;d[5]=e[5]*h;d[6]=e[6]*h;d[8]=e[8]*c;d[9]=e[9]*c;d[10]=e[10]*c;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof b.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var c=this.elements,d=a.x,e=a.y,f=a.z,h=Math.cos(d),d=Math.sin(d),k=Math.cos(e),e=Math.sin(e),s=Math.cos(f),f=Math.sin(f);if("XYZ"===a.order){a=h*s;var g=h*f,m=d*s,p=d*f;c[0]=k*s;c[4]=-k*f;c[8]=e;c[1]=g+m*e;c[5]=a-p*e;c[9]=-d*k;c[2]=p-a*e;c[6]=m+g*e;c[10]=h*k}else"YXZ"===a.order?(a=k*s,g=k*f,m=e*s,p=e*f,c[0]=a+p*d,c[4]=m*d-g,c[8]=h*e,c[1]=h*f,c[5]=h*s,c[9]=-d,c[2]=g*d-m,c[6]=p+a*d,c[10]=h*k):"ZXY"===a.order?(a=k*s,g=k*f,m=e*s,p=e*f,c[0]=a-p*d,c[4]=-h*f,c[8]=m+g*d,c[1]=g+m*d,c[5]=h*s,c[9]=p-a*d,c[2]=
-h*e,c[6]=d,c[10]=h*k):"ZYX"===a.order?(a=h*s,g=h*f,m=d*s,p=d*f,c[0]=k*s,c[4]=m*e-g,c[8]=a*e+p,c[1]=k*f,c[5]=p*e+a,c[9]=g*e-m,c[2]=-e,c[6]=d*k,c[10]=h*k):"YZX"===a.order?(a=h*k,g=h*e,m=d*k,p=d*e,c[0]=k*s,c[4]=p-a*f,c[8]=m*f+g,c[1]=f,c[5]=h*s,c[9]=-d*s,c[2]=-e*s,c[6]=g*f+m,c[10]=a-p*f):"XZY"===a.order&&(a=h*k,g=h*e,m=d*k,p=d*e,c[0]=k*s,c[4]=-f,c[8]=e*s,c[1]=a*f+p,c[5]=h*s,c[9]=g*f-m,c[2]=m*f-g,c[6]=d*s,c[10]=p*f+a);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this},makeRotationFromQuaternion:function(a){var c=
this.elements,b=a.x,e=a.y,f=a.z,h=a.w,k=b+b,s=e+e,g=f+f;a=b*k;var m=b*s,b=b*g,p=e*s,e=e*g,f=f*g,k=h*k,s=h*s,h=h*g;c[0]=1-(p+f);c[4]=m-h;c[8]=b+s;c[1]=m+h;c[5]=1-(a+f);c[9]=e-k;c[2]=b-s;c[6]=e+k;c[10]=1-(a+p);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this},lookAt:function(){var a,c,d;return function(e,f,h){void 0===a&&(a=new b.Vector3);void 0===c&&(c=new b.Vector3);void 0===d&&(d=new b.Vector3);var k=this.elements;d.subVectors(e,f).normalize();0===d.lengthSq()&&(d.z=1);a.crossVectors(h,
d).normalize();0===a.lengthSq()&&(d.x+=1E-4,a.crossVectors(h,d).normalize());c.crossVectors(d,a);k[0]=a.x;k[4]=c.x;k[8]=d.x;k[1]=a.y;k[5]=c.y;k[9]=d.y;k[2]=a.z;k[6]=c.z;k[10]=d.z;return this}}(),multiply:function(a,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,c)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,c){var b=
a.elements,e=c.elements,f=this.elements,h=b[0],k=b[4],s=b[8],g=b[12],m=b[1],p=b[5],u=b[9],l=b[13],r=b[2],n=b[6],t=b[10],v=b[14],q=b[3],z=b[7],K=b[11],b=b[15],A=e[0],C=e[4],F=e[8],H=e[12],E=e[1],X=e[5],M=e[9],O=e[13],I=e[2],D=e[6],S=e[10],B=e[14],N=e[3],G=e[7],P=e[11],e=e[15];f[0]=h*A+k*E+s*I+g*N;f[4]=h*C+k*X+s*D+g*G;f[8]=h*F+k*M+s*S+g*P;f[12]=h*H+k*O+s*B+g*e;f[1]=m*A+p*E+u*I+l*N;f[5]=m*C+p*X+u*D+l*G;f[9]=m*F+p*M+u*S+l*P;f[13]=m*H+p*O+u*B+l*e;f[2]=r*A+n*E+t*I+v*N;f[6]=r*C+n*X+t*D+v*G;f[10]=r*F+n*M+
t*S+v*P;f[14]=r*H+n*O+t*B+v*e;f[3]=q*A+z*E+K*I+b*N;f[7]=q*C+z*X+K*D+b*G;f[11]=q*F+z*M+K*S+b*P;f[15]=q*H+z*O+K*B+b*e;return this},multiplyToArray:function(a,c,b){var e=this.elements;this.multiplyMatrices(a,c);b[0]=e[0];b[1]=e[1];b[2]=e[2];b[3]=e[3];b[4]=e[4];b[5]=e[5];b[6]=e[6];b[7]=e[7];b[8]=e[8];b[9]=e[9];b[10]=e[10];b[11]=e[11];b[12]=e[12];b[13]=e[13];b[14]=e[14];b[15]=e[15];return this},multiplyScalar:function(a){var c=this.elements;c[0]*=a;c[4]*=a;c[8]*=a;c[12]*=a;c[1]*=a;c[5]*=a;c[9]*=a;c[13]*=
a;c[2]*=a;c[6]*=a;c[10]*=a;c[14]*=a;c[3]*=a;c[7]*=a;c[11]*=a;c[15]*=a;return this},applyToVector3Array:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Vector3);void 0===d&&(d=0);void 0===e&&(e=c.length);for(var f=0;f<e;f+=3,d+=3)a.fromArray(c,d),a.applyMatrix4(this),a.toArray(c,d);return c}}(),applyToBuffer:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Vector3);void 0===d&&(d=0);void 0===e&&(e=c.length/c.itemSize);for(var f=0;f<e;f++,d++)a.x=c.getX(d),a.y=c.getY(d),a.z=
c.getZ(d),a.applyMatrix4(this),c.setXYZ(a.x,a.y,a.z);return c}}(),determinant:function(){var a=this.elements,c=a[0],b=a[4],e=a[8],f=a[12],h=a[1],k=a[5],s=a[9],g=a[13],m=a[2],p=a[6],u=a[10],l=a[14];return a[3]*(+f*s*p-e*g*p-f*k*u+b*g*u+e*k*l-b*s*l)+a[7]*(+c*s*l-c*g*u+f*h*u-e*h*l+e*g*m-f*s*m)+a[11]*(+c*g*p-c*k*l-f*h*p+b*h*l+f*k*m-b*g*m)+a[15]*(-e*k*m-c*s*p+c*k*u+e*h*p-b*h*u+b*s*m)},transpose:function(){var a=this.elements,c;c=a[1];a[1]=a[4];a[4]=c;c=a[2];a[2]=a[8];a[8]=c;c=a[6];a[6]=a[9];a[9]=c;c=a[3];
a[3]=a[12];a[12]=c;c=a[7];a[7]=a[13];a[13]=c;c=a[11];a[11]=a[14];a[14]=c;return this},flattenToArrayOffset:function(a,c){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead.");return this.toArray(a,c)},getPosition:function(){var a;return function(){void 0===a&&(a=new b.Vector3);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setPosition:function(a){var c=
this.elements;c[12]=a.x;c[13]=a.y;c[14]=a.z;return this},getInverse:function(a,c){var b=this.elements,e=a.elements,f=e[0],h=e[1],k=e[2],s=e[3],g=e[4],m=e[5],p=e[6],u=e[7],l=e[8],r=e[9],n=e[10],t=e[11],v=e[12],q=e[13],z=e[14],e=e[15],K=r*z*u-q*n*u+q*p*t-m*z*t-r*p*e+m*n*e,A=v*n*u-l*z*u-v*p*t+g*z*t+l*p*e-g*n*e,C=l*q*u-v*r*u+v*m*t-g*q*t-l*m*e+g*r*e,F=v*r*p-l*q*p-v*m*n+g*q*n+l*m*z-g*r*z,H=f*K+h*A+k*C+s*F;if(0===H){if(c)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");
return this.identity()}b[0]=K;b[1]=q*n*s-r*z*s-q*k*t+h*z*t+r*k*e-h*n*e;b[2]=m*z*s-q*p*s+q*k*u-h*z*u-m*k*e+h*p*e;b[3]=r*p*s-m*n*s-r*k*u+h*n*u+m*k*t-h*p*t;b[4]=A;b[5]=l*z*s-v*n*s+v*k*t-f*z*t-l*k*e+f*n*e;b[6]=v*p*s-g*z*s-v*k*u+f*z*u+g*k*e-f*p*e;b[7]=g*n*s-l*p*s+l*k*u-f*n*u-g*k*t+f*p*t;b[8]=C;b[9]=v*r*s-l*q*s-v*h*t+f*q*t+l*h*e-f*r*e;b[10]=g*q*s-v*m*s+v*h*u-f*q*u-g*h*e+f*m*e;b[11]=l*m*s-g*r*s-l*h*u+f*r*u+g*h*t-f*m*t;b[12]=F;b[13]=l*q*k-v*r*k+v*h*n-f*q*n-l*h*z+f*r*z;b[14]=v*m*k-g*q*k-v*h*p+f*q*p+g*h*z-
f*m*z;b[15]=g*r*k-l*m*k+l*h*p-f*r*p-g*h*n+f*m*n;return this.multiplyScalar(1/H)},scale:function(a){var c=this.elements,b=a.x,e=a.y;a=a.z;c[0]*=b;c[4]*=e;c[8]*=a;c[1]*=b;c[5]*=e;c[9]*=a;c[2]*=b;c[6]*=e;c[10]*=a;c[3]*=b;c[7]*=e;c[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,c,b){this.set(1,0,0,a,0,1,0,c,0,0,1,b,0,0,0,1);return this},
makeRotationX:function(a){var c=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,c,-a,0,0,a,c,0,0,0,0,1);return this},makeRotationY:function(a){var c=Math.cos(a);a=Math.sin(a);this.set(c,0,a,0,0,1,0,0,-a,0,c,0,0,0,0,1);return this},makeRotationZ:function(a){var c=Math.cos(a);a=Math.sin(a);this.set(c,-a,0,0,a,c,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,c){var b=Math.cos(c),e=Math.sin(c),f=1-b,h=a.x,k=a.y,s=a.z,g=f*h,m=f*k;this.set(g*h+b,g*k-e*s,g*s+e*k,0,g*k+e*s,m*k+b,m*s-e*h,0,g*s-
e*k,m*s+e*h,f*s*s+b,0,0,0,0,1);return this},makeScale:function(a,c,b){this.set(a,0,0,0,0,c,0,0,0,0,b,0,0,0,0,1);return this},compose:function(a,c,b){this.makeRotationFromQuaternion(c);this.scale(b);this.setPosition(a);return this},decompose:function(){var a,c;return function(d,e,f){void 0===a&&(a=new b.Vector3);void 0===c&&(c=new b.Matrix4);var h=this.elements,k=a.set(h[0],h[1],h[2]).length(),s=a.set(h[4],h[5],h[6]).length(),g=a.set(h[8],h[9],h[10]).length();0>this.determinant()&&(k=-k);d.x=h[12];
d.y=h[13];d.z=h[14];c.elements.set(this.elements);d=1/k;var h=1/s,m=1/g;c.elements[0]*=d;c.elements[1]*=d;c.elements[2]*=d;c.elements[4]*=h;c.elements[5]*=h;c.elements[6]*=h;c.elements[8]*=m;c.elements[9]*=m;c.elements[10]*=m;e.setFromRotationMatrix(c);f.x=k;f.y=s;f.z=g;return this}}(),makeFrustum:function(a,c,b,e,f,h){var k=this.elements;k[0]=2*f/(c-a);k[4]=0;k[8]=(c+a)/(c-a);k[12]=0;k[1]=0;k[5]=2*f/(e-b);k[9]=(e+b)/(e-b);k[13]=0;k[2]=0;k[6]=0;k[10]=-(h+f)/(h-f);k[14]=-2*h*f/(h-f);k[3]=0;k[7]=0;
k[11]=-1;k[15]=0;return this},makePerspective:function(a,c,d,e){a=d*Math.tan(b.Math.DEG2RAD*a*.5);var f=-a;return this.makeFrustum(f*c,a*c,f,a,d,e)},makeOrthographic:function(a,c,b,e,f,h){var k=this.elements,s=1/(c-a),g=1/(b-e),m=1/(h-f);k[0]=2*s;k[4]=0;k[8]=0;k[12]=-((c+a)*s);k[1]=0;k[5]=2*g;k[9]=0;k[13]=-((b+e)*g);k[2]=0;k[6]=0;k[10]=-2*m;k[14]=-((h+f)*m);k[3]=0;k[7]=0;k[11]=0;k[15]=1;return this},equals:function(a){var c=this.elements;a=a.elements;for(var b=0;16>b;b++)if(c[b]!==a[b])return!1;return!0},
fromArray:function(a){this.elements.set(a);return this},toArray:function(a,c){void 0===a&&(a=[]);void 0===c&&(c=0);var b=this.elements;a[c]=b[0];a[c+1]=b[1];a[c+2]=b[2];a[c+3]=b[3];a[c+4]=b[4];a[c+5]=b[5];a[c+6]=b[6];a[c+7]=b[7];a[c+8]=b[8];a[c+9]=b[9];a[c+10]=b[10];a[c+11]=b[11];a[c+12]=b[12];a[c+13]=b[13];a[c+14]=b[14];a[c+15]=b[15];return a}};b.Ray=function(a,c){this.origin=void 0!==a?a:new b.Vector3;this.direction=void 0!==c?c:new b.Vector3};b.Ray.prototype={constructor:b.Ray,set:function(a,c){this.origin.copy(a);
this.direction.copy(c);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,c){return(c||new b.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize()},recast:function(){var a=new b.Vector3;return function(c){this.origin.copy(this.at(c,a));return this}}(),closestPointToPoint:function(a,c){var d=c||
new b.Vector3;d.subVectors(a,this.origin);var e=d.dot(this.direction);return 0>e?d.copy(this.origin):d.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new b.Vector3;return function(c){var b=a.subVectors(c,this.origin).dot(this.direction);if(0>b)return this.origin.distanceToSquared(c);a.copy(this.direction).multiplyScalar(b).add(this.origin);return a.distanceToSquared(c)}}(),distanceSqToSegment:function(){var a=
new b.Vector3,c=new b.Vector3,d=new b.Vector3;return function(b,f,h,k){a.copy(b).add(f).multiplyScalar(.5);c.copy(f).sub(b).normalize();d.copy(this.origin).sub(a);var s=.5*b.distanceTo(f),g=-this.direction.dot(c),m=d.dot(this.direction),p=-d.dot(c),u=d.lengthSq(),l=Math.abs(1-g*g),r;0<l?(b=g*p-m,f=g*m-p,r=s*l,0<=b?f>=-r?f<=r?(s=1/l,b*=s,f*=s,g=b*(b+g*f+2*m)+f*(g*b+f+2*p)+u):(f=s,b=Math.max(0,-(g*f+m)),g=-b*b+f*(f+2*p)+u):(f=-s,b=Math.max(0,-(g*f+m)),g=-b*b+f*(f+2*p)+u):f<=-r?(b=Math.max(0,-(-g*s+
m)),f=0<b?-s:Math.min(Math.max(-s,-p),s),g=-b*b+f*(f+2*p)+u):f<=r?(b=0,f=Math.min(Math.max(-s,-p),s),g=f*(f+2*p)+u):(b=Math.max(0,-(g*s+m)),f=0<b?s:Math.min(Math.max(-s,-p),s),g=-b*b+f*(f+2*p)+u)):(f=0<g?-s:s,b=Math.max(0,-(g*f+m)),g=-b*b+f*(f+2*p)+u);h&&h.copy(this.direction).multiplyScalar(b).add(this.origin);k&&k.copy(c).multiplyScalar(f).add(a);return g}}(),intersectSphere:function(){var a=new b.Vector3;return function(c,b){a.subVectors(c.center,this.origin);var e=a.dot(this.direction),f=a.dot(a)-
e*e,h=c.radius*c.radius;if(f>h)return null;h=Math.sqrt(h-f);f=e-h;e+=h;return 0>f&&0>e?null:0>f?this.at(e,b):this.at(f,b)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var c=a.normal.dot(this.direction);if(0===c)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/c;return 0<=a?a:null},intersectPlane:function(a,c){var b=this.distanceToPlane(a);return null===b?null:this.at(b,c)},intersectsPlane:function(a){var c=
a.distanceToPoint(this.origin);return 0===c||0>a.normal.dot(this.direction)*c?!0:!1},intersectBox:function(a,c){var b,e,f,h,k;e=1/this.direction.x;h=1/this.direction.y;k=1/this.direction.z;var g=this.origin;0<=e?(b=(a.min.x-g.x)*e,e*=a.max.x-g.x):(b=(a.max.x-g.x)*e,e*=a.min.x-g.x);0<=h?(f=(a.min.y-g.y)*h,h*=a.max.y-g.y):(f=(a.max.y-g.y)*h,h*=a.min.y-g.y);if(b>h||f>e)return null;if(f>b||b!==b)b=f;if(h<e||e!==e)e=h;0<=k?(f=(a.min.z-g.z)*k,k*=a.max.z-g.z):(f=(a.max.z-g.z)*k,k*=a.min.z-g.z);if(b>k||f>
e)return null;if(f>b||b!==b)b=f;if(k<e||e!==e)e=k;return 0>e?null:this.at(0<=b?b:e,c)},intersectsBox:function(){var a=new b.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new b.Vector3,c=new b.Vector3,d=new b.Vector3,e=new b.Vector3;return function(b,h,k,g,m){c.subVectors(h,b);d.subVectors(k,b);e.crossVectors(c,d);h=this.direction.dot(e);if(0<h){if(g)return null;g=1}else if(0>h)g=-1,h=-h;else return null;a.subVectors(this.origin,b);b=g*this.direction.dot(d.crossVectors(a,
d));if(0>b)return null;k=g*this.direction.dot(c.cross(a));if(0>k||b+k>h)return null;b=-g*a.dot(e);return 0>b?null:this.at(b/h,m)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}};b.Box2=function(a,c){this.min=void 0!==a?a:new b.Vector2(Infinity,Infinity);this.max=void 0!==c?c:new b.Vector2(-Infinity,
-Infinity)};b.Box2.prototype={constructor:b.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,d=a.length;b<d;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new b.Vector2;return function(b,d){var e=a.copy(d).multiplyScalar(.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);
return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new b.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new b.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,c){return(c||new b.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?
!1:!0},clampPoint:function(a,c){return(c||new b.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new b.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};
b.Box3=function(a,c){this.min=void 0!==a?a:new b.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==c?c:new b.Vector3(-Infinity,-Infinity,-Infinity)};b.Box3.prototype={constructor:b.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,d=Infinity,e=Infinity,f=-Infinity,h=-Infinity,k=-Infinity,g=0,m=a.length;g<m;g+=3){var y=a[g],p=a[g+1],u=a[g+2];y<b&&(b=y);p<d&&(d=p);u<e&&(e=u);y>f&&(f=y);p>h&&(h=p);u>k&&(k=u)}this.min.set(b,d,e);this.max.set(f,
h,k)},setFromPoints:function(a){this.makeEmpty();for(var b=0,d=a.length;b<d;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new b.Vector3;return function(b,d){var e=a.copy(d).multiplyScalar(.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),setFromObject:function(){var a=new b.Vector3;return function(c){var d=this;c.updateMatrixWorld(!0);this.makeEmpty();c.traverse(function(c){var f=c.geometry;if(void 0!==f)if(f instanceof b.Geometry)for(var h=f.vertices,
f=0,k=h.length;f<k;f++)a.copy(h[f]),a.applyMatrix4(c.matrixWorld),d.expandByPoint(a);else if(f instanceof b.BufferGeometry&&void 0!==f.attributes.position)for(h=f.attributes.position.array,f=0,k=h.length;f<k;f+=3)a.fromArray(h,f),a.applyMatrix4(c.matrixWorld),d.expandByPoint(a)});return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=
this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new b.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new b.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);
return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,c){return(c||new b.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a;return function(c){void 0===a&&(a=new b.Vector3);this.clampPoint(c.center,a);return a.distanceToSquared(c.center)<=c.radius*c.radius}}(),intersectsPlane:function(a){var b,d;0<a.normal.x?(b=a.normal.x*this.min.x,d=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,d=a.normal.x*this.min.x);0<a.normal.y?(b+=a.normal.y*this.min.y,d+=a.normal.y*this.max.y):
(b+=a.normal.y*this.max.y,d+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,d+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,d+=a.normal.z*this.min.z);return b<=a.constant&&d>=a.constant},clampPoint:function(a,c){return(c||new b.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new b.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new b.Vector3;return function(c){c=c||new b.Sphere;
c.center=this.center();c.radius=.5*this.size(a).length();return c}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new b.Vector3,new b.Vector3,new b.Vector3,new b.Vector3,new b.Vector3,new b.Vector3,new b.Vector3,new b.Vector3];return function(b){if(this.isEmpty())return this;a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);
a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);
return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};b.Sphere=function(a,c){this.center=void 0!==a?a:new b.Vector3;this.radius=void 0!==c?c:0};b.Sphere.prototype={constructor:b.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new b.Box3;return function(b,d){var e=this.center;void 0!==d?e.copy(d):a.setFromPoints(b).center(e);for(var f=0,h=0,k=b.length;h<k;h++)f=Math.max(f,e.distanceToSquared(b[h]));this.radius=
Math.sqrt(f);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},
intersectsPlane:function(a){return Math.abs(this.center.dot(a.normal)-a.constant)<=this.radius},clampPoint:function(a,c){var d=this.center.distanceToSquared(a),e=c||new b.Vector3;e.copy(a);d>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(a){a=a||new b.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();
return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}};b.Plane=function(a,c){this.normal=void 0!==a?a:new b.Vector3(1,0,0);this.constant=void 0!==c?c:0};b.Plane.prototype={constructor:b.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,d,e){this.normal.set(a,b,d);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=
-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new b.Vector3,c=new b.Vector3;return function(b,e,f){e=a.subVectors(f,e).cross(c.subVectors(b,e)).normalize();this.setFromNormalAndCoplanarPoint(e,b);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=
-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,c){var d=this.distanceToPoint(a);return(c||new b.Vector3).copy(this.normal).multiplyScalar(d)},intersectLine:function(){var a=new b.Vector3;return function(c,d){var e=d||new b.Vector3,f=c.delta(a),h=this.normal.dot(f);if(0===
h){if(0===this.distanceToPoint(c.start))return e.copy(c.start)}else return h=-(c.start.dot(this.normal)+this.constant)/h,0>h||1<h?void 0:e.copy(f).multiplyScalar(h).add(c.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return(a||new b.Vector3).copy(this.normal).multiplyScalar(-this.constant)},
applyMatrix4:function(){var a=new b.Vector3,c=new b.Matrix3;return function(b,e){var f=this.coplanarPoint(a).applyMatrix4(b),h=e||c.getNormalMatrix(b),h=this.normal.applyMatrix3(h).normalize();this.constant=-f.dot(h);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}};b.Frustum=function(a,c,d,e,f,h){this.planes=[void 0!==a?a:new b.Plane,void 0!==c?c:new b.Plane,void 0!==d?d:new b.Plane,
void 0!==e?e:new b.Plane,void 0!==f?f:new b.Plane,void 0!==h?h:new b.Plane]};b.Frustum.prototype={constructor:b.Frustum,set:function(a,b,d,e,f,h){var k=this.planes;k[0].copy(a);k[1].copy(b);k[2].copy(d);k[3].copy(e);k[4].copy(f);k[5].copy(h);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,d=0;6>d;d++)b[d].copy(a.planes[d]);return this},setFromMatrix:function(a){var b=this.planes,d=a.elements;a=d[0];var e=d[1],f=d[2],h=d[3],k=d[4],g=d[5],
m=d[6],y=d[7],p=d[8],u=d[9],l=d[10],r=d[11],n=d[12],t=d[13],v=d[14],d=d[15];b[0].setComponents(h-a,y-k,r-p,d-n).normalize();b[1].setComponents(h+a,y+k,r+p,d+n).normalize();b[2].setComponents(h+e,y+g,r+u,d+t).normalize();b[3].setComponents(h-e,y-g,r-u,d-t).normalize();b[4].setComponents(h-f,y-m,r-l,d-v).normalize();b[5].setComponents(h+f,y+m,r+l,d+v).normalize();return this},intersectsObject:function(){var a=new b.Sphere;return function(b){var d=b.geometry;null===d.boundingSphere&&d.computeBoundingSphere();
a.copy(d.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,d=a.center;a=-a.radius;for(var e=0;6>e;e++)if(b[e].distanceToPoint(d)<a)return!1;return!0},intersectsBox:function(){var a=new b.Vector3,c=new b.Vector3;return function(b){for(var e=this.planes,f=0;6>f;f++){var h=e[f];a.x=0<h.normal.x?b.min.x:b.max.x;c.x=0<h.normal.x?b.max.x:b.min.x;a.y=0<h.normal.y?b.min.y:b.max.y;c.y=0<h.normal.y?b.max.y:b.min.y;a.z=0<h.normal.z?
b.min.z:b.max.z;c.z=0<h.normal.z?b.max.z:b.min.z;var k=h.distanceToPoint(a),h=h.distanceToPoint(c);if(0>k&&0>h)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,d=0;6>d;d++)if(0>b[d].distanceToPoint(a))return!1;return!0}};b.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),d=0,e;return function(){for(var f=0;36>f;f++)8===f||13===f||18===f||23===f?b[f]="-":14===f?b[f]=
"4":(2>=d&&(d=33554432+16777216*Math.random()|0),e=d&15,d>>=4,b[f]=a[19===f?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,d){return Math.max(b,Math.min(d,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,d,e,f){return e+(a-b)*(f-e)/(d-b)},smoothstep:function(a,b,d){if(a<=b)return 0;if(a>=d)return 1;a=(a-b)/(d-b);return a*a*(3-2*a)},smootherstep:function(a,b,d){if(a<=b)return 0;if(a>=d)return 1;a=(a-b)/(d-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead.");
return Math.random()},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(a){return a*b.Math.DEG2RAD},radToDeg:function(a){return a*b.Math.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;
return a}};b.Triangle=function(a,c,d){this.a=void 0!==a?a:new b.Vector3;this.b=void 0!==c?c:new b.Vector3;this.c=void 0!==d?d:new b.Vector3};b.Triangle.normal=function(){var a=new b.Vector3;return function(c,d,e,f){f=f||new b.Vector3;f.subVectors(e,d);a.subVectors(c,d);f.cross(a);c=f.lengthSq();return 0<c?f.multiplyScalar(1/Math.sqrt(c)):f.set(0,0,0)}}();b.Triangle.barycoordFromPoint=function(){var a=new b.Vector3,c=new b.Vector3,d=new b.Vector3;return function(e,f,h,k,g){a.subVectors(k,f);c.subVectors(h,
f);d.subVectors(e,f);e=a.dot(a);f=a.dot(c);h=a.dot(d);var m=c.dot(c);k=c.dot(d);var y=e*m-f*f;g=g||new b.Vector3;if(0===y)return g.set(-2,-1,-1);y=1/y;m=(m*h-f*k)*y;e=(e*k-f*h)*y;return g.set(1-m-e,e,m)}}();b.Triangle.containsPoint=function(){var a=new b.Vector3;return function(c,d,e,f){c=b.Triangle.barycoordFromPoint(c,d,e,f,a);return 0<=c.x&&0<=c.y&&1>=c.x+c.y}}();b.Triangle.prototype={constructor:b.Triangle,set:function(a,b,d){this.a.copy(a);this.b.copy(b);this.c.copy(d);return this},setFromPointsAndIndices:function(a,
b,d,e){this.a.copy(a[b]);this.b.copy(a[d]);this.c.copy(a[e]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new b.Vector3,c=new b.Vector3;return function(){a.subVectors(this.c,this.b);c.subVectors(this.a,this.b);return.5*a.cross(c).length()}}(),midpoint:function(a){return(a||new b.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return b.Triangle.normal(this.a,
this.b,this.c,a)},plane:function(a){return(a||new b.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,c){return b.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,c)},containsPoint:function(a){return b.Triangle.containsPoint(a,this.a,this.b,this.c)},closestPointToPoint:function(){var a,c,d,e;return function(f,h){void 0===a&&(a=new b.Plane,c=[new b.Line3,new b.Line3,new b.Line3],d=new b.Vector3,e=new b.Vector3);var k=h||new b.Vector3,g=Infinity;a.setFromCoplanarPoints(this.a,
this.b,this.c);a.projectPoint(f,d);if(!0===this.containsPoint(d))k.copy(d);else{c[0].set(this.a,this.b);c[1].set(this.b,this.c);c[2].set(this.c,this.a);for(var m=0;m<c.length;m++){c[m].closestPointToPoint(d,!0,e);var y=d.distanceToSquared(e);y<g&&(g=y,k.copy(e))}}return k}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}};b.EventDispatcher=function(){};b.EventDispatcher.prototype={constructor:b.EventDispatcher,apply:function(a){a.addEventListener=b.EventDispatcher.prototype.addEventListener;
a.hasEventListener=b.EventDispatcher.prototype.hasEventListener;a.removeEventListener=b.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=b.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var d=this._listeners;void 0===d[a]&&(d[a]=[]);-1===d[a].indexOf(b)&&d[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var d=this._listeners;return void 0!==d[a]&&-1!==d[a].indexOf(b)?!0:!1},removeEventListener:function(a,
b){if(void 0!==this._listeners){var d=this._listeners[a];if(void 0!==d){var e=d.indexOf(b);-1!==e&&d.splice(e,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var d=[],e=b.length,f=0;f<e;f++)d[f]=b[f];for(f=0;f<e;f++)d[f].call(this,a)}}}};(function(a){function b(a,c){return a.distance-c.distance}function d(a,b,c,k){if(!1!==a.visible&&(a.raycast(b,c),!0===k)){a=a.children;k=0;for(var g=a.length;k<g;k++)d(a[k],b,c,!0)}}a.Raycaster=
function(b,c,d,k){this.ray=new a.Ray(b,c);this.near=d||0;this.far=k||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};a.Raycaster.prototype={constructor:a.Raycaster,linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),
this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(this.ray.origin).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,f){var h=[];d(a,this,h,f);h.sort(b);return h},intersectObjects:function(a,f){var h=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),
h;for(var k=0,g=a.length;k<g;k++)d(a[k],this,h,f);h.sort(b);return h}}})(b);b.Object3D=function(){Object.defineProperty(this,"id",{value:b.Object3DIdCount++});this.uuid=b.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=b.Object3D.DefaultUp.clone();var a=new b.Vector3,c=new b.Euler,d=new b.Quaternion,e=new b.Vector3(1,1,1);c.onChange(function(){d.setFromEuler(c,!1)});d.onChange(function(){c.setFromQuaternion(d,void 0,!1)});Object.defineProperties(this,
{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:c},quaternion:{enumerable:!0,value:d},scale:{enumerable:!0,value:e},modelViewMatrix:{value:new b.Matrix4},normalMatrix:{value:new b.Matrix3}});this.rotationAutoUpdate=!0;this.matrix=new b.Matrix4;this.matrixWorld=new b.Matrix4;this.matrixAutoUpdate=b.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new b.Layers;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData=
{}};b.Object3D.DefaultUp=new b.Vector3(0,1,0);b.Object3D.DefaultMatrixAutoUpdate=!0;b.Object3D.prototype={constructor:b.Object3D,applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},
rotateOnAxis:function(){var a=new b.Quaternion;return function(b,d){a.setFromAxisAngle(b,d);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new b.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new b.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new b.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new b.Vector3;return function(b,d){a.copy(b).applyQuaternion(this.quaternion);
this.position.add(a.multiplyScalar(d));return this}}(),translateX:function(){var a=new b.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new b.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new b.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new b.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
lookAt:function(){var a=new b.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var c=0;c<arguments.length;c++)this.add(arguments[c]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a instanceof b.Object3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",
a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var d=0,e=this.children.length;d<e;d++){var f=this.children[d].getObjectByProperty(a,
b);if(void 0!==f)return f}},getWorldPosition:function(a){a=a||new b.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new b.Vector3,c=new b.Vector3;return function(d){d=d||new b.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,d,c);return d}}(),getWorldRotation:function(){var a=new b.Quaternion;return function(c){c=c||new b.Euler;this.getWorldQuaternion(a);return c.setFromQuaternion(a,this.rotation.order,!1)}}(),
getWorldScale:function(){var a=new b.Vector3,c=new b.Quaternion;return function(d){d=d||new b.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,d);return d}}(),getWorldDirection:function(){var a=new b.Quaternion;return function(c){c=c||new b.Vector3;this.getWorldQuaternion(a);return c.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,d=0,e=b.length;d<e;d++)b[d].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);
for(var b=this.children,d=0,e=b.length;d<e;d++)b[d].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,
this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,d=this.children.length;b<d;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(a){function b(a){var c=[],d;for(d in a){var e=a[d];delete e.metadata;c.push(e)}return c}var d=void 0===a||""===a,e={};d&&(a={geometries:{},materials:{},textures:{},images:{}},e.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);"{}"!==JSON.stringify(this.userData)&&
(f.userData=this.userData);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);f.matrix=this.matrix.toArray();void 0!==this.geometry&&(void 0===a.geometries[this.geometry.uuid]&&(a.geometries[this.geometry.uuid]=this.geometry.toJSON(a)),f.geometry=this.geometry.uuid);void 0!==this.material&&(void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON(a)),f.material=this.material.uuid);if(0<this.children.length){f.children=
[];for(var h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object)}if(d){var d=b(a.geometries),h=b(a.materials),k=b(a.textures);a=b(a.images);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<a.length&&(e.images=a)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);
this.rotationAutoUpdate=a.rotationAutoUpdate;this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(var d=0;d<a.children.length;d++)this.add(a.children[d].clone());return this}};
b.EventDispatcher.prototype.apply(b.Object3D.prototype);b.Object3DIdCount=0;b.Face3=function(a,c,d,e,f,h){this.a=a;this.b=c;this.c=d;this.normal=e instanceof b.Vector3?e:new b.Vector3;this.vertexNormals=Array.isArray(e)?e:[];this.color=f instanceof b.Color?f:new b.Color;this.vertexColors=Array.isArray(f)?f:[];this.materialIndex=void 0!==h?h:0};b.Face3.prototype={constructor:b.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);
this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,d=a.vertexNormals.length;b<d;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(d=a.vertexColors.length;b<d;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}};b.Layers=function(){this.mask=1};b.Layers.prototype={constructor:b.Layers,set:function(a){this.mask=1<<a},enable:function(a){this.mask|=1<<a},toggle:function(a){this.mask^=1<<a},disable:function(a){this.mask&=~(1<<a)},test:function(a){return 0!==
(this.mask&a.mask)}};b.BufferAttribute=function(a,c,d){this.uuid=b.Math.generateUUID();this.array=a;this.itemSize=c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0;this.normalized=!0===d};b.BufferAttribute.prototype={constructor:b.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.dynamic=
a.dynamic;return this},copyAt:function(a,b,d){a*=this.itemSize;d*=b.itemSize;for(var e=0,f=this.itemSize;e<f;e++)this.array[a+e]=b.array[d+e];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var c=this.array,d=0,e=0,f=a.length;e<f;e++){var h=a[e];void 0===h&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",e),h=new b.Color);c[d++]=h.r;c[d++]=h.g;c[d++]=h.b}return this},copyIndicesArray:function(a){for(var b=this.array,d=0,
e=0,f=a.length;e<f;e++){var h=a[e];b[d++]=h.a;b[d++]=h.b;b[d++]=h.c}return this},copyVector2sArray:function(a){for(var c=this.array,d=0,e=0,f=a.length;e<f;e++){var h=a[e];void 0===h&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",e),h=new b.Vector2);c[d++]=h.x;c[d++]=h.y}return this},copyVector3sArray:function(a){for(var c=this.array,d=0,e=0,f=a.length;e<f;e++){var h=a[e];void 0===h&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",e),
h=new b.Vector3);c[d++]=h.x;c[d++]=h.y;c[d++]=h.z}return this},copyVector4sArray:function(a){for(var c=this.array,d=0,e=0,f=a.length;e<f;e++){var h=a[e];void 0===h&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",e),h=new b.Vector4);c[d++]=h.x;c[d++]=h.y;c[d++]=h.z;c[d++]=h.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},
getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=d;return this},setXYZ:function(a,b,d,e){a*=this.itemSize;this.array[a+0]=
b;this.array[a+1]=d;this.array[a+2]=e;return this},setXYZW:function(a,b,d,e,f){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=d;this.array[a+2]=e;this.array[a+3]=f;return this},clone:function(){return(new this.constructor).copy(this)}};b.Int8Attribute=function(a,c){return new b.BufferAttribute(new Int8Array(a),c)};b.Uint8Attribute=function(a,c){return new b.BufferAttribute(new Uint8Array(a),c)};b.Uint8ClampedAttribute=function(a,c){return new b.BufferAttribute(new Uint8ClampedArray(a),c)};b.Int16Attribute=
function(a,c){return new b.BufferAttribute(new Int16Array(a),c)};b.Uint16Attribute=function(a,c){return new b.BufferAttribute(new Uint16Array(a),c)};b.Int32Attribute=function(a,c){return new b.BufferAttribute(new Int32Array(a),c)};b.Uint32Attribute=function(a,c){return new b.BufferAttribute(new Uint32Array(a),c)};b.Float32Attribute=function(a,c){return new b.BufferAttribute(new Float32Array(a),c)};b.Float64Attribute=function(a,c){return new b.BufferAttribute(new Float64Array(a),c)};b.DynamicBufferAttribute=
function(a,c){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new b.BufferAttribute(a,c)).setDynamic(!0)};b.InstancedBufferAttribute=function(a,c,d){b.BufferAttribute.call(this,a,c);this.meshPerAttribute=d||1};b.InstancedBufferAttribute.prototype=Object.create(b.BufferAttribute.prototype);b.InstancedBufferAttribute.prototype.constructor=b.InstancedBufferAttribute;b.InstancedBufferAttribute.prototype.copy=function(a){b.BufferAttribute.prototype.copy.call(this,
a);this.meshPerAttribute=a.meshPerAttribute;return this};b.Geometry=function(){Object.defineProperty(this,"id",{value:b.GeometryIdCount++});this.uuid=b.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=
this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};b.Geometry.prototype={constructor:b.Geometry,applyMatrix:function(a){for(var c=(new b.Matrix3).getNormalMatrix(a),d=0,e=this.vertices.length;d<e;d++)this.vertices[d].applyMatrix4(a);d=0;for(e=this.faces.length;d<e;d++){a=this.faces[d];a.normal.applyMatrix3(c).normalize();for(var f=0,h=a.vertexNormals.length;f<h;f++)a.vertexNormals[f].applyMatrix3(c).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&
this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.makeRotationX(c);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.makeRotationY(c);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.makeRotationZ(c);this.applyMatrix(a);return this}}(),translate:function(){var a;
return function(c,d,e){void 0===a&&(a=new b.Matrix4);a.makeTranslation(c,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Matrix4);a.makeScale(c,d,e);this.applyMatrix(a);return this}}(),lookAt:function(){var a;return function(c){void 0===a&&(a=new b.Object3D);a.lookAt(c);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function c(a,c,e,f){var h=void 0!==k?[p[a].clone(),p[c].clone(),p[e].clone()]:[],n=void 0!==
g?[d.colors[a].clone(),d.colors[c].clone(),d.colors[e].clone()]:[];f=new b.Face3(a,c,e,h,n,f);d.faces.push(f);void 0!==m&&d.faceVertexUvs[0].push([u[a].clone(),u[c].clone(),u[e].clone()]);void 0!==y&&d.faceVertexUvs[1].push([l[a].clone(),l[c].clone(),l[e].clone()])}var d=this,e=null!==a.index?a.index.array:void 0,f=a.attributes,h=f.position.array,k=void 0!==f.normal?f.normal.array:void 0,g=void 0!==f.color?f.color.array:void 0,m=void 0!==f.uv?f.uv.array:void 0,y=void 0!==f.uv2?f.uv2.array:void 0;
void 0!==y&&(this.faceVertexUvs[1]=[]);for(var p=[],u=[],l=[],r=f=0;f<h.length;f+=3,r+=2)d.vertices.push(new b.Vector3(h[f],h[f+1],h[f+2])),void 0!==k&&p.push(new b.Vector3(k[f],k[f+1],k[f+2])),void 0!==g&&d.colors.push(new b.Color(g[f],g[f+1],g[f+2])),void 0!==m&&u.push(new b.Vector2(m[r],m[r+1])),void 0!==y&&l.push(new b.Vector2(y[r],y[r+1]));if(void 0!==e)if(h=a.groups,0<h.length)for(f=0;f<h.length;f++)for(var n=h[f],t=n.start,v=n.count,r=t,t=t+v;r<t;r+=3)c(e[r],e[r+1],e[r+2],n.materialIndex);
else for(f=0;f<e.length;f+=3)c(e[f],e[f+1],e[f+2]);else for(f=0;f<h.length/3;f+=3)c(f,f+1,f+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,c=this.boundingSphere.radius,
c=0===c?1:1/c,d=new b.Matrix4;d.set(c,0,0,-c*a.x,0,c,0,-c*a.y,0,0,c,-c*a.z,0,0,0,1);this.applyMatrix(d);return this},computeFaceNormals:function(){for(var a=new b.Vector3,c=new b.Vector3,d=0,e=this.faces.length;d<e;d++){var f=this.faces[d],h=this.vertices[f.a],k=this.vertices[f.b];a.subVectors(this.vertices[f.c],k);c.subVectors(h,k);a.cross(c);a.normalize();f.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var c,d,e;e=Array(this.vertices.length);c=0;for(d=this.vertices.length;c<
d;c++)e[c]=new b.Vector3;if(a){var f,h,k,g=new b.Vector3,m=new b.Vector3;a=0;for(c=this.faces.length;a<c;a++)d=this.faces[a],f=this.vertices[d.a],h=this.vertices[d.b],k=this.vertices[d.c],g.subVectors(k,h),m.subVectors(f,h),g.cross(m),e[d.a].add(g),e[d.b].add(g),e[d.c].add(g)}else for(a=0,c=this.faces.length;a<c;a++)d=this.faces[a],e[d.a].add(d.normal),e[d.b].add(d.normal),e[d.c].add(d.normal);c=0;for(d=this.vertices.length;c<d;c++)e[c].normalize();a=0;for(c=this.faces.length;a<c;a++)d=this.faces[a],
f=d.vertexNormals,3===f.length?(f[0].copy(e[d.a]),f[1].copy(e[d.b]),f[2].copy(e[d.c])):(f[0]=e[d.a].clone(),f[1]=e[d.b].clone(),f[2]=e[d.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,c,d,e,f;d=0;for(e=this.faces.length;d<e;d++)for(f=this.faces[d],f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=f.normal.clone(),f.__originalVertexNormals||(f.__originalVertexNormals=[]),a=0,c=f.vertexNormals.length;a<c;a++)f.__originalVertexNormals[a]?
f.__originalVertexNormals[a].copy(f.vertexNormals[a]):f.__originalVertexNormals[a]=f.vertexNormals[a].clone();var h=new b.Geometry;h.faces=this.faces;a=0;for(c=this.morphTargets.length;a<c;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];f=this.morphNormals[a].faceNormals;var k=this.morphNormals[a].vertexNormals,g,m;d=0;for(e=this.faces.length;d<e;d++)g=new b.Vector3,m={a:new b.Vector3,b:new b.Vector3,c:new b.Vector3},
f.push(g),k.push(m)}k=this.morphNormals[a];h.vertices=this.morphTargets[a].vertices;h.computeFaceNormals();h.computeVertexNormals();d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],g=k.faceNormals[d],m=k.vertexNormals[d],g.copy(f.normal),m.a.copy(f.vertexNormals[0]),m.b.copy(f.vertexNormals[1]),m.c.copy(f.vertexNormals[2])}d=0;for(e=this.faces.length;d<e;d++)f=this.faces[d],f.normal=f.__originalFaceNormal,f.vertexNormals=f.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},
computeLineDistances:function(){for(var a=0,b=this.vertices,d=0,e=b.length;d<e;d++)0<d&&(a+=b[d].distanceTo(b[d-1])),this.lineDistances[d]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new b.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new b.Sphere);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,c,d){if(!1===a instanceof b.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",
a);else{var e,f=this.vertices.length,h=this.vertices,k=a.vertices,g=this.faces,m=a.faces,y=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===d&&(d=0);void 0!==c&&(e=(new b.Matrix3).getNormalMatrix(c));for(var p=0,u=k.length;p<u;p++){var l=k[p].clone();void 0!==c&&l.applyMatrix4(c);h.push(l)}p=0;for(u=m.length;p<u;p++){var k=m[p],r,n=k.vertexNormals,t=k.vertexColors,l=new b.Face3(k.a+f,k.b+f,k.c+f);l.normal.copy(k.normal);void 0!==e&&l.normal.applyMatrix3(e).normalize();c=0;for(h=n.length;c<h;c++)r=
n[c].clone(),void 0!==e&&r.applyMatrix3(e).normalize(),l.vertexNormals.push(r);l.color.copy(k.color);c=0;for(h=t.length;c<h;c++)r=t[c],l.vertexColors.push(r.clone());l.materialIndex=k.materialIndex+d;g.push(l)}p=0;for(u=a.length;p<u;p++)if(d=a[p],e=[],void 0!==d){c=0;for(h=d.length;c<h;c++)e.push(d[c].clone());y.push(e)}}},mergeMesh:function(a){!1===a instanceof b.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,
a.matrix))},mergeVertices:function(){var a={},b=[],d=[],e,f=Math.pow(10,4),h,k;h=0;for(k=this.vertices.length;h<k;h++)e=this.vertices[h],e=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f),void 0===a[e]?(a[e]=h,b.push(this.vertices[h]),d[h]=b.length-1):d[h]=d[a[e]];a=[];h=0;for(k=this.faces.length;h<k;h++)for(f=this.faces[h],f.a=d[f.a],f.b=d[f.b],f.c=d[f.c],f=[f.a,f.b,f.c],e=0;3>e;e++)if(f[e]===f[(e+1)%3]){a.push(h);break}for(h=a.length-1;0<=h;h--)for(f=a[h],this.faces.splice(f,1),d=0,
k=this.faceVertexUvs.length;d<k;d++)this.faceVertexUvs[d].splice(f,1);h=this.vertices.length-b.length;this.vertices=b;return h},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,d=0;d<b;d++)a[d]._id=d;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var e=this.faceVertexUvs[0],f=this.faceVertexUvs[1],h,k;e&&e.length===b&&(h=[]);f&&f.length===b&&(k=[]);for(d=0;d<b;d++){var g=a[d]._id;h&&h.push(e[g]);k&&k.push(f[g])}h&&(this.faceVertexUvs[0]=h);k&&(this.faceVertexUvs[1]=
k)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var c=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==y[c])return y[c];y[c]=m.length/3;m.push(a.x,a.y,a.z);return y[c]}function d(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==u[b])return u[b];u[b]=p.length;p.push(a.getHex());return u[b]}function e(a){var b=a.x.toString()+a.y.toString();if(void 0!==r[b])return r[b];r[b]=l.length/2;l.push(a.x,a.y);return r[b]}var f={metadata:{version:4.4,type:"Geometry",
generator:"Geometry.toJSON"}};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);if(void 0!==this.parameters){var h=this.parameters,k;for(k in h)void 0!==h[k]&&(f[k]=h[k]);return f}h=[];for(k=0;k<this.vertices.length;k++){var g=this.vertices[k];h.push(g.x,g.y,g.z)}var g=[],m=[],y={},p=[],u={},l=[],r={};for(k=0;k<this.faces.length;k++){var n=this.faces[k],t=void 0!==this.faceVertexUvs[0][k],v=0<n.normal.length(),q=0<n.vertexNormals.length,z=1!==n.color.r||1!==n.color.g||1!==n.color.b,
K=0<n.vertexColors.length,A=0,A=a(A,0,0),A=a(A,1,!0),A=a(A,2,!1),A=a(A,3,t),A=a(A,4,v),A=a(A,5,q),A=a(A,6,z),A=a(A,7,K);g.push(A);g.push(n.a,n.b,n.c);g.push(n.materialIndex);t&&(t=this.faceVertexUvs[0][k],g.push(e(t[0]),e(t[1]),e(t[2])));v&&g.push(b(n.normal));q&&(v=n.vertexNormals,g.push(b(v[0]),b(v[1]),b(v[2])));z&&g.push(d(n.color));K&&(n=n.vertexColors,g.push(d(n[0]),d(n[1]),d(n[2])))}f.data={};f.data.vertices=h;f.data.normals=m;0<p.length&&(f.data.colors=p);0<l.length&&(f.data.uvs=[l]);f.data.faces=
g;return f},clone:function(){return(new b.Geometry).copy(this)},copy:function(a){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];for(var b=a.vertices,d=0,e=b.length;d<e;d++)this.vertices.push(b[d].clone());b=a.faces;d=0;for(e=b.length;d<e;d++)this.faces.push(b[d].clone());d=0;for(e=a.faceVertexUvs.length;d<e;d++){b=a.faceVertexUvs[d];void 0===this.faceVertexUvs[d]&&(this.faceVertexUvs[d]=[]);for(var f=0,h=b.length;f<h;f++){for(var k=b[f],g=[],m=0,y=k.length;m<y;m++)g.push(k[m].clone());this.faceVertexUvs[d].push(g)}}return this},
dispose:function(){this.dispatchEvent({type:"dispose"})}};b.EventDispatcher.prototype.apply(b.Geometry.prototype);b.GeometryIdCount=0;b.DirectGeometry=function(){Object.defineProperty(this,"id",{value:b.GeometryIdCount++});this.uuid=b.Math.generateUUID();this.name="";this.type="DirectGeometry";this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;
this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1};b.DirectGeometry.prototype={constructor:b.DirectGeometry,computeBoundingBox:b.Geometry.prototype.computeBoundingBox,computeBoundingSphere:b.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},
computeGroups:function(a){var b,d=[],e;a=a.faces;for(var f=0;f<a.length;f++){var h=a[f];h.materialIndex!==e&&(e=h.materialIndex,void 0!==b&&(b.count=3*f-b.start,d.push(b)),b={start:3*f,materialIndex:e})}void 0!==b&&(b.count=3*f-b.start,d.push(b));this.groups=d},fromGeometry:function(a){var c=a.faces,d=a.vertices,e=a.faceVertexUvs,f=e[0]&&0<e[0].length,h=e[1]&&0<e[1].length,k=a.morphTargets,g=k.length,m;if(0<g){m=[];for(var y=0;y<g;y++)m[y]=[];this.morphTargets.position=m}var p=a.morphNormals,u=p.length,
l;if(0<u){l=[];for(y=0;y<u;y++)l[y]=[];this.morphTargets.normal=l}for(var r=a.skinIndices,n=a.skinWeights,t=r.length===d.length,v=n.length===d.length,y=0;y<c.length;y++){var q=c[y];this.vertices.push(d[q.a],d[q.b],d[q.c]);var z=q.vertexNormals;3===z.length?this.normals.push(z[0],z[1],z[2]):(z=q.normal,this.normals.push(z,z,z));z=q.vertexColors;3===z.length?this.colors.push(z[0],z[1],z[2]):(z=q.color,this.colors.push(z,z,z));!0===f&&(z=e[0][y],void 0!==z?this.uvs.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",
y),this.uvs.push(new b.Vector2,new b.Vector2,new b.Vector2)));!0===h&&(z=e[1][y],void 0!==z?this.uvs2.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",y),this.uvs2.push(new b.Vector2,new b.Vector2,new b.Vector2)));for(z=0;z<g;z++){var K=k[z].vertices;m[z].push(K[q.a],K[q.b],K[q.c])}for(z=0;z<u;z++)K=p[z].vertexNormals[y],l[z].push(K.a,K.b,K.c);t&&this.skinIndices.push(r[q.a],r[q.b],r[q.c]);v&&this.skinWeights.push(n[q.a],n[q.b],n[q.c])}this.computeGroups(a);
this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};b.EventDispatcher.prototype.apply(b.DirectGeometry.prototype);b.BufferGeometry=function(){Object.defineProperty(this,"id",{value:b.GeometryIdCount++});this.uuid=b.Math.generateUUID();this.name="";this.type="BufferGeometry";this.index=
null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}};b.BufferGeometry.prototype={constructor:b.BufferGeometry,getIndex:function(){return this.index},setIndex:function(a){this.index=a},addAttribute:function(a,c,d){if(!1===c instanceof b.BufferAttribute&&!1===c instanceof b.InterleavedBufferAttribute)console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new b.BufferAttribute(c,
d));else if("index"===a)console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(c);else return this.attributes[a]=c,this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,d){this.groups.push({start:a,count:b,materialIndex:void 0!==d?d:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var c=
this.attributes.position;void 0!==c&&(a.applyToVector3Array(c.array),c.needsUpdate=!0);c=this.attributes.normal;void 0!==c&&((new b.Matrix3).getNormalMatrix(a).applyToVector3Array(c.array),c.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.makeRotationX(c);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(c){void 0===
a&&(a=new b.Matrix4);a.makeRotationY(c);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(c){void 0===a&&(a=new b.Matrix4);a.makeRotationZ(c);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Matrix4);a.makeTranslation(c,d,e);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(c,d,e){void 0===a&&(a=new b.Matrix4);a.makeScale(c,d,e);this.applyMatrix(a);return this}}(),lookAt:function(){var a;
return function(c){void 0===a&&(a=new b.Object3D);a.lookAt(c);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},setFromObject:function(a){var c=a.geometry;if(a instanceof b.Points||a instanceof b.Line){a=new b.Float32Attribute(3*c.vertices.length,3);var d=new b.Float32Attribute(3*c.colors.length,3);this.addAttribute("position",a.copyVector3sArray(c.vertices));this.addAttribute("color",
d.copyColorsArray(c.colors));c.lineDistances&&c.lineDistances.length===c.vertices.length&&(a=new b.Float32Attribute(c.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(c.lineDistances)));null!==c.boundingSphere&&(this.boundingSphere=c.boundingSphere.clone());null!==c.boundingBox&&(this.boundingBox=c.boundingBox.clone())}else a instanceof b.Mesh&&c instanceof b.Geometry&&this.fromGeometry(c);return this},updateFromObject:function(a){var c=a.geometry;if(a instanceof b.Mesh){var d=
c.__directGeometry;if(void 0===d)return this.fromGeometry(c);d.verticesNeedUpdate=c.verticesNeedUpdate;d.normalsNeedUpdate=c.normalsNeedUpdate;d.colorsNeedUpdate=c.colorsNeedUpdate;d.uvsNeedUpdate=c.uvsNeedUpdate;d.groupsNeedUpdate=c.groupsNeedUpdate;c.verticesNeedUpdate=!1;c.normalsNeedUpdate=!1;c.colorsNeedUpdate=!1;c.uvsNeedUpdate=!1;c.groupsNeedUpdate=!1;c=d}!0===c.verticesNeedUpdate&&(d=this.attributes.position,void 0!==d&&(d.copyVector3sArray(c.vertices),d.needsUpdate=!0),c.verticesNeedUpdate=
!1);!0===c.normalsNeedUpdate&&(d=this.attributes.normal,void 0!==d&&(d.copyVector3sArray(c.normals),d.needsUpdate=!0),c.normalsNeedUpdate=!1);!0===c.colorsNeedUpdate&&(d=this.attributes.color,void 0!==d&&(d.copyColorsArray(c.colors),d.needsUpdate=!0),c.colorsNeedUpdate=!1);c.uvsNeedUpdate&&(d=this.attributes.uv,void 0!==d&&(d.copyVector2sArray(c.uvs),d.needsUpdate=!0),c.uvsNeedUpdate=!1);c.lineDistancesNeedUpdate&&(d=this.attributes.lineDistance,void 0!==d&&(d.copyArray(c.lineDistances),d.needsUpdate=
!0),c.lineDistancesNeedUpdate=!1);c.groupsNeedUpdate&&(c.computeGroups(a.geometry),this.groups=c.groups,c.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new b.DirectGeometry).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var c=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new b.BufferAttribute(c,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(c=new Float32Array(3*a.normals.length),this.addAttribute("normal",
(new b.BufferAttribute(c,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(c=new Float32Array(3*a.colors.length),this.addAttribute("color",(new b.BufferAttribute(c,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(c=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new b.BufferAttribute(c,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(c=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new b.BufferAttribute(c,2)).copyVector2sArray(a.uvs2)));0<a.indices.length&&(c=new (65535<
a.vertices.length?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex((new b.BufferAttribute(c,1)).copyIndicesArray(a.indices)));this.groups=a.groups;for(var d in a.morphTargets){for(var c=[],e=a.morphTargets[d],f=0,h=e.length;f<h;f++){var k=e[f],g=new b.Float32Attribute(3*k.length,3);c.push(g.copyVector3sArray(k))}this.morphAttributes[d]=c}0<a.skinIndices.length&&(d=new b.Float32Attribute(4*a.skinIndices.length,4),this.addAttribute("skinIndex",d.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&
(d=new b.Float32Attribute(4*a.skinWeights.length,4),this.addAttribute("skinWeight",d.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new b.Box3);var a=this.attributes.position.array;void 0!==a?this.boundingBox.setFromArray(a):this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||
isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new b.Box3,c=new b.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new b.Sphere);var d=this.attributes.position.array;if(d){var e=this.boundingSphere.center;a.setFromArray(d);a.center(e);for(var f=0,h=0,k=d.length;h<k;h+=3)c.fromArray(d,h),f=Math.max(f,
e.distanceToSquared(c));this.boundingSphere.radius=Math.sqrt(f);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,c=this.attributes,d=this.groups;if(c.position){var e=c.position.array;if(void 0===c.normal)this.addAttribute("normal",new b.BufferAttribute(new Float32Array(e.length),3));
else for(var f=c.normal.array,h=0,k=f.length;h<k;h++)f[h]=0;var f=c.normal.array,g,m,y,p=new b.Vector3,u=new b.Vector3,l=new b.Vector3,r=new b.Vector3,n=new b.Vector3;if(a){a=a.array;0===d.length&&this.addGroup(0,a.length);for(var t=0,v=d.length;t<v;++t)for(h=d[t],k=h.start,g=h.count,h=k,k+=g;h<k;h+=3)g=3*a[h+0],m=3*a[h+1],y=3*a[h+2],p.fromArray(e,g),u.fromArray(e,m),l.fromArray(e,y),r.subVectors(l,u),n.subVectors(p,u),r.cross(n),f[g]+=r.x,f[g+1]+=r.y,f[g+2]+=r.z,f[m]+=r.x,f[m+1]+=r.y,f[m+2]+=r.z,
f[y]+=r.x,f[y+1]+=r.y,f[y+2]+=r.z}else for(h=0,k=e.length;h<k;h+=9)p.fromArray(e,h),u.fromArray(e,h+3),l.fromArray(e,h+6),r.subVectors(l,u),n.subVectors(p,u),r.cross(n),f[h]=r.x,f[h+1]=r.y,f[h+2]=r.z,f[h+3]=r.x,f[h+4]=r.y,f[h+5]=r.z,f[h+6]=r.x,f[h+7]=r.y,f[h+8]=r.z;this.normalizeNormals();c.normal.needsUpdate=!0}},merge:function(a,c){if(!1===a instanceof b.BufferGeometry)console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);else{void 0===c&&(c=0);var d=
this.attributes,e;for(e in d)if(void 0!==a.attributes[e])for(var f=d[e].array,h=a.attributes[e],k=h.array,g=0,h=h.itemSize*c;g<k.length;g++,h++)f[h]=k[g];return this}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,d,e,f=0,h=a.length;f<h;f+=3)b=a[f],d=a[f+1],e=a[f+2],b=1/Math.sqrt(b*b+d*d+e*e),a[f]*=b,a[f+1]*=b,a[f+2]*=b},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new b.BufferGeometry,
c=this.index.array,d=this.attributes,e;for(e in d){for(var f=d[e],h=f.array,f=f.itemSize,k=new h.constructor(c.length*f),g=0,m=0,y=0,p=c.length;y<p;y++)for(var g=c[y]*f,u=0;u<f;u++)k[m++]=h[g++];a.addAttribute(e,new b.BufferAttribute(k,f))}return a},toJSON:function(){var a={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);if(void 0!==this.parameters){var b=this.parameters,d;for(d in b)void 0!==b[d]&&
(a[d]=b[d]);return a}a.data={attributes:{}};var e=this.index;null!==e&&(b=Array.prototype.slice.call(e.array),a.data.index={type:e.array.constructor.name,array:b});e=this.attributes;for(d in e){var f=e[d],b=Array.prototype.slice.call(f.array);a.data.attributes[d]={itemSize:f.itemSize,type:f.array.constructor.name,array:b,normalized:f.normalized}}d=this.groups;0<d.length&&(a.data.groups=JSON.parse(JSON.stringify(d)));d=this.boundingSphere;null!==d&&(a.data.boundingSphere={center:d.center.toArray(),
radius:d.radius});return a},clone:function(){return(new b.BufferGeometry).copy(this)},copy:function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,d;for(d in b)this.addAttribute(d,b[d].clone());a=a.groups;d=0;for(b=a.length;d<b;d++){var e=a[d];this.addGroup(e.start,e.count,e.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};b.EventDispatcher.prototype.apply(b.BufferGeometry.prototype);b.BufferGeometry.MaxIndex=65535;b.InstancedBufferGeometry=
function(){b.BufferGeometry.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0};b.InstancedBufferGeometry.prototype=Object.create(b.BufferGeometry.prototype);b.InstancedBufferGeometry.prototype.constructor=b.InstancedBufferGeometry;b.InstancedBufferGeometry.prototype.addGroup=function(a,b,d){this.groups.push({start:a,count:b,instances:d})};b.InstancedBufferGeometry.prototype.copy=function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,d;for(d in b)this.addAttribute(d,
b[d].clone());a=a.groups;d=0;for(b=a.length;d<b;d++){var e=a[d];this.addGroup(e.start,e.count,e.instances)}return this};b.EventDispatcher.prototype.apply(b.InstancedBufferGeometry.prototype);b.InterleavedBufferAttribute=function(a,c,d){this.uuid=b.Math.generateUUID();this.data=a;this.itemSize=c;this.offset=d};b.InterleavedBufferAttribute.prototype={constructor:b.InterleavedBufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},
get count(){return this.data.count},setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+
this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=d;return this},setXYZ:function(a,b,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=d;this.data.array[a+2]=e;return this},setXYZW:function(a,b,d,e,f){a=a*this.data.stride+this.offset;this.data.array[a+0]=
b;this.data.array[a+1]=d;this.data.array[a+2]=e;this.data.array[a+3]=f;return this}};b.Camera=function(){b.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new b.Matrix4;this.projectionMatrix=new b.Matrix4};b.Camera.prototype=Object.create(b.Object3D.prototype);b.Camera.prototype.constructor=b.Camera;b.Camera.prototype.getWorldDirection=function(){var a=new b.Quaternion;return function(c){c=c||new b.Vector3;this.getWorldQuaternion(a);return c.set(0,0,-1).applyQuaternion(a)}}();b.Camera.prototype.lookAt=
function(){var a=new b.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();b.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};b.Camera.prototype.copy=function(a){b.Object3D.prototype.copy.call(this,a);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this};b.PerspectiveCamera=function(a,c,d,e){b.Camera.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:
50;this.zoom=1;this.near=void 0!==d?d:.1;this.far=void 0!==e?e:2E3;this.focus=10;this.aspect=void 0!==c?c:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()};b.PerspectiveCamera.prototype=Object.create(b.Camera.prototype);b.PerspectiveCamera.prototype.constructor=b.PerspectiveCamera;b.PerspectiveCamera.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==
b&&(this.filmGauge=b);this.setFocalLength(a)};b.PerspectiveCamera.prototype.setFocalLength=function(a){a=.5*this.getFilmHeight()/a;this.fov=2*b.Math.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()};b.PerspectiveCamera.prototype.getFocalLength=function(){var a=Math.tan(.5*b.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a};b.PerspectiveCamera.prototype.getEffectiveFOV=function(){return 2*b.Math.RAD2DEG*Math.atan(Math.tan(.5*b.Math.DEG2RAD*this.fov)/this.zoom)};b.PerspectiveCamera.prototype.getFilmWidth=
function(){return this.filmGauge*Math.min(this.aspect,1)};b.PerspectiveCamera.prototype.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)};b.PerspectiveCamera.prototype.setViewOffset=function(a,b,d,e,f,h){this.aspect=a/b;this.view={fullWidth:a,fullHeight:b,offsetX:d,offsetY:e,width:f,height:h};this.updateProjectionMatrix()};b.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=this.near,c=a*Math.tan(.5*b.Math.DEG2RAD*this.fov)/this.zoom,d=2*c,e=this.aspect*d,f=
-.5*e,h=this.view;if(null!==h)var k=h.fullWidth,g=h.fullHeight,f=f+h.offsetX*e/k,c=c-h.offsetY*d/g,e=h.width/k*e,d=h.height/g*d;h=this.filmOffset;0!==h&&(f+=a*h/this.getFilmWidth());this.projectionMatrix.makeFrustum(f,f+e,c-d,c,a,this.far)};b.PerspectiveCamera.prototype.copy=function(a){b.Camera.prototype.copy.call(this,a);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;
this.filmOffset=a.filmOffset;return this};b.PerspectiveCamera.prototype.toJSON=function(a){a=b.Object3D.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a};b.Light=function(a,c){b.Object3D.call(this);this.type="Light";this.color=new b.Color(a);
this.intensity=void 0!==c?c:1;this.receiveShadow=void 0};b.Light.prototype=Object.create(b.Object3D.prototype);b.Light.prototype.constructor=b.Light;b.Light.prototype.copy=function(a){b.Object3D.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this};b.Light.prototype.toJSON=function(a){a=b.Object3D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());
void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);return a};b.AmbientLight=function(a,c){b.Light.call(this,a,c);this.type="AmbientLight";this.castShadow=void 0};b.AmbientLight.prototype=Object.create(b.Light.prototype);b.AmbientLight.prototype.constructor=b.AmbientLight;b.PointLight=function(a,c,d,e){b.Light.call(this,a,c);this.type="PointLight";
this.distance=void 0!==d?d:0;this.decay=void 0!==e?e:1;this.shadow=new b.LightShadow(new b.PerspectiveCamera(90,1,.5,500))};b.PointLight.prototype=Object.create(b.Light.prototype);b.PointLight.prototype.constructor=b.PointLight;Object.defineProperty(b.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});b.PointLight.prototype.copy=function(a){b.Light.prototype.copy.call(this,a);this.distance=a.distance;this.decay=a.decay;this.shadow=
a.shadow.clone();return this};b.DirectionalLight=function(a,c){b.Light.call(this,a,c);this.type="DirectionalLight";this.position.set(0,1,0);this.updateMatrix();this.target=new b.Object3D;this.shadow=new b.DirectionalLightShadow};b.DirectionalLight.prototype=Object.create(b.Light.prototype);b.DirectionalLight.prototype.constructor=b.DirectionalLight;b.DirectionalLight.prototype.copy=function(a){b.Light.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this};
b.LightShadow=function(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new b.Vector2(512,512);this.map=null;this.matrix=new b.Matrix4};b.LightShadow.prototype={constructor:b.LightShadow,copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)}};b.SpotLight=function(a,c,d,e,f,h){b.Light.call(this,a,c);this.type="SpotLight";this.position.set(0,1,0);this.updateMatrix();
this.target=new b.Object3D;this.distance=void 0!==d?d:0;this.angle=void 0!==e?e:Math.PI/3;this.penumbra=void 0!==f?f:0;this.decay=void 0!==h?h:1;this.shadow=new b.SpotLightShadow};b.SpotLight.prototype=Object.create(b.Light.prototype);b.SpotLight.prototype.constructor=b.SpotLight;Object.defineProperty(b.SpotLight.prototype,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});b.SpotLight.prototype.copy=function(a){b.Light.prototype.copy.call(this,a);this.distance=
a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this};b.Material=function(){Object.defineProperty(this,"id",{value:b.MaterialIdCount++});this.uuid=b.Math.generateUUID();this.name="";this.type="Material";this.side=b.FrontSide;this.opacity=1;this.transparent=!1;this.blending=b.NormalBlending;this.blendSrc=b.SrcAlphaFactor;this.blendDst=b.OneMinusSrcAlphaFactor;this.blendEquation=b.AddEquation;this.blendEquationAlpha=
this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=b.LessEqualDepth;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=!1;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.premultipliedAlpha=!1;this.overdraw=0;this._needsUpdate=this.visible=!0};b.Material.prototype={constructor:b.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=
a},setValues:function(a){if(void 0!==a)for(var c in a){var d=a[c];if(void 0===d)console.warn("THREE.Material: '"+c+"' parameter is undefined.");else{var e=this[c];void 0===e?console.warn("THREE."+this.type+": '"+c+"' is not a property of this material."):e instanceof b.Color?e.set(d):e instanceof b.Vector3&&d instanceof b.Vector3?e.copy(d):this[c]="overdraw"===c?Number(d):d}}},toJSON:function(a){function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a;
d&&(a={textures:{},images:{}});var e={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);this.color instanceof b.Color&&(e.color=this.color.getHex());.5!==this.roughness&&(e.roughness=this.roughness);.5!==this.metalness&&(e.metalness=this.metalness);this.emissive instanceof b.Color&&(e.emissive=this.emissive.getHex());this.specular instanceof b.Color&&(e.specular=this.specular.getHex());void 0!==this.shininess&&
(e.shininess=this.shininess);this.map instanceof b.Texture&&(e.map=this.map.toJSON(a).uuid);this.alphaMap instanceof b.Texture&&(e.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap instanceof b.Texture&&(e.lightMap=this.lightMap.toJSON(a).uuid);this.bumpMap instanceof b.Texture&&(e.bumpMap=this.bumpMap.toJSON(a).uuid,e.bumpScale=this.bumpScale);this.normalMap instanceof b.Texture&&(e.normalMap=this.normalMap.toJSON(a).uuid,e.normalScale=this.normalScale.toArray());this.displacementMap instanceof
b.Texture&&(e.displacementMap=this.displacementMap.toJSON(a).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias);this.roughnessMap instanceof b.Texture&&(e.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap instanceof b.Texture&&(e.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap instanceof b.Texture&&(e.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap instanceof b.Texture&&(e.specularMap=this.specularMap.toJSON(a).uuid);
this.envMap instanceof b.Texture&&(e.envMap=this.envMap.toJSON(a).uuid,e.reflectivity=this.reflectivity);void 0!==this.size&&(e.size=this.size);void 0!==this.sizeAttenuation&&(e.sizeAttenuation=this.sizeAttenuation);void 0!==this.vertexColors&&this.vertexColors!==b.NoColors&&(e.vertexColors=this.vertexColors);void 0!==this.shading&&this.shading!==b.SmoothShading&&(e.shading=this.shading);void 0!==this.blending&&this.blending!==b.NormalBlending&&(e.blending=this.blending);void 0!==this.side&&this.side!==
b.FrontSide&&(e.side=this.side);1>this.opacity&&(e.opacity=this.opacity);!0===this.transparent&&(e.transparent=this.transparent);0<this.alphaTest&&(e.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(e.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(e.wireframe=this.wireframe);1<this.wireframeLinewidth&&(e.wireframeLinewidth=this.wireframeLinewidth);d&&(d=c(a.textures),a=c(a.images),0<d.length&&(e.textures=d),0<a.length&&(e.images=a));return e},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.name=a.name;this.side=a.side;this.opacity=a.opacity;this.transparent=a.transparent;this.blending=a.blending;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;
this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.clipShadows=a.clipShadows;a=a.clippingPlanes;var b=null;if(null!==a)for(var d=a.length,b=Array(d),e=0;e!==d;++e)b[e]=a[e].clone();this.clippingPlanes=b;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};b.EventDispatcher.prototype.apply(b.Material.prototype);
b.MaterialIdCount=0;b.LineBasicMaterial=function(a){b.Material.call(this);this.type="LineBasicMaterial";this.color=new b.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.blending=b.NormalBlending;this.vertexColors=b.NoColors;this.fog=!0;this.setValues(a)};b.LineBasicMaterial.prototype=Object.create(b.Material.prototype);b.LineBasicMaterial.prototype.constructor=b.LineBasicMaterial;b.LineBasicMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);
this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};b.LineDashedMaterial=function(a){b.Material.call(this);this.type="LineDashedMaterial";this.color=new b.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.blending=b.NormalBlending;this.vertexColors=b.NoColors;this.fog=!0;this.setValues(a)};b.LineDashedMaterial.prototype=Object.create(b.Material.prototype);b.LineDashedMaterial.prototype.constructor=
b.LineDashedMaterial;b.LineDashedMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.linewidth=a.linewidth;this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};b.MeshBasicMaterial=function(a){b.Material.call(this);this.type="MeshBasicMaterial";this.color=new b.Color(16777215);this.aoMap=this.map=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=
b.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=b.SmoothShading;this.blending=b.NormalBlending;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=b.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};b.MeshBasicMaterial.prototype=Object.create(b.Material.prototype);b.MeshBasicMaterial.prototype.constructor=b.MeshBasicMaterial;b.MeshBasicMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,
a);this.color.copy(a.color);this.map=a.map;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=
a.skinning;this.morphTargets=a.morphTargets;return this};b.MeshLambertMaterial=function(a){b.Material.call(this);this.type="MeshLambertMaterial";this.color=new b.Color(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new b.Color(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=b.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.blending=b.NormalBlending;
this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=b.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};b.MeshLambertMaterial.prototype=Object.create(b.Material.prototype);b.MeshLambertMaterial.prototype.constructor=b.MeshLambertMaterial;b.MeshLambertMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=
a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=
a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};b.MultiMaterial=function(a){this.uuid=b.Math.generateUUID();this.type="MultiMaterial";this.materials=a instanceof Array?a:[];this.visible=!0};b.MultiMaterial.prototype={constructor:b.MultiMaterial,toJSON:function(a){for(var b={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},d=this.materials,
e=0,f=d.length;e<f;e++){var h=d[e].toJSON(a);delete h.metadata;b.materials.push(h)}b.visible=this.visible;return b},clone:function(){for(var a=new this.constructor,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());a.visible=this.visible;return a}};b.PointsMaterial=function(a){b.Material.call(this);this.type="PointsMaterial";this.color=new b.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.blending=b.NormalBlending;this.vertexColors=b.NoColors;this.fog=
!0;this.setValues(a)};b.PointsMaterial.prototype=Object.create(b.Material.prototype);b.PointsMaterial.prototype.constructor=b.PointsMaterial;b.PointsMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};b.MeshPhongMaterial=function(a){b.Material.call(this);this.type="MeshPhongMaterial";this.color=new b.Color(16777215);this.specular=
new b.Color(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new b.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new b.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=b.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=
!0;this.shading=b.SmoothShading;this.blending=b.NormalBlending;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=b.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};b.MeshPhongMaterial.prototype=Object.create(b.Material.prototype);b.MeshPhongMaterial.prototype.constructor=b.MeshPhongMaterial;b.MeshPhongMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.specular.copy(a.specular);
this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;
this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};
b.MeshDepthMaterial=function(a){b.Material.call(this);this.type="MeshDepthMaterial";this.depthPacking=b.BasicDepthPacking;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};b.MeshDepthMaterial.prototype=Object.create(b.Material.prototype);b.MeshDepthMaterial.prototype.constructor=b.MeshDepthMaterial;b.MeshDepthMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,
a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};b.MeshNormalMaterial=function(a){b.Material.call(this,a);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};
b.MeshNormalMaterial.prototype=Object.create(b.Material.prototype);b.MeshNormalMaterial.prototype.constructor=b.MeshNormalMaterial;b.MeshNormalMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};b.MeshStandardMaterial=function(a){b.Material.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new b.Color(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=
null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new b.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new b.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.fog=!0;this.shading=b.SmoothShading;this.blending=b.NormalBlending;this.wireframe=
!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=b.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};b.MeshStandardMaterial.prototype=Object.create(b.Material.prototype);b.MeshStandardMaterial.prototype.constructor=b.MeshStandardMaterial;b.MeshStandardMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=
a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=
a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};
b.MeshPhysicalMaterial=function(a){b.MeshStandardMaterial.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.setValues(a)};b.MeshPhysicalMaterial.prototype=Object.create(b.MeshStandardMaterial.prototype);b.MeshPhysicalMaterial.prototype.constructor=b.MeshPhysicalMaterial;b.MeshPhysicalMaterial.prototype.copy=function(a){b.MeshStandardMaterial.prototype.copy.call(this,a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;return this};b.SpriteMaterial=
function(a){b.Material.call(this);this.type="SpriteMaterial";this.color=new b.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};b.SpriteMaterial.prototype=Object.create(b.Material.prototype);b.SpriteMaterial.prototype.constructor=b.SpriteMaterial;b.SpriteMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;this.fog=a.fog;return this};b.ShaderMaterial=function(a){b.Material.call(this);
this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=b.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.clipping=this.lights=this.fog=!1;this.vertexColors=b.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.extensions={derivatives:!1,
fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))};b.ShaderMaterial.prototype=Object.create(b.Material.prototype);b.ShaderMaterial.prototype.constructor=b.ShaderMaterial;b.ShaderMaterial.prototype.copy=function(a){b.Material.prototype.copy.call(this,
a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=b.UniformsUtils.clone(a.uniforms);this.defines=a.defines;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.fog=a.fog;this.lights=a.lights;this.clipping=a.clipping;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};b.ShaderMaterial.prototype.toJSON=function(a){a=
b.Material.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};b.RawShaderMaterial=function(a){b.ShaderMaterial.call(this,a);this.type="RawShaderMaterial"};b.RawShaderMaterial.prototype=Object.create(b.ShaderMaterial.prototype);b.RawShaderMaterial.prototype.constructor=b.RawShaderMaterial;b.Texture=function(a,c,d,e,f,h,k,g,m,y){Object.defineProperty(this,"id",{value:b.TextureIdCount++});this.uuid=b.Math.generateUUID();
this.sourceFile=this.name="";this.image=void 0!==a?a:b.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==c?c:b.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==d?d:b.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:b.ClampToEdgeWrapping;this.magFilter=void 0!==f?f:b.LinearFilter;this.minFilter=void 0!==h?h:b.LinearMipMapLinearFilter;this.anisotropy=void 0!==m?m:1;this.format=void 0!==k?k:b.RGBAFormat;this.type=void 0!==g?g:b.UnsignedByteType;this.offset=new b.Vector2(0,0);this.repeat=new b.Vector2(1,
1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==y?y:b.LinearEncoding;this.version=0;this.onUpdate=null};b.Texture.DEFAULT_IMAGE=void 0;b.Texture.DEFAULT_MAPPING=b.UVMapping;b.Texture.prototype={constructor:b.Texture,set needsUpdate(a){!0===a&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=
a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=a.encoding;return this},toJSON:function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var c={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},
uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var d=this.image;void 0===d.uuid&&(d.uuid=b.Math.generateUUID());if(void 0===a.images[d.uuid]){var e=a.images,f=d.uuid,h=d.uuid,k;void 0!==d.toDataURL?k=d:(k=document.createElement("canvas"),k.width=d.width,k.height=d.height,k.getContext("2d").drawImage(d,
0,0,d.width,d.height));k=2048<k.width||2048<k.height?k.toDataURL("image/jpeg",.6):k.toDataURL("image/png");e[f]={uuid:h,url:k}}c.image=d.uuid}return a.textures[this.uuid]=c},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping===b.UVMapping){a.multiply(this.repeat);a.add(this.offset);if(0>a.x||1<a.x)switch(this.wrapS){case b.RepeatWrapping:a.x-=Math.floor(a.x);break;case b.ClampToEdgeWrapping:a.x=0>a.x?0:1;break;case b.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.x)%
2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case b.RepeatWrapping:a.y-=Math.floor(a.y);break;case b.ClampToEdgeWrapping:a.y=0>a.y?0:1;break;case b.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}};b.EventDispatcher.prototype.apply(b.Texture.prototype);b.TextureIdCount=0;b.DepthTexture=function(a,c,d,e,f,h,k,g,m){b.Texture.call(this,null,e,f,h,k,g,b.DepthFormat,d,m);this.image={width:a,
height:c};this.type=void 0!==d?d:b.UnsignedShortType;this.magFilter=void 0!==k?k:b.NearestFilter;this.minFilter=void 0!==g?g:b.NearestFilter;this.generateMipmaps=this.flipY=!1};b.DepthTexture.prototype=Object.create(b.Texture.prototype);b.DepthTexture.prototype.constructor=b.DepthTexture;b.CompressedTexture=function(a,c,d,e,f,h,k,g,m,y,p,u){b.Texture.call(this,null,h,k,g,m,y,e,f,p,u);this.image={width:c,height:d};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};b.CompressedTexture.prototype=Object.create(b.Texture.prototype);
b.CompressedTexture.prototype.constructor=b.CompressedTexture;b.DataTexture=function(a,c,d,e,f,h,k,g,m,y,p,u){b.Texture.call(this,null,h,k,g,m,y,e,f,p,u);this.image={data:a,width:c,height:d};this.magFilter=void 0!==m?m:b.NearestFilter;this.minFilter=void 0!==y?y:b.NearestFilter;this.generateMipmaps=this.flipY=!1};b.DataTexture.prototype=Object.create(b.Texture.prototype);b.DataTexture.prototype.constructor=b.DataTexture;b.Line=function(a,c,d){if(1===d)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),
new b.LineSegments(a,c);b.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new b.Geometry;this.material=void 0!==c?c:new b.LineBasicMaterial({color:16777215*Math.random()})};b.Line.prototype=Object.create(b.Object3D.prototype);b.Line.prototype.constructor=b.Line;b.Line.prototype.raycast=function(){var a=new b.Matrix4,c=new b.Ray,d=new b.Sphere;return function(e,f){var h=e.linePrecision,h=h*h,k=this.geometry,g=this.matrixWorld;null===k.boundingSphere&&k.computeBoundingSphere();d.copy(k.boundingSphere);
d.applyMatrix4(g);if(!1!==e.ray.intersectsSphere(d)){a.getInverse(g);c.copy(e.ray).applyMatrix4(a);var m=new b.Vector3,y=new b.Vector3,g=new b.Vector3,p=new b.Vector3,u=this instanceof b.LineSegments?2:1;if(k instanceof b.BufferGeometry){var l=k.index,r=k.attributes.position.array;if(null!==l)for(var l=l.array,k=0,n=l.length-1;k<n;k+=u){var t=l[k+1];m.fromArray(r,3*l[k]);y.fromArray(r,3*t);t=c.distanceSqToSegment(m,y,p,g);t>h||(p.applyMatrix4(this.matrixWorld),t=e.ray.origin.distanceTo(p),t<e.near||
t>e.far||f.push({distance:t,point:g.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this}))}else for(k=0,n=r.length/3-1;k<n;k+=u)m.fromArray(r,3*k),y.fromArray(r,3*k+3),t=c.distanceSqToSegment(m,y,p,g),t>h||(p.applyMatrix4(this.matrixWorld),t=e.ray.origin.distanceTo(p),t<e.near||t>e.far||f.push({distance:t,point:g.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this}))}else if(k instanceof b.Geometry)for(m=k.vertices,y=m.length,k=0;k<y-
1;k+=u)t=c.distanceSqToSegment(m[k],m[k+1],p,g),t>h||(p.applyMatrix4(this.matrixWorld),t=e.ray.origin.distanceTo(p),t<e.near||t>e.far||f.push({distance:t,point:g.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this}))}}}();b.Line.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};b.LineStrip=0;b.LinePieces=1;b.Points=function(a,c){b.Object3D.call(this);this.type="Points";this.geometry=void 0!==a?a:new b.Geometry;this.material=
void 0!==c?c:new b.PointsMaterial({color:16777215*Math.random()})};b.Points.prototype=Object.create(b.Object3D.prototype);b.Points.prototype.constructor=b.Points;b.Points.prototype.raycast=function(){var a=new b.Matrix4,c=new b.Ray,d=new b.Sphere;return function(e,f){function h(a,b){var d=c.distanceSqToPoint(a);if(d<p){var h=c.closestPointToPoint(a);h.applyMatrix4(m);var g=e.ray.origin.distanceTo(h);g<e.near||g>e.far||f.push({distance:g,distanceToRay:Math.sqrt(d),point:h.clone(),index:b,face:null,
object:k})}}var k=this,g=this.geometry,m=this.matrixWorld,y=e.params.Points.threshold;null===g.boundingSphere&&g.computeBoundingSphere();d.copy(g.boundingSphere);d.applyMatrix4(m);if(!1!==e.ray.intersectsSphere(d)){a.getInverse(m);c.copy(e.ray).applyMatrix4(a);var y=y/((this.scale.x+this.scale.y+this.scale.z)/3),p=y*y,y=new b.Vector3;if(g instanceof b.BufferGeometry){var u=g.index,g=g.attributes.position.array;if(null!==u)for(var l=u.array,u=0,r=l.length;u<r;u++){var n=l[u];y.fromArray(g,3*n);h(y,
n)}else for(u=0,l=g.length/3;u<l;u++)y.fromArray(g,3*u),h(y,u)}else for(y=g.vertices,u=0,l=y.length;u<l;u++)h(y[u],u)}}}();b.Points.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};b.LineSegments=function(a,c){b.Line.call(this,a,c);this.type="LineSegments"};b.LineSegments.prototype=Object.create(b.Line.prototype);b.LineSegments.prototype.constructor=b.LineSegments;b.Mesh=function(a,c){b.Object3D.call(this);this.type="Mesh";this.geometry=void 0!==a?a:
new b.Geometry;this.material=void 0!==c?c:new b.MeshBasicMaterial({color:16777215*Math.random()});this.drawMode=b.TrianglesDrawMode;this.updateMorphTargets()};b.Mesh.prototype=Object.create(b.Object3D.prototype);b.Mesh.prototype.constructor=b.Mesh;b.Mesh.prototype.setDrawMode=function(a){this.drawMode=a};b.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary=
{};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};b.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};b.Mesh.prototype.raycast=function(){function a(a,c,d,e,f,k,h){b.Triangle.barycoordFromPoint(a,
c,d,e,t);f.multiplyScalar(t.x);k.multiplyScalar(t.y);h.multiplyScalar(t.z);f.add(k).add(h);return f.clone()}function c(a,c,d,e,f,k,h){var g=a.material;if(null===(g.side===b.BackSide?d.intersectTriangle(k,f,e,!0,h):d.intersectTriangle(e,f,k,g.side!==b.DoubleSide,h)))return null;q.copy(h);q.applyMatrix4(a.matrixWorld);d=c.ray.origin.distanceTo(q);return d<c.near||d>c.far?null:{distance:d,point:q.clone(),object:a}}function d(d,e,f,h,p,u,q,y){k.fromArray(h,3*u);g.fromArray(h,3*q);m.fromArray(h,3*y);if(d=
c(d,e,f,k,g,m,v))p&&(l.fromArray(p,2*u),r.fromArray(p,2*q),n.fromArray(p,2*y),d.uv=a(v,k,g,m,l,r,n)),d.face=new b.Face3(u,q,y,b.Triangle.normal(k,g,m)),d.faceIndex=u;return d}var e=new b.Matrix4,f=new b.Ray,h=new b.Sphere,k=new b.Vector3,g=new b.Vector3,m=new b.Vector3,y=new b.Vector3,p=new b.Vector3,u=new b.Vector3,l=new b.Vector2,r=new b.Vector2,n=new b.Vector2,t=new b.Vector3,v=new b.Vector3,q=new b.Vector3;return function(q,t){var A=this.geometry,C=this.material,F=this.matrixWorld;if(void 0!==
C&&(null===A.boundingSphere&&A.computeBoundingSphere(),h.copy(A.boundingSphere),h.applyMatrix4(F),!1!==q.ray.intersectsSphere(h)&&(e.getInverse(F),f.copy(q.ray).applyMatrix4(e),null===A.boundingBox||!1!==f.intersectsBox(A.boundingBox)))){var H,E;if(A instanceof b.BufferGeometry){var Q,M,C=A.index,F=A.attributes,A=F.position.array;void 0!==F.uv&&(H=F.uv.array);if(null!==C)for(var F=C.array,O=0,I=F.length;O<I;O+=3){if(C=F[O],Q=F[O+1],M=F[O+2],E=d(this,q,f,A,H,C,Q,M))E.faceIndex=Math.floor(O/3),t.push(E)}else for(O=
0,I=A.length;O<I;O+=9)if(C=O/3,Q=C+1,M=C+2,E=d(this,q,f,A,H,C,Q,M))E.index=C,t.push(E)}else if(A instanceof b.Geometry){var D,S,F=C instanceof b.MultiMaterial,O=!0===F?C.materials:null,I=A.vertices;Q=A.faces;M=A.faceVertexUvs[0];0<M.length&&(H=M);for(var B=0,N=Q.length;B<N;B++){var G=Q[B];E=!0===F?O[G.materialIndex]:C;if(void 0!==E){M=I[G.a];D=I[G.b];S=I[G.c];if(!0===E.morphTargets){E=A.morphTargets;var P=this.morphTargetInfluences;k.set(0,0,0);g.set(0,0,0);m.set(0,0,0);for(var J=0,V=E.length;J<V;J++){var U=
P[J];if(0!==U){var sa=E[J].vertices;k.addScaledVector(y.subVectors(sa[G.a],M),U);g.addScaledVector(p.subVectors(sa[G.b],D),U);m.addScaledVector(u.subVectors(sa[G.c],S),U)}}k.add(M);g.add(D);m.add(S);M=k;D=g;S=m}if(E=c(this,q,f,M,D,S,v))H&&(P=H[B],l.copy(P[0]),r.copy(P[1]),n.copy(P[2]),E.uv=a(v,M,D,S,l,r,n)),E.face=G,E.faceIndex=B,t.push(E)}}}}}}();b.Mesh.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};b.SkinnedMesh=function(a,c,d){b.Mesh.call(this,
a,c);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new b.Matrix4;this.bindMatrixInverse=new b.Matrix4;a=[];if(this.geometry&&void 0!==this.geometry.bones){for(var e,f=0,h=this.geometry.bones.length;f<h;++f)e=this.geometry.bones[f],c=new b.Bone(this),a.push(c),c.name=e.name,c.position.fromArray(e.pos),c.quaternion.fromArray(e.rotq),void 0!==e.scl&&c.scale.fromArray(e.scl);f=0;for(h=this.geometry.bones.length;f<h;++f)e=this.geometry.bones[f],-1!==e.parent&&null!==e.parent&&void 0!==
a[e.parent]?a[e.parent].add(a[f]):this.add(a[f])}this.normalizeSkinWeights();this.updateMatrixWorld(!0);this.bind(new b.Skeleton(a,void 0,d),this.matrixWorld)};b.SkinnedMesh.prototype=Object.create(b.Mesh.prototype);b.SkinnedMesh.prototype.constructor=b.SkinnedMesh;b.SkinnedMesh.prototype.bind=function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)};b.SkinnedMesh.prototype.pose=
function(){this.skeleton.pose()};b.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof b.Geometry)for(var a=0;a<this.geometry.skinWeights.length;a++){var c=this.geometry.skinWeights[a],d=1/c.lengthManhattan();Infinity!==d?c.multiplyScalar(d):c.set(1,0,0,0)}else if(this.geometry instanceof b.BufferGeometry)for(var c=new b.Vector4,e=this.geometry.attributes.skinWeight,a=0;a<e.count;a++)c.x=e.getX(a),c.y=e.getY(a),c.z=e.getZ(a),c.w=e.getW(a),d=1/c.lengthManhattan(),Infinity!==
d?c.multiplyScalar(d):c.set(1,0,0,0),e.setXYZW(a,c.x,c.y,c.z,c.w)};b.SkinnedMesh.prototype.updateMatrixWorld=function(a){b.Mesh.prototype.updateMatrixWorld.call(this,!0);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)};b.SkinnedMesh.prototype.clone=function(){return(new this.constructor(this.geometry,this.material,this.useVertexTexture)).copy(this)};
b.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),c=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),d=new Float32Array([0,0,1,0,1,1,0,1]),e=new b.BufferGeometry;e.setIndex(new b.BufferAttribute(a,1));e.addAttribute("position",new b.BufferAttribute(c,3));e.addAttribute("uv",new b.BufferAttribute(d,2));return function(a){b.Object3D.call(this);this.type="Sprite";this.geometry=e;this.material=void 0!==a?a:new b.SpriteMaterial}}();b.Sprite.prototype=Object.create(b.Object3D.prototype);b.Sprite.prototype.constructor=
b.Sprite;b.Sprite.prototype.raycast=function(){var a=new b.Vector3;return function(b,d){a.setFromMatrixPosition(this.matrixWorld);var e=b.ray.distanceSqToPoint(a);e>this.scale.x*this.scale.y/4||d.push({distance:Math.sqrt(e),point:this.position,face:null,object:this})}}();b.Sprite.prototype.clone=function(){return(new this.constructor(this.material)).copy(this)};b.Particle=b.Sprite;b.LensFlare=function(a,c,d,e,f){b.Object3D.call(this);this.lensFlares=[];this.positionScreen=new b.Vector3;this.customUpdateCallback=
void 0;void 0!==a&&this.add(a,c,d,e,f)};b.LensFlare.prototype=Object.create(b.Object3D.prototype);b.LensFlare.prototype.constructor=b.LensFlare;b.LensFlare.prototype.add=function(a,c,d,e,f,h){void 0===c&&(c=-1);void 0===d&&(d=0);void 0===h&&(h=1);void 0===f&&(f=new b.Color(16777215));void 0===e&&(e=b.NormalBlending);d=Math.min(d,Math.max(0,d));this.lensFlares.push({texture:a,size:c,distance:d,x:0,y:0,z:0,scale:1,rotation:0,opacity:h,color:f,blending:e})};b.LensFlare.prototype.updateLensFlares=function(){var a,
b=this.lensFlares.length,d,e=2*-this.positionScreen.x,f=2*-this.positionScreen.y;for(a=0;a<b;a++)d=this.lensFlares[a],d.x=this.positionScreen.x+e*d.distance,d.y=this.positionScreen.y+f*d.distance,d.wantedRotation=d.x*Math.PI*.25,d.rotation+=.25*(d.wantedRotation-d.rotation)};b.LensFlare.prototype.copy=function(a){b.Object3D.prototype.copy.call(this,a);this.positionScreen.copy(a.positionScreen);this.customUpdateCallback=a.customUpdateCallback;for(var c=0,d=a.lensFlares.length;c<d;c++)this.lensFlares.push(a.lensFlares[c]);
return this};b.ImmediateRenderObject=function(a){b.Object3D.call(this);this.material=a;this.render=function(a){}};b.ImmediateRenderObject.prototype=Object.create(b.Object3D.prototype);b.ImmediateRenderObject.prototype.constructor=b.ImmediateRenderObject;b.Scene=function(){b.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};b.Scene.prototype=Object.create(b.Object3D.prototype);b.Scene.prototype.constructor=b.Scene;b.Scene.prototype.copy=function(a,c){b.Object3D.prototype.copy.call(this,
a,c);null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this};b.FogExp2=function(a,c){this.name="";this.color=new b.Color(a);this.density=void 0!==c?c:2.5E-4};b.FogExp2.prototype.clone=function(){return new b.FogExp2(this.color.getHex(),this.density)};b.ShaderChunk={};b.ShaderChunk.common="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n";
b.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n";b.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n";b.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n";b.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif";b.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n";
b.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n";b.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif";
b.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif";b.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif";b.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif";
b.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif";b.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n";b.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n";b.ShaderChunk.encodings_pars_fragment=
"\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n";
b.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n";b.ShaderChunk.envmap_pars_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n";b.ShaderChunk.envmap_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n";
b.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n";
b.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n";
b.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n";
b.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif";b.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif";b.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n";b.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif";b.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n";b.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n";
b.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n";b.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif";b.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n";
b.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n";b.ShaderChunk.clipping_planes_pars_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n";
b.ShaderChunk.clipping_planes_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n";b.ShaderChunk.clipping_planes_fragment="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n";b.ShaderChunk.clipping_planes_pars_fragment="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n";
b.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n";b.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n";b.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif";
b.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n";b.ShaderChunk.lights_lambert_vertex=
"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n";
b.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif";b.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n";
b.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n";b.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif";b.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n";
b.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif";b.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n";b.ShaderChunk.packing="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nvec4 packDepthToRGBA( const in float value ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( value * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nfloat unpackRGBAToDepth( const in vec4 rgba ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( rgba, bitSh );\n}\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n";
b.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n";b.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n";
b.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n";
b.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n";
b.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n";
b.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n";
b.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n";b.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif";
b.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n";b.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif";
b.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif";b.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n";b.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n";b.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n";
b.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n";b.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n";b.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n";
b.UniformsUtils={merge:function(a){for(var b={},d=0;d<a.length;d++){var e=this.clone(a[d]),f;for(f in e)b[f]=e[f]}return b},clone:function(a){var c={},d;for(d in a){c[d]={};for(var e in a[d]){var f=a[d][e];f instanceof b.Color||f instanceof b.Vector2||f instanceof b.Vector3||f instanceof b.Vector4||f instanceof b.Matrix3||f instanceof b.Matrix4||f instanceof b.Texture?c[d][e]=f.clone():Array.isArray(f)?c[d][e]=f.slice():c[d][e]=f}}return c}};b.UniformsLib={common:{diffuse:{type:"c",value:new b.Color(15658734)},
opacity:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new b.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"1f",value:-1},reflectivity:{type:"1f",value:1},refractionRatio:{type:"1f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"1f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"1f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},
bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"1f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new b.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"1f",value:1},displacementBias:{type:"1f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"1f",value:2.5E-4},fogNear:{type:"1f",value:1},fogFar:{type:"1f",value:2E3},fogColor:{type:"c",
value:new b.Color(16777215)}},lights:{ambientLightColor:{type:"3fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"1f"},coneCos:{type:"1f"},penumbraCos:{type:"1f"},
decay:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"1f"},distance:{type:"1f"},shadow:{type:"1i"},shadowBias:{type:"1f"},shadowRadius:{type:"1f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",
value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new b.Color(15658734)},opacity:{type:"1f",value:1},size:{type:"1f",value:1},scale:{type:"1f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new b.Vector4(0,0,1,1)}}};b.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n";
b.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";b.ShaderChunk.depth_frag="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n";
b.ShaderChunk.depth_vert="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
b.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n";b.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n";
b.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n";
b.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";b.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
b.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n";
b.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n";
b.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n";
b.ShaderChunk.meshphysical_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.meshphysical_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n";
b.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n";b.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
b.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
b.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n";
b.ShaderLib={basic:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,b.UniformsLib.aomap,b.UniformsLib.fog]),vertexShader:b.ShaderChunk.meshbasic_vert,fragmentShader:b.ShaderChunk.meshbasic_frag},lambert:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,b.UniformsLib.aomap,b.UniformsLib.lightmap,b.UniformsLib.emissivemap,b.UniformsLib.fog,b.UniformsLib.lights,{emissive:{type:"c",value:new b.Color(0)}}]),vertexShader:b.ShaderChunk.meshlambert_vert,fragmentShader:b.ShaderChunk.meshlambert_frag},
phong:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,b.UniformsLib.aomap,b.UniformsLib.lightmap,b.UniformsLib.emissivemap,b.UniformsLib.bumpmap,b.UniformsLib.normalmap,b.UniformsLib.displacementmap,b.UniformsLib.fog,b.UniformsLib.lights,{emissive:{type:"c",value:new b.Color(0)},specular:{type:"c",value:new b.Color(1118481)},shininess:{type:"1f",value:30}}]),vertexShader:b.ShaderChunk.meshphong_vert,fragmentShader:b.ShaderChunk.meshphong_frag},standard:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,
b.UniformsLib.aomap,b.UniformsLib.lightmap,b.UniformsLib.emissivemap,b.UniformsLib.bumpmap,b.UniformsLib.normalmap,b.UniformsLib.displacementmap,b.UniformsLib.roughnessmap,b.UniformsLib.metalnessmap,b.UniformsLib.fog,b.UniformsLib.lights,{emissive:{type:"c",value:new b.Color(0)},roughness:{type:"1f",value:.5},metalness:{type:"1f",value:0},envMapIntensity:{type:"1f",value:1}}]),vertexShader:b.ShaderChunk.meshphysical_vert,fragmentShader:b.ShaderChunk.meshphysical_frag},points:{uniforms:b.UniformsUtils.merge([b.UniformsLib.points,
b.UniformsLib.fog]),vertexShader:b.ShaderChunk.points_vert,fragmentShader:b.ShaderChunk.points_frag},dashed:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,b.UniformsLib.fog,{scale:{type:"1f",value:1},dashSize:{type:"1f",value:1},totalSize:{type:"1f",value:2}}]),vertexShader:b.ShaderChunk.linedashed_vert,fragmentShader:b.ShaderChunk.linedashed_frag},depth:{uniforms:b.UniformsUtils.merge([b.UniformsLib.common,b.UniformsLib.displacementmap]),vertexShader:b.ShaderChunk.depth_vert,fragmentShader:b.ShaderChunk.depth_frag},
normal:{uniforms:{opacity:{type:"1f",value:1}},vertexShader:b.ShaderChunk.normal_vert,fragmentShader:b.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:b.ShaderChunk.cube_vert,fragmentShader:b.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"1f",value:-1}},vertexShader:b.ShaderChunk.equirect_vert,fragmentShader:b.ShaderChunk.equirect_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new b.Vector3}},
vertexShader:b.ShaderChunk.distanceRGBA_vert,fragmentShader:b.ShaderChunk.distanceRGBA_frag}};b.ShaderLib.physical={uniforms:b.UniformsUtils.merge([b.ShaderLib.standard.uniforms,{}]),vertexShader:b.ShaderChunk.meshphysical_vert,fragmentShader:b.ShaderChunk.meshphysical_frag};b.WebGLRenderer=function(a){function c(a,b,c,d){!0===J&&(a*=d,b*=d,c*=d);T.clearColor(a,b,c,d)}function d(){T.init();T.scissor(Ka.copy(ma).multiplyScalar(ga));T.viewport(W.copy(na).multiplyScalar(ga));c(ia.r,ia.g,ia.b,aa)}function e(){ya=
pa=null;xa="";R=-1;T.reset()}function f(a){a.preventDefault();e();d();ha.clear()}function h(a){a=a.target;a.removeEventListener("dispose",h);a:{var b=ha.get(a);if(a.image&&b.__image__webglTextureCube)w.deleteTexture(b.__image__webglTextureCube);else{if(void 0===b.__webglInit)break a;w.deleteTexture(b.__webglTexture)}ha.delete(a)}Ha.textures--}function k(a){a=a.target;a.removeEventListener("dispose",k);var c=ha.get(a),d=ha.get(a.texture);if(a){void 0!==d.__webglTexture&&w.deleteTexture(d.__webglTexture);
a.depthTexture&&a.depthTexture.dispose();if(a instanceof b.WebGLRenderTargetCube)for(d=0;6>d;d++)w.deleteFramebuffer(c.__webglFramebuffer[d]),c.__webglDepthbuffer&&w.deleteRenderbuffer(c.__webglDepthbuffer[d]);else w.deleteFramebuffer(c.__webglFramebuffer),c.__webglDepthbuffer&&w.deleteRenderbuffer(c.__webglDepthbuffer);ha.delete(a.texture);ha.delete(a)}Ha.textures--}function g(a){a=a.target;a.removeEventListener("dispose",g);m(a);ha.delete(a)}function m(a){var b=ha.get(a).program;a.program=void 0;
void 0!==b&&Fa.releaseProgram(b)}function y(a,b){return Math.abs(b[0])-Math.abs(a[0])}function p(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function u(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function l(a,b,c,d,e){var f;c.transparent?(d=ca,f=++ua):(d=sa,f=++Na);f=d[f];void 0!==
f?(f.id=a.id,f.object=a,f.geometry=b,f.material=c,f.z=qa.z,f.group=e):(f={id:a.id,object:a,geometry:b,material:c,z:qa.z,group:e},d.push(f))}function r(a){var b=a.geometry;null===b.boundingSphere&&b.computeBoundingSphere();var c=ab.copy(b.boundingSphere).applyMatrix4(a.matrixWorld);if(!$.intersectsSphere(c))return!1;if(0===Aa)return!0;a=ja.clippingPlanes;var b=c.center,c=-c.radius,d=0;do if(a[d].distanceToPoint(b)<c)return!1;while(++d!==Aa);return!0}function n(a,c){if(!1!==a.visible){if(a.layers.test(c.layers))if(a instanceof
b.Light)U.push(a);else if(a instanceof b.Sprite)!1!==a.frustumCulled&&!0!==r(a)||ta.push(a);else if(a instanceof b.LensFlare)ra.push(a);else if(a instanceof b.ImmediateRenderObject)!0===ja.sortObjects&&(qa.setFromMatrixPosition(a.matrixWorld),qa.applyProjection(Ra)),l(a,null,a.material,qa.z,null);else if(a instanceof b.Mesh||a instanceof b.Line||a instanceof b.Points)if(a instanceof b.SkinnedMesh&&a.skeleton.update(),!1===a.frustumCulled||!0===r(a)){var d=a.material;if(!0===d.visible){!0===ja.sortObjects&&
(qa.setFromMatrixPosition(a.matrixWorld),qa.applyProjection(Ra));var e=Ia.update(a);if(d instanceof b.MultiMaterial)for(var f=e.groups,k=d.materials,d=0,h=f.length;d<h;d++){var g=f[d],m=k[g.materialIndex];!0===m.visible&&l(a,e,m,qa.z,g)}else l(a,e,d,qa.z,null)}}e=a.children;d=0;for(h=e.length;d<h;d++)n(e[d],c)}}function t(a,c,d,e){for(var f=0,k=a.length;f<k;f++){var h=a[f],g=h.object,l=h.geometry,m=void 0===e?h.material:e,h=h.group;g.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,g.matrixWorld);
g.normalMatrix.getNormalMatrix(g.modelViewMatrix);if(g instanceof b.ImmediateRenderObject){v(m);var s=q(c,d,m,g);xa="";g.render(function(a){ja.renderBufferImmediate(a,s,m)})}else ja.renderBufferDirect(c,d,l,m,g,h)}}function v(a){a.side!==b.DoubleSide?T.enable(w.CULL_FACE):T.disable(w.CULL_FACE);T.setFlipSided(a.side===b.BackSide);!0===a.transparent?T.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha,a.premultipliedAlpha):T.setBlending(b.NoBlending);
T.setDepthFunc(a.depthFunc);T.setDepthTest(a.depthTest);T.setDepthWrite(a.depthWrite);T.setColorWrite(a.colorWrite);T.setPolygonOffset(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}function q(a,c,d,e){Z=0;var f=ha.get(d);if(Qa){if(La||a!==ya){var k=d.clippingPlanes,h=a===ya&&d.id===R;if(!La||null===k||0===k.length||Ea&&!d.clipShadows)Ea?K(null):A();else{var l=Ea?0:va,n=4*l,p=f.clippingState||null;oa.value=p;p=K(k,a,n,h);for(k=0;k!==n;++k)p[k]=Ba[k];f.clippingState=p;Aa+=l}}void 0!==
f.numClippingPlanes&&f.numClippingPlanes!==Aa&&(d.needsUpdate=!0)}void 0===f.program&&(d.needsUpdate=!0);void 0!==f.lightsHash&&f.lightsHash!==ea.hash&&(d.needsUpdate=!0);if(d.needsUpdate){a:{l=ha.get(d);n=Fa.getParameters(d,ea,c,Aa,e);p=Fa.getProgramCode(d,n);k=l.program;h=!0;if(void 0===k)d.addEventListener("dispose",g);else if(k.code!==p)m(d);else if(void 0!==n.shaderID)break a;else h=!1;h&&(n.shaderID?(k=b.ShaderLib[n.shaderID],l.__webglShader={name:d.type,uniforms:b.UniformsUtils.clone(k.uniforms),
vertexShader:k.vertexShader,fragmentShader:k.fragmentShader}):l.__webglShader={name:d.type,uniforms:d.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader},d.__webglShader=l.__webglShader,k=Fa.acquireProgram(d,n,p),l.program=k,d.program=k);n=k.getAttributes();if(d.morphTargets)for(p=d.numSupportedMorphTargets=0;p<ja.maxMorphTargets;p++)0<=n["morphTarget"+p]&&d.numSupportedMorphTargets++;if(d.morphNormals)for(p=d.numSupportedMorphNormals=0;p<ja.maxMorphNormals;p++)0<=n["morphNormal"+
p]&&d.numSupportedMorphNormals++;n=l.__webglShader.uniforms;(d instanceof b.ShaderMaterial||d instanceof b.RawShaderMaterial)&&!0!==d.clipping||(l.numClippingPlanes=Aa,n.clippingPlanes=oa);if(d instanceof b.MeshPhongMaterial||d instanceof b.MeshLambertMaterial||d instanceof b.MeshStandardMaterial||d.lights)l.lightsHash=ea.hash,n.ambientLightColor.value=ea.ambient,n.directionalLights.value=ea.directional,n.spotLights.value=ea.spot,n.pointLights.value=ea.point,n.hemisphereLights.value=ea.hemi,n.directionalShadowMap.value=
ea.directionalShadowMap,n.directionalShadowMatrix.value=ea.directionalShadowMatrix,n.spotShadowMap.value=ea.spotShadowMap,n.spotShadowMatrix.value=ea.spotShadowMatrix,n.pointShadowMap.value=ea.pointShadowMap,n.pointShadowMatrix.value=ea.pointShadowMatrix;p=l.program.getUniforms();p=b.WebGLUniforms.seqWithValue(p.seq,n);l.uniformsList=p;l.dynamicUniforms=b.WebGLUniforms.splitDynamic(p,n)}d.needsUpdate=!1}var r=!1,h=k=!1,l=f.program,p=l.getUniforms(),n=f.__webglShader.uniforms;l.id!==pa&&(w.useProgram(l.program),
pa=l.id,h=k=r=!0);d.id!==R&&(R=d.id,k=!0);if(r||a!==ya){p.set(w,a,"projectionMatrix");wa.logarithmicDepthBuffer&&p.setValue(w,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));a!==ya&&(ya=a,h=k=!0);if(d instanceof b.ShaderMaterial||d instanceof b.MeshPhongMaterial||d instanceof b.MeshStandardMaterial||d.envMap)r=p.map.cameraPosition,void 0!==r&&r.setValue(w,qa.setFromMatrixPosition(a.matrixWorld));(d instanceof b.MeshPhongMaterial||d instanceof b.MeshLambertMaterial||d instanceof b.MeshBasicMaterial||
d instanceof b.MeshStandardMaterial||d instanceof b.ShaderMaterial||d.skinning)&&p.setValue(w,"viewMatrix",a.matrixWorldInverse);p.set(w,ja,"toneMappingExposure");p.set(w,ja,"toneMappingWhitePoint")}d.skinning&&(p.setOptional(w,e,"bindMatrix"),p.setOptional(w,e,"bindMatrixInverse"),r=e.skeleton)&&(wa.floatVertexTextures&&r.useVertexTexture?(p.set(w,r,"boneTexture"),p.set(w,r,"boneTextureWidth"),p.set(w,r,"boneTextureHeight")):p.setOptional(w,r,"boneMatrices"));if(k){if(d instanceof b.MeshPhongMaterial||
d instanceof b.MeshLambertMaterial||d instanceof b.MeshStandardMaterial||d.lights)k=h,n.ambientLightColor.needsUpdate=k,n.directionalLights.needsUpdate=k,n.pointLights.needsUpdate=k,n.spotLights.needsUpdate=k,n.hemisphereLights.needsUpdate=k;c&&d.fog&&(n.fogColor.value=c.color,c instanceof b.Fog?(n.fogNear.value=c.near,n.fogFar.value=c.far):c instanceof b.FogExp2&&(n.fogDensity.value=c.density));if(d instanceof b.MeshBasicMaterial||d instanceof b.MeshLambertMaterial||d instanceof b.MeshPhongMaterial||
d instanceof b.MeshStandardMaterial||d instanceof b.MeshDepthMaterial){n.opacity.value=d.opacity;n.diffuse.value=d.color;d.emissive&&n.emissive.value.copy(d.emissive).multiplyScalar(d.emissiveIntensity);n.map.value=d.map;n.specularMap.value=d.specularMap;n.alphaMap.value=d.alphaMap;d.aoMap&&(n.aoMap.value=d.aoMap,n.aoMapIntensity.value=d.aoMapIntensity);var q;d.map?q=d.map:d.specularMap?q=d.specularMap:d.displacementMap?q=d.displacementMap:d.normalMap?q=d.normalMap:d.bumpMap?q=d.bumpMap:d.roughnessMap?
q=d.roughnessMap:d.metalnessMap?q=d.metalnessMap:d.alphaMap?q=d.alphaMap:d.emissiveMap&&(q=d.emissiveMap);void 0!==q&&(q instanceof b.WebGLRenderTarget&&(q=q.texture),c=q.offset,q=q.repeat,n.offsetRepeat.value.set(c.x,c.y,q.x,q.y));n.envMap.value=d.envMap;n.flipEnvMap.value=d.envMap instanceof b.WebGLRenderTargetCube?1:-1;n.reflectivity.value=d.reflectivity;n.refractionRatio.value=d.refractionRatio}d instanceof b.LineBasicMaterial?(n.diffuse.value=d.color,n.opacity.value=d.opacity):d instanceof b.LineDashedMaterial?
(n.diffuse.value=d.color,n.opacity.value=d.opacity,n.dashSize.value=d.dashSize,n.totalSize.value=d.dashSize+d.gapSize,n.scale.value=d.scale):d instanceof b.PointsMaterial?(n.diffuse.value=d.color,n.opacity.value=d.opacity,n.size.value=d.size*ga,n.scale.value=.5*D.clientHeight,n.map.value=d.map,null!==d.map&&(q=d.map.offset,d=d.map.repeat,n.offsetRepeat.value.set(q.x,q.y,d.x,d.y))):d instanceof b.MeshLambertMaterial?(d.lightMap&&(n.lightMap.value=d.lightMap,n.lightMapIntensity.value=d.lightMapIntensity),
d.emissiveMap&&(n.emissiveMap.value=d.emissiveMap)):d instanceof b.MeshPhongMaterial?(n.specular.value=d.specular,n.shininess.value=Math.max(d.shininess,1E-4),d.lightMap&&(n.lightMap.value=d.lightMap,n.lightMapIntensity.value=d.lightMapIntensity),d.emissiveMap&&(n.emissiveMap.value=d.emissiveMap),d.bumpMap&&(n.bumpMap.value=d.bumpMap,n.bumpScale.value=d.bumpScale),d.normalMap&&(n.normalMap.value=d.normalMap,n.normalScale.value.copy(d.normalScale)),d.displacementMap&&(n.displacementMap.value=d.displacementMap,
n.displacementScale.value=d.displacementScale,n.displacementBias.value=d.displacementBias)):d instanceof b.MeshPhysicalMaterial?z(n,d):d instanceof b.MeshStandardMaterial?z(n,d):d instanceof b.MeshDepthMaterial?d.displacementMap&&(n.displacementMap.value=d.displacementMap,n.displacementScale.value=d.displacementScale,n.displacementBias.value=d.displacementBias):d instanceof b.MeshNormalMaterial&&(n.opacity.value=d.opacity);b.WebGLUniforms.upload(w,f.uniformsList,n,ja)}p.set(w,e,"modelViewMatrix");
p.set(w,e,"normalMatrix");p.setValue(w,"modelMatrix",e.matrixWorld);f=f.dynamicUniforms;null!==f&&(b.WebGLUniforms.evalDynamic(f,n,e,a),b.WebGLUniforms.upload(w,f,n,ja));return l}function z(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);
b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale);b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale));b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}function K(a,b,c,d){var e=null!==a?a.length:0,f=null;if(0!==e){f=oa.value;if(!0!==d||null===f){var k=c+4*e;b=b.matrixWorldInverse;d=eb.getNormalMatrix(b);
if(null===f||f.length<k)f=new Float32Array(k);for(k=0;k!==e;++k,c+=4){var h=fb.copy(a[k]).applyMatrix4(b,d);h.normal.toArray(f,c);f[c+3]=h.constant}}oa.value=f;oa.needsUpdate=!0}Aa=e;return f}function A(){oa.value!==Ba&&(oa.value=Ba,oa.needsUpdate=0<va);Aa=va}function C(a,c,d){d?(w.texParameteri(a,w.TEXTURE_WRAP_S,I(c.wrapS)),w.texParameteri(a,w.TEXTURE_WRAP_T,I(c.wrapT)),w.texParameteri(a,w.TEXTURE_MAG_FILTER,I(c.magFilter)),w.texParameteri(a,w.TEXTURE_MIN_FILTER,I(c.minFilter))):(w.texParameteri(a,
w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(a,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),c.wrapS===b.ClampToEdgeWrapping&&c.wrapT===b.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",c),w.texParameteri(a,w.TEXTURE_MAG_FILTER,O(c.magFilter)),w.texParameteri(a,w.TEXTURE_MIN_FILTER,O(c.minFilter)),c.minFilter!==b.NearestFilter&&c.minFilter!==b.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",
c));!(d=ka.get("EXT_texture_filter_anisotropic"))||c.type===b.FloatType&&null===ka.get("OES_texture_float_linear")||c.type===b.HalfFloatType&&null===ka.get("OES_texture_half_float_linear")||!(1<c.anisotropy||ha.get(c).__currentAnisotropy)||(w.texParameterf(a,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.anisotropy,ja.getMaxAnisotropy())),ha.get(c).__currentAnisotropy=c.anisotropy)}function F(a,c){a instanceof b.WebGLRenderTarget&&(a=a.texture);var d=ha.get(a);if(0<a.version&&d.__version!==a.version){var e=
a.image;if(void 0===e)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",a);else if(!1===e.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",a);else{e=a;void 0===d.__webglInit&&(d.__webglInit=!0,e.addEventListener("dispose",h),d.__webglTexture=w.createTexture(),Ha.textures++);T.activeTexture(w.TEXTURE0+c);T.bindTexture(w.TEXTURE_2D,d.__webglTexture);w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,e.flipY);w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
e.premultiplyAlpha);w.pixelStorei(w.UNPACK_ALIGNMENT,e.unpackAlignment);var f=H(e.image,wa.maxTextureSize);if((e.wrapS!==b.ClampToEdgeWrapping||e.wrapT!==b.ClampToEdgeWrapping||e.minFilter!==b.NearestFilter&&e.minFilter!==b.LinearFilter)&&!1===E(f)){var k=f;if(k instanceof HTMLImageElement||k instanceof HTMLCanvasElement){var g=document.createElement("canvas");g.width=b.Math.nearestPowerOfTwo(k.width);g.height=b.Math.nearestPowerOfTwo(k.height);g.getContext("2d").drawImage(k,0,0,g.width,g.height);
console.warn("THREE.WebGLRenderer: image is not power of two ("+k.width+"x"+k.height+"). Resized to "+g.width+"x"+g.height,k);f=g}else f=k}var k=E(f),g=I(e.format),l=I(e.type);C(w.TEXTURE_2D,e,k);var m=e.mipmaps;if(e instanceof b.DepthTexture){m=w.DEPTH_COMPONENT;if(e.type===b.FloatType){if(!Pa)throw Error("Float Depth Texture only supported in WebGL2.0");m=w.DEPTH_COMPONENT32F}else Pa&&(m=w.DEPTH_COMPONENT16);T.texImage2D(w.TEXTURE_2D,0,m,f.width,f.height,0,g,l,null)}else if(e instanceof b.DataTexture)if(0<
m.length&&k){for(var n=0,s=m.length;n<s;n++)f=m[n],T.texImage2D(w.TEXTURE_2D,n,g,f.width,f.height,0,g,l,f.data);e.generateMipmaps=!1}else T.texImage2D(w.TEXTURE_2D,0,g,f.width,f.height,0,g,l,f.data);else if(e instanceof b.CompressedTexture)for(n=0,s=m.length;n<s;n++)f=m[n],e.format!==b.RGBAFormat&&e.format!==b.RGBFormat?-1<T.getCompressedTextureFormats().indexOf(g)?T.compressedTexImage2D(w.TEXTURE_2D,n,g,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):
T.texImage2D(w.TEXTURE_2D,n,g,f.width,f.height,0,g,l,f.data);else if(0<m.length&&k){n=0;for(s=m.length;n<s;n++)f=m[n],T.texImage2D(w.TEXTURE_2D,n,g,g,l,f);e.generateMipmaps=!1}else T.texImage2D(w.TEXTURE_2D,0,g,g,l,f);e.generateMipmaps&&k&&w.generateMipmap(w.TEXTURE_2D);d.__version=e.version;if(e.onUpdate)e.onUpdate(e)}}else T.activeTexture(w.TEXTURE0+c),T.bindTexture(w.TEXTURE_2D,d.__webglTexture)}function H(a,b){if(a.width>b||a.height>b){var c=b/Math.max(a.width,a.height),d=document.createElement("canvas");
d.width=Math.floor(a.width*c);d.height=Math.floor(a.height*c);d.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,d.width,d.height);console.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+d.width+"x"+d.height,a);return d}return a}function E(a){return b.Math.isPowerOfTwo(a.width)&&b.Math.isPowerOfTwo(a.height)}function X(a,b,c,d){var e=I(b.texture.format),f=I(b.texture.type);T.texImage2D(d,0,e,b.width,b.height,0,e,f,null);w.bindFramebuffer(w.FRAMEBUFFER,a);
w.framebufferTexture2D(w.FRAMEBUFFER,c,d,ha.get(b.texture).__webglTexture,0);w.bindFramebuffer(w.FRAMEBUFFER,null)}function M(a,b){w.bindRenderbuffer(w.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?(w.renderbufferStorage(w.RENDERBUFFER,w.DEPTH_COMPONENT16,b.width,b.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(w.renderbufferStorage(w.RENDERBUFFER,w.DEPTH_STENCIL,b.width,b.height),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_STENCIL_ATTACHMENT,
w.RENDERBUFFER,a)):w.renderbufferStorage(w.RENDERBUFFER,w.RGBA4,b.width,b.height);w.bindRenderbuffer(w.RENDERBUFFER,null)}function O(a){return a===b.NearestFilter||a===b.NearestMipMapNearestFilter||a===b.NearestMipMapLinearFilter?w.NEAREST:w.LINEAR}function I(a){var c;if(a===b.RepeatWrapping)return w.REPEAT;if(a===b.ClampToEdgeWrapping)return w.CLAMP_TO_EDGE;if(a===b.MirroredRepeatWrapping)return w.MIRRORED_REPEAT;if(a===b.NearestFilter)return w.NEAREST;if(a===b.NearestMipMapNearestFilter)return w.NEAREST_MIPMAP_NEAREST;
if(a===b.NearestMipMapLinearFilter)return w.NEAREST_MIPMAP_LINEAR;if(a===b.LinearFilter)return w.LINEAR;if(a===b.LinearMipMapNearestFilter)return w.LINEAR_MIPMAP_NEAREST;if(a===b.LinearMipMapLinearFilter)return w.LINEAR_MIPMAP_LINEAR;if(a===b.UnsignedByteType)return w.UNSIGNED_BYTE;if(a===b.UnsignedShort4444Type)return w.UNSIGNED_SHORT_4_4_4_4;if(a===b.UnsignedShort5551Type)return w.UNSIGNED_SHORT_5_5_5_1;if(a===b.UnsignedShort565Type)return w.UNSIGNED_SHORT_5_6_5;if(a===b.ByteType)return w.BYTE;
if(a===b.ShortType)return w.SHORT;if(a===b.UnsignedShortType)return w.UNSIGNED_SHORT;if(a===b.IntType)return w.INT;if(a===b.UnsignedIntType)return w.UNSIGNED_INT;if(a===b.FloatType)return w.FLOAT;c=ka.get("OES_texture_half_float");if(null!==c&&a===b.HalfFloatType)return c.HALF_FLOAT_OES;if(a===b.AlphaFormat)return w.ALPHA;if(a===b.RGBFormat)return w.RGB;if(a===b.RGBAFormat)return w.RGBA;if(a===b.LuminanceFormat)return w.LUMINANCE;if(a===b.LuminanceAlphaFormat)return w.LUMINANCE_ALPHA;if(a===b.DepthFormat)return w.DEPTH_COMPONENT;
if(a===b.AddEquation)return w.FUNC_ADD;if(a===b.SubtractEquation)return w.FUNC_SUBTRACT;if(a===b.ReverseSubtractEquation)return w.FUNC_REVERSE_SUBTRACT;if(a===b.ZeroFactor)return w.ZERO;if(a===b.OneFactor)return w.ONE;if(a===b.SrcColorFactor)return w.SRC_COLOR;if(a===b.OneMinusSrcColorFactor)return w.ONE_MINUS_SRC_COLOR;if(a===b.SrcAlphaFactor)return w.SRC_ALPHA;if(a===b.OneMinusSrcAlphaFactor)return w.ONE_MINUS_SRC_ALPHA;if(a===b.DstAlphaFactor)return w.DST_ALPHA;if(a===b.OneMinusDstAlphaFactor)return w.ONE_MINUS_DST_ALPHA;
if(a===b.DstColorFactor)return w.DST_COLOR;if(a===b.OneMinusDstColorFactor)return w.ONE_MINUS_DST_COLOR;if(a===b.SrcAlphaSaturateFactor)return w.SRC_ALPHA_SATURATE;c=ka.get("WEBGL_compressed_texture_s3tc");if(null!==c){if(a===b.RGB_S3TC_DXT1_Format)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===b.RGBA_S3TC_DXT1_Format)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===b.RGBA_S3TC_DXT3_Format)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===b.RGBA_S3TC_DXT5_Format)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}c=ka.get("WEBGL_compressed_texture_pvrtc");
if(null!==c){if(a===b.RGB_PVRTC_4BPPV1_Format)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===b.RGB_PVRTC_2BPPV1_Format)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===b.RGBA_PVRTC_4BPPV1_Format)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===b.RGBA_PVRTC_2BPPV1_Format)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}c=ka.get("WEBGL_compressed_texture_etc1");if(null!==c&&a===b.RGB_ETC1_Format)return c.COMPRESSED_RGB_ETC1_WEBGL;c=ka.get("EXT_blend_minmax");if(null!==c){if(a===b.MinEquation)return c.MIN_EXT;
if(a===b.MaxEquation)return c.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",b.REVISION);a=a||{};var D=void 0!==a.canvas?a.canvas:document.createElement("canvas"),S=void 0!==a.context?a.context:null,B=void 0!==a.alpha?a.alpha:!1,N=void 0!==a.depth?a.depth:!0,G=void 0!==a.stencil?a.stencil:!0,P=void 0!==a.antialias?a.antialias:!1,J=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,V=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,U=[],sa=[],Na=-1,ca=[],ua=-1,Y=new Float32Array(8),
ta=[],ra=[];this.domElement=D;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMapping=b.LinearToneMapping;this.toneMappingWhitePoint=this.toneMappingExposure=1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;var ja=this,pa=null,Ca=null,Da=null,R=-1,xa="",ya=null,Ka=
new b.Vector4,la=null,W=new b.Vector4,Z=0,ia=new b.Color(0),aa=0,fa=D.width,da=D.height,ga=1,ma=new b.Vector4(0,0,fa,da),ba=!1,na=new b.Vector4(0,0,fa,da),$=new b.Frustum,Qa=!1,La=!1,Ea=!1,Aa=0,oa={type:"4fv",value:null,needsUpdate:!1},Ba=null,va=0,eb=new b.Matrix3,ab=new b.Sphere,fb=new b.Plane,Ra=new b.Matrix4,qa=new b.Vector3,ea={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],
hemi:[],shadows:[]},Ha={geometries:0,textures:0},Oa={calls:0,vertices:0,faces:0,points:0};this.info={render:Oa,memory:Ha,programs:null};var w;try{B={alpha:B,depth:N,stencil:G,antialias:P,premultipliedAlpha:J,preserveDrawingBuffer:V};w=S||D.getContext("webgl",B)||D.getContext("experimental-webgl",B);if(null===w){if(null!==D.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context.";}void 0===w.getShaderPrecisionFormat&&(w.getShaderPrecisionFormat=
function(){return{rangeMin:1,rangeMax:1,precision:1}});D.addEventListener("webglcontextlost",f,!1)}catch(gb){console.error("THREE.WebGLRenderer: "+gb)}var Pa="undefined"!==typeof WebGL2RenderingContext&&w instanceof WebGL2RenderingContext,ka=new b.WebGLExtensions(w);ka.get("WEBGL_depth_texture");ka.get("OES_texture_float");ka.get("OES_texture_float_linear");ka.get("OES_texture_half_float");ka.get("OES_texture_half_float_linear");ka.get("OES_standard_derivatives");ka.get("ANGLE_instanced_arrays");
ka.get("OES_element_index_uint")&&(b.BufferGeometry.MaxIndex=4294967296);var wa=new b.WebGLCapabilities(w,ka,a),T=new b.WebGLState(w,ka,I),ha=new b.WebGLProperties,Ia=new b.WebGLObjects(w,ha,this.info),Fa=new b.WebGLPrograms(this,wa),Ua=new b.WebGLLights;this.info.programs=Fa.programs;var Va=new b.WebGLBufferRenderer(w,ka,Oa),bb=new b.WebGLIndexedBufferRenderer(w,ka,Oa);d();this.context=w;this.capabilities=wa;this.extensions=ka;this.properties=ha;this.state=T;var cb=new b.WebGLShadowMap(this,ea,Ia);
this.shadowMap=cb;var Wa=new b.SpritePlugin(this,ta),Xa=new b.LensFlarePlugin(this,ra);this.getContext=function(){return w};this.getContextAttributes=function(){return w.getContextAttributes()};this.forceContextLoss=function(){ka.get("WEBGL_lose_context").loseContext()};this.getMaxAnisotropy=function(){var a;return function(){if(void 0!==a)return a;var b=ka.get("EXT_texture_filter_anisotropic");return a=null!==b?w.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}();this.getPrecision=function(){return wa.precision};
this.getPixelRatio=function(){return ga};this.setPixelRatio=function(a){void 0!==a&&(ga=a,this.setSize(na.z,na.w,!1))};this.getSize=function(){return{width:fa,height:da}};this.setSize=function(a,b,c){fa=a;da=b;D.width=a*ga;D.height=b*ga;!1!==c&&(D.style.width=a+"px",D.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){T.viewport(na.set(a,b,c,d))};this.setScissor=function(a,b,c,d){T.scissor(ma.set(a,b,c,d))};this.setScissorTest=function(a){T.setScissorTest(ba=a)};this.getClearColor=
function(){return ia};this.setClearColor=function(a,b){ia.set(a);aa=void 0!==b?b:1;c(ia.r,ia.g,ia.b,aa)};this.getClearAlpha=function(){return aa};this.setClearAlpha=function(a){aa=a;c(ia.r,ia.g,ia.b,aa)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=w.COLOR_BUFFER_BIT;if(void 0===b||b)d|=w.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=w.STENCIL_BUFFER_BIT;w.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,
!1,!0)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.resetGLState=e;this.dispose=function(){D.removeEventListener("webglcontextlost",f,!1)};this.renderBufferImmediate=function(a,c,d){T.initAttributes();var e=ha.get(a);a.hasPositions&&!e.position&&(e.position=w.createBuffer());a.hasNormals&&!e.normal&&(e.normal=w.createBuffer());a.hasUvs&&!e.uv&&(e.uv=w.createBuffer());a.hasColors&&!e.color&&(e.color=w.createBuffer());c=c.getAttributes();a.hasPositions&&(w.bindBuffer(w.ARRAY_BUFFER,
e.position),w.bufferData(w.ARRAY_BUFFER,a.positionArray,w.DYNAMIC_DRAW),T.enableAttribute(c.position),w.vertexAttribPointer(c.position,3,w.FLOAT,!1,0,0));if(a.hasNormals){w.bindBuffer(w.ARRAY_BUFFER,e.normal);if("MeshPhongMaterial"!==d.type&&"MeshStandardMaterial"!==d.type&&"MeshPhysicalMaterial"!==d.type&&d.shading===b.FlatShading)for(var f=0,k=3*a.count;f<k;f+=9){var h=a.normalArray,g=(h[f+0]+h[f+3]+h[f+6])/3,l=(h[f+1]+h[f+4]+h[f+7])/3,m=(h[f+2]+h[f+5]+h[f+8])/3;h[f+0]=g;h[f+1]=l;h[f+2]=m;h[f+3]=
g;h[f+4]=l;h[f+5]=m;h[f+6]=g;h[f+7]=l;h[f+8]=m}w.bufferData(w.ARRAY_BUFFER,a.normalArray,w.DYNAMIC_DRAW);T.enableAttribute(c.normal);w.vertexAttribPointer(c.normal,3,w.FLOAT,!1,0,0)}a.hasUvs&&d.map&&(w.bindBuffer(w.ARRAY_BUFFER,e.uv),w.bufferData(w.ARRAY_BUFFER,a.uvArray,w.DYNAMIC_DRAW),T.enableAttribute(c.uv),w.vertexAttribPointer(c.uv,2,w.FLOAT,!1,0,0));a.hasColors&&d.vertexColors!==b.NoColors&&(w.bindBuffer(w.ARRAY_BUFFER,e.color),w.bufferData(w.ARRAY_BUFFER,a.colorArray,w.DYNAMIC_DRAW),T.enableAttribute(c.color),
w.vertexAttribPointer(c.color,3,w.FLOAT,!1,0,0));T.disableUnusedAttributes();w.drawArrays(w.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,k){v(e);var h=q(a,c,e,f),g=!1;a=d.id+"_"+h.id+"_"+e.wireframe;a!==xa&&(xa=a,g=!0);c=f.morphTargetInfluences;if(void 0!==c){a=[];for(var l=0,g=c.length;l<g;l++){var m=c[l];a.push([m,l])}a.sort(y);8<a.length&&(a.length=8);for(var n=d.morphAttributes,l=0,g=a.length;l<g;l++)m=a[l],Y[l]=m[0],0!==m[0]?(c=m[1],!0===e.morphTargets&&n.position&&
d.addAttribute("morphTarget"+l,n.position[c]),!0===e.morphNormals&&n.normal&&d.addAttribute("morphNormal"+l,n.normal[c])):(!0===e.morphTargets&&d.removeAttribute("morphTarget"+l),!0===e.morphNormals&&d.removeAttribute("morphNormal"+l));h.getUniforms().setValue(w,"morphTargetInfluences",Y);g=!0}c=d.index;l=d.attributes.position;!0===e.wireframe&&(c=Ia.getWireframeAttribute(d));null!==c?(a=bb,a.setIndex(c)):a=Va;if(g){a:{var g=void 0,s;if(d instanceof b.InstancedBufferGeometry&&(s=ka.get("ANGLE_instanced_arrays"),
null===s)){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");break a}void 0===g&&(g=0);T.initAttributes();var m=d.attributes,h=h.getAttributes(),n=e.defaultAttributeValues,p;for(p in h){var r=h[p];if(0<=r){var x=m[p];if(void 0!==x){var u=w.FLOAT,t=x.array,z=x.normalized;t instanceof Float32Array?u=w.FLOAT:t instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):
t instanceof Uint16Array?u=w.UNSIGNED_SHORT:t instanceof Int16Array?u=w.SHORT:t instanceof Uint32Array?u=w.UNSIGNED_INT:t instanceof Int32Array?u=w.INT:t instanceof Int8Array?u=w.BYTE:t instanceof Uint8Array&&(u=w.UNSIGNED_BYTE);var t=x.itemSize,G=Ia.getAttributeBuffer(x);if(x instanceof b.InterleavedBufferAttribute){var A=x.data,J=A.stride,x=x.offset;A instanceof b.InstancedInterleavedBuffer?(T.enableAttributeAndDivisor(r,A.meshPerAttribute,s),void 0===d.maxInstancedCount&&(d.maxInstancedCount=A.meshPerAttribute*
A.count)):T.enableAttribute(r);w.bindBuffer(w.ARRAY_BUFFER,G);w.vertexAttribPointer(r,t,u,z,J*A.array.BYTES_PER_ELEMENT,(g*J+x)*A.array.BYTES_PER_ELEMENT)}else x instanceof b.InstancedBufferAttribute?(T.enableAttributeAndDivisor(r,x.meshPerAttribute,s),void 0===d.maxInstancedCount&&(d.maxInstancedCount=x.meshPerAttribute*x.count)):T.enableAttribute(r),w.bindBuffer(w.ARRAY_BUFFER,G),w.vertexAttribPointer(r,t,u,z,0,g*t*x.array.BYTES_PER_ELEMENT)}else if(void 0!==n&&(u=n[p],void 0!==u))switch(u.length){case 2:w.vertexAttrib2fv(r,
u);break;case 3:w.vertexAttrib3fv(r,u);break;case 4:w.vertexAttrib4fv(r,u);break;default:w.vertexAttrib1fv(r,u)}}}T.disableUnusedAttributes()}null!==c&&w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,Ia.getAttributeBuffer(c))}s=Infinity;null!==c?s=c.count:void 0!==l&&(s=l.count);p=d.drawRange.start;c=d.drawRange.count;l=null!==k?k.start:0;g=null!==k?k.count:Infinity;k=Math.max(0,p,l);s=Math.min(0+s,p+c,l+g)-1;s=Math.max(0,s-k+1);if(f instanceof b.Mesh)if(!0===e.wireframe)T.setLineWidth(e.wireframeLinewidth*(null===
Ca?ga:1)),a.setMode(w.LINES);else switch(f.drawMode){case b.TrianglesDrawMode:a.setMode(w.TRIANGLES);break;case b.TriangleStripDrawMode:a.setMode(w.TRIANGLE_STRIP);break;case b.TriangleFanDrawMode:a.setMode(w.TRIANGLE_FAN)}else f instanceof b.Line?(e=e.linewidth,void 0===e&&(e=1),T.setLineWidth(e*(null===Ca?ga:1)),f instanceof b.LineSegments?a.setMode(w.LINES):a.setMode(w.LINE_STRIP)):f instanceof b.Points&&a.setMode(w.POINTS);d instanceof b.InstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,
k,s):a.render(k,s)};this.render=function(a,c,d,e){if(!1===c instanceof b.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var f=a.fog;xa="";R=-1;ya=null;!0===a.autoUpdate&&a.updateMatrixWorld();null===c.parent&&c.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);Ra.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);$.setFromMatrix(Ra);U.length=0;ua=Na=-1;ta.length=0;ra.length=0;var k=this.clippingPlanes;Qa=0!==ja.clippingPlanes.length||
ja.localClippingEnabled||0!==va||La;La=ja.localClippingEnabled;Ba=K(k,c,0);va=null!==k?k.length:0;n(a,c);sa.length=Na+1;ca.length=ua+1;!0===ja.sortObjects&&(sa.sort(p),ca.sort(u));Qa&&(Ea=!0,K(null));for(var k=U,h=0,g=0,l=k.length;g<l;g++){var m=k[g];m.castShadow&&(ea.shadows[h++]=m)}ea.shadows.length=h;cb.render(a,c);for(var k=U,s=m=0,r=0,x,q,y,v=c.matrixWorldInverse,z=0,G=0,J=0,P=0,h=0,g=k.length;h<g;h++)if(l=k[h],x=l.color,q=l.intensity,y=l.distance,l instanceof b.AmbientLight)m+=x.r*q,s+=x.g*
q,r+=x.b*q;else if(l instanceof b.DirectionalLight){var Y=Ua.get(l);Y.color.copy(l.color).multiplyScalar(l.intensity);Y.direction.setFromMatrixPosition(l.matrixWorld);qa.setFromMatrixPosition(l.target.matrixWorld);Y.direction.sub(qa);Y.direction.transformDirection(v);if(Y.shadow=l.castShadow)Y.shadowBias=l.shadow.bias,Y.shadowRadius=l.shadow.radius,Y.shadowMapSize=l.shadow.mapSize;ea.directionalShadowMap[z]=l.shadow.map;ea.directionalShadowMatrix[z]=l.shadow.matrix;ea.directional[z++]=Y}else if(l instanceof
b.SpotLight){Y=Ua.get(l);Y.position.setFromMatrixPosition(l.matrixWorld);Y.position.applyMatrix4(v);Y.color.copy(x).multiplyScalar(q);Y.distance=y;Y.direction.setFromMatrixPosition(l.matrixWorld);qa.setFromMatrixPosition(l.target.matrixWorld);Y.direction.sub(qa);Y.direction.transformDirection(v);Y.coneCos=Math.cos(l.angle);Y.penumbraCos=Math.cos(l.angle*(1-l.penumbra));Y.decay=0===l.distance?0:l.decay;if(Y.shadow=l.castShadow)Y.shadowBias=l.shadow.bias,Y.shadowRadius=l.shadow.radius,Y.shadowMapSize=
l.shadow.mapSize;ea.spotShadowMap[J]=l.shadow.map;ea.spotShadowMatrix[J]=l.shadow.matrix;ea.spot[J++]=Y}else if(l instanceof b.PointLight){Y=Ua.get(l);Y.position.setFromMatrixPosition(l.matrixWorld);Y.position.applyMatrix4(v);Y.color.copy(l.color).multiplyScalar(l.intensity);Y.distance=l.distance;Y.decay=0===l.distance?0:l.decay;if(Y.shadow=l.castShadow)Y.shadowBias=l.shadow.bias,Y.shadowRadius=l.shadow.radius,Y.shadowMapSize=l.shadow.mapSize;ea.pointShadowMap[G]=l.shadow.map;void 0===ea.pointShadowMatrix[G]&&
(ea.pointShadowMatrix[G]=new b.Matrix4);qa.setFromMatrixPosition(l.matrixWorld).negate();ea.pointShadowMatrix[G].identity().setPosition(qa);ea.point[G++]=Y}else l instanceof b.HemisphereLight&&(Y=Ua.get(l),Y.direction.setFromMatrixPosition(l.matrixWorld),Y.direction.transformDirection(v),Y.direction.normalize(),Y.skyColor.copy(l.color).multiplyScalar(q),Y.groundColor.copy(l.groundColor).multiplyScalar(q),ea.hemi[P++]=Y);ea.ambient[0]=m;ea.ambient[1]=s;ea.ambient[2]=r;ea.directional.length=z;ea.spot.length=
J;ea.point.length=G;ea.hemi.length=P;ea.hash=z+","+G+","+J+","+P+","+ea.shadows.length;Qa&&(Ea=!1,A());Oa.calls=0;Oa.vertices=0;Oa.faces=0;Oa.points=0;void 0===d&&(d=null);this.setRenderTarget(d);(this.autoClear||e)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);a.overrideMaterial?(e=a.overrideMaterial,t(sa,c,f,e),t(ca,c,f,e)):(T.setBlending(b.NoBlending),t(sa,c,f),t(ca,c,f));Wa.render(a,c);Xa.render(a,c,W);d&&(a=d.texture,a.generateMipmaps&&E(d)&&a.minFilter!==b.NearestFilter&&
a.minFilter!==b.LinearFilter&&(a=d instanceof b.WebGLRenderTargetCube?w.TEXTURE_CUBE_MAP:w.TEXTURE_2D,d=ha.get(d.texture).__webglTexture,T.bindTexture(a,d),w.generateMipmap(a),T.bindTexture(a,null)));T.setDepthTest(!0);T.setDepthWrite(!0);T.setColorWrite(!0)}};this.setFaceCulling=function(a,c){a===b.CullFaceNone?T.disable(w.CULL_FACE):(c===b.FrontFaceDirectionCW?w.frontFace(w.CW):w.frontFace(w.CCW),a===b.CullFaceBack?w.cullFace(w.BACK):a===b.CullFaceFront?w.cullFace(w.FRONT):w.cullFace(w.FRONT_AND_BACK),
T.enable(w.CULL_FACE))};var Ya=!1;this.setTexture=function(a,b){Ya||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),Ya=!0);F(a,b)};this.allocTextureUnit=function(){var a=Z;a>=wa.maxTextures&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+wa.maxTextures);Z+=1;return a};this.setTexture2D=F;this.setTextureCube=function(a,c){if(a instanceof b.CubeTexture||Array.isArray(a.image)&&6===a.image.length){var d=ha.get(a);
if(6===a.image.length)if(0<a.version&&d.__version!==a.version){d.__image__webglTextureCube||(a.addEventListener("dispose",h),d.__image__webglTextureCube=w.createTexture(),Ha.textures++);T.activeTexture(w.TEXTURE0+c);T.bindTexture(w.TEXTURE_CUBE_MAP,d.__image__webglTextureCube);w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,a.flipY);for(var e=a instanceof b.CompressedTexture,f=a.image[0]instanceof b.DataTexture,k=[],g=0;6>g;g++)k[g]=!ja.autoScaleCubemaps||e||f?f?a.image[g].image:a.image[g]:H(a.image[g],wa.maxCubemapSize);
var l=E(k[0]),m=I(a.format),n=I(a.type);C(w.TEXTURE_CUBE_MAP,a,l);for(g=0;6>g;g++)if(e)for(var s,p=k[g].mipmaps,r=0,x=p.length;r<x;r++)s=p[r],a.format!==b.RGBAFormat&&a.format!==b.RGBFormat?-1<T.getCompressedTextureFormats().indexOf(m)?T.compressedTexImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,m,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):T.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,m,s.width,s.height,0,
m,n,s.data);else f?T.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,m,k[g].width,k[g].height,0,m,n,k[g].data):T.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,m,m,n,k[g]);a.generateMipmaps&&l&&w.generateMipmap(w.TEXTURE_CUBE_MAP);d.__version=a.version;if(a.onUpdate)a.onUpdate(a)}else T.activeTexture(w.TEXTURE0+c),T.bindTexture(w.TEXTURE_CUBE_MAP,d.__image__webglTextureCube)}else d=a.texture,T.activeTexture(w.TEXTURE0+c),T.bindTexture(w.TEXTURE_CUBE_MAP,ha.get(d).__webglTexture)};this.getCurrentRenderTarget=
function(){return Ca};this.setRenderTarget=function(a){if((Ca=a)&&void 0===ha.get(a).__webglFramebuffer){var c=ha.get(a),d=ha.get(a.texture);a.addEventListener("dispose",k);d.__webglTexture=w.createTexture();Ha.textures++;var e=a instanceof b.WebGLRenderTargetCube,f=b.Math.isPowerOfTwo(a.width)&&b.Math.isPowerOfTwo(a.height);if(e){c.__webglFramebuffer=[];for(var h=0;6>h;h++)c.__webglFramebuffer[h]=w.createFramebuffer()}else c.__webglFramebuffer=w.createFramebuffer();if(e){T.bindTexture(w.TEXTURE_CUBE_MAP,
d.__webglTexture);C(w.TEXTURE_CUBE_MAP,a.texture,f);for(h=0;6>h;h++)X(c.__webglFramebuffer[h],a,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+h);a.texture.generateMipmaps&&f&&w.generateMipmap(w.TEXTURE_CUBE_MAP);T.bindTexture(w.TEXTURE_CUBE_MAP,null)}else T.bindTexture(w.TEXTURE_2D,d.__webglTexture),C(w.TEXTURE_2D,a.texture,f),X(c.__webglFramebuffer,a,w.COLOR_ATTACHMENT0,w.TEXTURE_2D),a.texture.generateMipmaps&&f&&w.generateMipmap(w.TEXTURE_2D),T.bindTexture(w.TEXTURE_2D,null);if(a.depthBuffer){c=
ha.get(a);d=a instanceof b.WebGLRenderTargetCube;if(a.depthTexture){if(d)throw Error("target.depthTexture not supported in Cube render targets");if(a instanceof b.WebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported!");w.bindFramebuffer(w.FRAMEBUFFER,c.__webglFramebuffer);if(!(a.depthTexture instanceof b.DepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");ha.get(a.depthTexture).__webglTexture&&a.depthTexture.image.width===
a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0);ja.setTexture(a.depthTexture,0);c=ha.get(a.depthTexture).__webglTexture;w.framebufferTexture2D(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.TEXTURE_2D,c,0)}else if(d)for(c.__webglDepthbuffer=[],d=0;6>d;d++)w.bindFramebuffer(w.FRAMEBUFFER,c.__webglFramebuffer[d]),c.__webglDepthbuffer[d]=w.createRenderbuffer(),M(c.__webglDepthbuffer[d],a);else w.bindFramebuffer(w.FRAMEBUFFER,
c.__webglFramebuffer),c.__webglDepthbuffer=w.createRenderbuffer(),M(c.__webglDepthbuffer,a);w.bindFramebuffer(w.FRAMEBUFFER,null)}}c=a instanceof b.WebGLRenderTargetCube;a?(d=ha.get(a),d=c?d.__webglFramebuffer[a.activeCubeFace]:d.__webglFramebuffer,Ka.copy(a.scissor),la=a.scissorTest,W.copy(a.viewport)):(d=null,Ka.copy(ma).multiplyScalar(ga),la=ba,W.copy(na).multiplyScalar(ga));Da!==d&&(w.bindFramebuffer(w.FRAMEBUFFER,d),Da=d);T.scissor(Ka);T.setScissorTest(la);T.viewport(W);c&&(c=ha.get(a.texture),
w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,c.__webglTexture,a.activeMipMapLevel))};this.readRenderTargetPixels=function(a,c,d,e,f,k){if(!1===a instanceof b.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var h=ha.get(a).__webglFramebuffer;if(h){var g=!1;h!==Da&&(w.bindFramebuffer(w.FRAMEBUFFER,h),g=!0);try{var l=a.texture;l.format!==b.RGBAFormat&&I(l.format)!==
w.getParameter(w.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):l.type===b.UnsignedByteType||I(l.type)===w.getParameter(w.IMPLEMENTATION_COLOR_READ_TYPE)||l.type===b.FloatType&&ka.get("WEBGL_color_buffer_float")||l.type===b.HalfFloatType&&ka.get("EXT_color_buffer_half_float")?w.checkFramebufferStatus(w.FRAMEBUFFER)===w.FRAMEBUFFER_COMPLETE?0<c&&c<=a.width-e&&0<d&&d<=a.height-f&&w.readPixels(c,
d,e,f,I(l.format),I(l.type),k):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{g&&w.bindFramebuffer(w.FRAMEBUFFER,Da)}}}}};b.WebGLRenderTarget=function(a,c,d){this.uuid=b.Math.generateUUID();this.width=a;this.height=c;this.scissor=new b.Vector4(0,0,a,c);this.scissorTest=!1;this.viewport=
new b.Vector4(0,0,a,c);d=d||{};void 0===d.minFilter&&(d.minFilter=b.LinearFilter);this.texture=new b.Texture(void 0,void 0,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding);this.depthBuffer=void 0!==d.depthBuffer?d.depthBuffer:!0;this.stencilBuffer=void 0!==d.stencilBuffer?d.stencilBuffer:!0;this.depthTexture=null};b.WebGLRenderTarget.prototype={constructor:b.WebGLRenderTarget,setSize:function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();
this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};b.EventDispatcher.prototype.apply(b.WebGLRenderTarget.prototype);b.WebGLRenderTargetCube=function(a,
c,d){b.WebGLRenderTarget.call(this,a,c,d);this.activeMipMapLevel=this.activeCubeFace=0};b.WebGLRenderTargetCube.prototype=Object.create(b.WebGLRenderTarget.prototype);b.WebGLRenderTargetCube.prototype.constructor=b.WebGLRenderTargetCube;b.WebGLBufferRenderer=function(a,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,c){a.drawArrays(e,b,c);d.calls++;d.vertices+=c;e===a.TRIANGLES&&(d.faces+=c/3)};this.renderInstances=function(f){var h=c.get("ANGLE_instanced_arrays");if(null===h)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
else{var k=f.attributes.position,g=0,g=k instanceof b.InterleavedBufferAttribute?k.data.count:k.count;h.drawArraysInstancedANGLE(e,0,g,f.maxInstancedCount);d.calls++;d.vertices+=g*f.maxInstancedCount;e===a.TRIANGLES&&(d.faces+=f.maxInstancedCount*g/3)}}};b.WebGLIndexedBufferRenderer=function(a,b,d){var e,f,h;this.setMode=function(a){e=a};this.setIndex=function(d){d.array instanceof Uint32Array&&b.get("OES_element_index_uint")?(f=a.UNSIGNED_INT,h=4):(f=a.UNSIGNED_SHORT,h=2)};this.render=function(b,
c){a.drawElements(e,c,f,b*h);d.calls++;d.vertices+=c;e===a.TRIANGLES&&(d.faces+=c/3)};this.renderInstances=function(k,g,m){var y=b.get("ANGLE_instanced_arrays");null===y?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(y.drawElementsInstancedANGLE(e,m,f,g*h,k.maxInstancedCount),d.calls++,d.vertices+=m*k.maxInstancedCount,e===a.TRIANGLES&&(d.faces+=k.maxInstancedCount*m/3))}};b.WebGLExtensions=function(a){var b=
{};this.get=function(d){if(void 0!==b[d])return b[d];var e;switch(d){case "WEBGL_depth_texture":a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");case "EXT_texture_filter_anisotropic":e=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":e=a.getExtension("WEBGL_compressed_texture_s3tc")||
a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":e=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case "WEBGL_compressed_texture_etc1":e=a.getExtension("WEBGL_compressed_texture_etc1");break;default:e=a.getExtension(d)}null===e&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported.");return b[d]=e}};b.WebGLCapabilities=
function(a,b,d){function e(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=e;this.precision=void 0!==d.precision?d.precision:"highp";this.logarithmicDepthBuffer=
void 0!==d.logarithmicDepthBuffer?d.logarithmicDepthBuffer:!1;this.maxTextures=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);this.maxVertexTextures=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.maxCubemapSize=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);this.maxAttributes=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.maxVertexUniforms=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);this.maxVaryings=a.getParameter(a.MAX_VARYING_VECTORS);this.maxFragmentUniforms=
a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS);this.vertexTextures=0<this.maxVertexTextures;this.floatFragmentTextures=!!b.get("OES_texture_float");this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;d=e(this.precision);d!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",d,"instead."),this.precision=d);this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!b.get("EXT_frag_depth"))};b.WebGLGeometries=function(a,c,d){function e(a){var b=
a.target;a=h[b.id];null!==a.index&&f(a.index);var g=a.attributes,m;for(m in g)f(g[m]);b.removeEventListener("dispose",e);delete h[b.id];m=c.get(b);m.wireframe&&f(m.wireframe);c.delete(b);b=c.get(a);b.wireframe&&f(b.wireframe);c.delete(a);d.memory.geometries--}function f(d){var e;e=d instanceof b.InterleavedBufferAttribute?c.get(d.data).__webglBuffer:c.get(d).__webglBuffer;void 0!==e&&(a.deleteBuffer(e),d instanceof b.InterleavedBufferAttribute?c.delete(d.data):c.delete(d))}var h={};this.get=function(a){var c=
a.geometry;if(void 0!==h[c.id])return h[c.id];c.addEventListener("dispose",e);var f;c instanceof b.BufferGeometry?f=c:c instanceof b.Geometry&&(void 0===c._bufferGeometry&&(c._bufferGeometry=(new b.BufferGeometry).setFromObject(a)),f=c._bufferGeometry);h[c.id]=f;d.memory.geometries++;return f}};b.WebGLLights=function(){var a={};this.get=function(c){if(void 0!==a[c.id])return a[c.id];var d;switch(c.type){case "DirectionalLight":d={direction:new b.Vector3,color:new b.Color,shadow:!1,shadowBias:0,shadowRadius:1,
shadowMapSize:new b.Vector2};break;case "SpotLight":d={position:new b.Vector3,direction:new b.Vector3,color:new b.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new b.Vector2};break;case "PointLight":d={position:new b.Vector3,color:new b.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new b.Vector2};break;case "HemisphereLight":d={direction:new b.Vector3,skyColor:new b.Color,groundColor:new b.Color}}return a[c.id]=
d}};b.WebGLObjects=function(a,c,d){function e(d,e){var f=d instanceof b.InterleavedBufferAttribute?d.data:d,h=c.get(f);void 0===h.__webglBuffer?(h.__webglBuffer=a.createBuffer(),a.bindBuffer(e,h.__webglBuffer),a.bufferData(e,f.array,f.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW),h.version=f.version):h.version!==f.version&&(a.bindBuffer(e,h.__webglBuffer),!1===f.dynamic||-1===f.updateRange.count?a.bufferSubData(e,0,f.array):0===f.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):
(a.bufferSubData(e,f.updateRange.offset*f.array.BYTES_PER_ELEMENT,f.array.subarray(f.updateRange.offset,f.updateRange.offset+f.updateRange.count)),f.updateRange.count=0),h.version=f.version)}function f(a,b,c){if(b>c){var d=b;b=c;c=d}d=a[b];return void 0===d?(a[b]=[c],!0):-1===d.indexOf(c)?(d.push(c),!0):!1}var h=new b.WebGLGeometries(a,c,d);this.getAttributeBuffer=function(a){return a instanceof b.InterleavedBufferAttribute?c.get(a.data).__webglBuffer:c.get(a).__webglBuffer};this.getWireframeAttribute=
function(d){var h=c.get(d);if(void 0!==h.wireframe)return h.wireframe;var g=[],m=d.index,p=d.attributes;d=p.position;if(null!==m)for(var p={},m=m.array,u=0,l=m.length;u<l;u+=3){var r=m[u+0],n=m[u+1],t=m[u+2];f(p,r,n)&&g.push(r,n);f(p,n,t)&&g.push(n,t);f(p,t,r)&&g.push(t,r)}else for(m=p.position.array,u=0,l=m.length/3-1;u<l;u+=3)r=u+0,n=u+1,t=u+2,g.push(r,n,n,t,t,r);g=new b.BufferAttribute(new (65535<d.count?Uint32Array:Uint16Array)(g),1);e(g,a.ELEMENT_ARRAY_BUFFER);return h.wireframe=g};this.update=
function(c){var d=h.get(c);c.geometry instanceof b.Geometry&&d.updateFromObject(c);c=d.index;var f=d.attributes;null!==c&&e(c,a.ELEMENT_ARRAY_BUFFER);for(var g in f)e(f[g],a.ARRAY_BUFFER);c=d.morphAttributes;for(g in c)for(var f=c[g],m=0,u=f.length;m<u;m++)e(f[m],a.ARRAY_BUFFER);return d}};b.WebGLProgram=function(){function a(a){switch(a){case b.LinearEncoding:return["Linear","( value )"];case b.sRGBEncoding:return["sRGB","( value )"];case b.RGBEEncoding:return["RGBE","( value )"];case b.RGBM7Encoding:return["RGBM",
"( value, 7.0 )"];case b.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case b.RGBDEncoding:return["RGBD","( value, 256.0 )"];case b.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function c(b,c){var d=a(c);return"vec4 "+b+"( vec4 value ) { return "+d[0]+"ToLinear"+d[1]+"; }"}function d(b,c){var d=a(c);return"vec4 "+b+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"}function e(a,c){var d;switch(c){case b.LinearToneMapping:d="Linear";
break;case b.ReinhardToneMapping:d="Reinhard";break;case b.Uncharted2ToneMapping:d="Uncharted2";break;case b.CineonToneMapping:d="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+c);}return"vec3 "+a+"( vec3 color ) { return "+d+"ToneMapping( color ); }"}function f(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":
"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(k).join("\n")}function h(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function k(a){return""!==a}function g(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,
b.numHemiLights)}function m(a){return a.replace(/#include +<([\w\d.]+)>/g,function(a,c){var d=b.ShaderChunk[c];if(void 0===d)throw Error("Can not resolve #include <"+c+">");return m(d)})}function t(a){return a.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,b,c,d){a="";for(b=parseInt(b);b<parseInt(c);b++)a+=d.replace(/\[ i \]/g,"[ "+b+" ]");return a})}var p=0;return function(a,l,r,n){var v=a.context,L=r.extensions,q=r.defines,z=r.__webglShader.vertexShader,
K=r.__webglShader.fragmentShader,A="SHADOWMAP_TYPE_BASIC";n.shadowMapType===b.PCFShadowMap?A="SHADOWMAP_TYPE_PCF":n.shadowMapType===b.PCFSoftShadowMap&&(A="SHADOWMAP_TYPE_PCF_SOFT");var C="ENVMAP_TYPE_CUBE",F="ENVMAP_MODE_REFLECTION",H="ENVMAP_BLENDING_MULTIPLY";if(n.envMap){switch(r.envMap.mapping){case b.CubeReflectionMapping:case b.CubeRefractionMapping:C="ENVMAP_TYPE_CUBE";break;case b.CubeUVReflectionMapping:case b.CubeUVRefractionMapping:C="ENVMAP_TYPE_CUBE_UV";break;case b.EquirectangularReflectionMapping:case b.EquirectangularRefractionMapping:C=
"ENVMAP_TYPE_EQUIREC";break;case b.SphericalReflectionMapping:C="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case b.CubeRefractionMapping:case b.EquirectangularRefractionMapping:F="ENVMAP_MODE_REFRACTION"}switch(r.combine){case b.MultiplyOperation:H="ENVMAP_BLENDING_MULTIPLY";break;case b.MixOperation:H="ENVMAP_BLENDING_MIX";break;case b.AddOperation:H="ENVMAP_BLENDING_ADD"}}var E=0<a.gammaFactor?a.gammaFactor:1,L=f(L,n,a.extensions),X=h(q),M=v.createProgram();r instanceof b.RawShaderMaterial?A=
q="":(q=["precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+r.__webglShader.name,X,n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+E,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+F:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":
"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":
"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;",
"uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;",
"\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(k).join("\n"),A=[L,"precision "+n.precision+" float;","precision "+n.precision+" int;","#define SHADER_NAME "+r.__webglShader.name,X,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"","#define GAMMA_FACTOR "+
E,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+C:"",n.envMap?"#define "+F:"",n.envMap?"#define "+H:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?
"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexColors?"#define USE_COLOR":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+n.numClippingPlanes,n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+A:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":
"",n.logarithmicDepthBuffer&&a.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",n.envMap&&a.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",n.toneMapping!==b.NoToneMapping?"#define TONE_MAPPING":"",n.toneMapping!==b.NoToneMapping?b.ShaderChunk.tonemapping_pars_fragment:"",n.toneMapping!==b.NoToneMapping?e("toneMapping",n.toneMapping):"",n.outputEncoding||n.mapEncoding||n.envMapEncoding||n.emissiveMapEncoding?
b.ShaderChunk.encodings_pars_fragment:"",n.mapEncoding?c("mapTexelToLinear",n.mapEncoding):"",n.envMapEncoding?c("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?c("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.outputEncoding?d("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(k).join("\n"));z=m(z,n);z=g(z,n);K=m(K,n);K=g(K,n);!1===r instanceof b.ShaderMaterial&&(z=t(z),K=t(K));K=A+K;z=b.WebGLShader(v,v.VERTEX_SHADER,
q+z);K=b.WebGLShader(v,v.FRAGMENT_SHADER,K);v.attachShader(M,z);v.attachShader(M,K);void 0!==r.index0AttributeName?v.bindAttribLocation(M,0,r.index0AttributeName):!0===n.morphTargets&&v.bindAttribLocation(M,0,"position");v.linkProgram(M);n=v.getProgramInfoLog(M);C=v.getShaderInfoLog(z);F=v.getShaderInfoLog(K);E=H=!0;if(!1===v.getProgramParameter(M,v.LINK_STATUS))H=!1,console.error("THREE.WebGLProgram: shader error: ",v.getError(),"gl.VALIDATE_STATUS",v.getProgramParameter(M,v.VALIDATE_STATUS),"gl.getProgramInfoLog",
n,C,F);else if(""!==n)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",n);else if(""===C||""===F)E=!1;E&&(this.diagnostics={runnable:H,material:r,programLog:n,vertexShader:{log:C,prefix:q},fragmentShader:{log:F,prefix:A}});v.deleteShader(z);v.deleteShader(K);var O;this.getUniforms=function(){void 0===O&&(O=new b.WebGLUniforms(v,M,a));return O};var I;this.getAttributes=function(){if(void 0===I){for(var a={},b=v.getProgramParameter(M,v.ACTIVE_ATTRIBUTES),c=0;c<b;c++){var d=v.getActiveAttrib(M,
c).name;a[d]=v.getAttribLocation(M,d)}I=a}return I};this.destroy=function(){v.deleteProgram(M);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.id=p++;this.code=l;this.usedTimes=1;this.program=M;this.vertexShader=z;this.fragmentShader=K;return this}}();
b.WebGLPrograms=function(a,c){function d(a,c){var d;a?a instanceof b.Texture?d=a.encoding:a instanceof b.WebGLRenderTarget&&(d=a.texture.encoding):d=b.LinearEncoding;d===b.LinearEncoding&&c&&(d=b.GammaEncoding);return d}var e=[],f={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},
h="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes depthPacking".split(" ");
this.getParameters=function(e,h,g,m,p){var u=f[e.type],l;c.floatVertexTextures&&p&&p.skeleton&&p.skeleton.useVertexTexture?l=1024:(l=Math.floor((c.maxVertexUniforms-20)/4),void 0!==p&&p instanceof b.SkinnedMesh&&(l=Math.min(p.skeleton.bones.length,l),l<p.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+p.skeleton.bones.length+", this GPU supports just "+l+" (try OpenGL instead of ANGLE)")));var r=a.getPrecision();null!==e.precision&&(r=c.getMaxPrecision(e.precision),r!==e.precision&&
console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",r,"instead."));return{shaderID:u,precision:r,supportsVertexTextures:c.vertexTextures,outputEncoding:d(a.getCurrentRenderTarget(),a.gammaOutput),map:!!e.map,mapEncoding:d(e.map,a.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:d(e.envMap,a.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===b.CubeUVReflectionMapping||e.envMap.mapping===b.CubeUVRefractionMapping),lightMap:!!e.lightMap,
aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:d(e.emissiveMap,a.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,combine:e.combine,vertexColors:e.vertexColors,fog:g,useFog:e.fog,fogExp:g instanceof b.FogExp2,flatShading:e.shading===b.FlatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:e.skinning,
maxBones:l,useVertexTexture:c.floatVertexTextures&&p&&p.skeleton&&p.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numHemiLights:h.hemi.length,numClippingPlanes:m,shadowMapEnabled:a.shadowMap.enabled&&p.receiveShadow&&0<h.shadows.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,
premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===b.DoubleSide,flipSided:e.side===b.BackSide,depthPacking:void 0!==e.depthPacking?e.depthPacking:!1}};this.getProgramCode=function(a,b){var c=[];b.shaderID?c.push(b.shaderID):(c.push(a.fragmentShader),c.push(a.vertexShader));if(void 0!==a.defines)for(var d in a.defines)c.push(d),c.push(a.defines[d]);for(d=0;d<h.length;d++)c.push(b[h[d]]);return c.join()};this.acquireProgram=function(c,d,f){for(var h,g=0,m=e.length;g<
m;g++){var l=e[g];if(l.code===f){h=l;++h.usedTimes;break}}void 0===h&&(h=new b.WebGLProgram(a,f,c,d),e.push(h));return h};this.releaseProgram=function(a){if(0===--a.usedTimes){var b=e.indexOf(a);e[b]=e[e.length-1];e.pop();a.destroy()}};this.programs=e};b.WebGLProperties=function(){var a={};this.get=function(b){b=b.uuid;var d=a[b];void 0===d&&(d={},a[b]=d);return d};this.delete=function(b){delete a[b.uuid]};this.clear=function(){a={}}};b.WebGLShader=function(){function a(a){a=a.split("\n");for(var b=
0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}return function(b,d,e){var f=b.createShader(d);b.shaderSource(f,e);b.compileShader(f);!1===b.getShaderParameter(f,b.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(f)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",d===b.VERTEX_SHADER?"vertex":"fragment",b.getShaderInfoLog(f),a(e));return f}}();b.WebGLShadowMap=function(a,c,d){function e(c,d,e,f){var h=c.geometry,g=null,g=n,k=c.customDepthMaterial;
e&&(g=v,k=c.customDistanceMaterial);k?g=k:(c=c instanceof b.SkinnedMesh&&d.skinning,k=0,void 0!==h.morphTargets&&0<h.morphTargets.length&&d.morphTargets&&(k|=1),c&&(k|=2),g=g[k]);a.localClippingEnabled&&!0===d.clipShadows&&0!==d.clippingPlanes.length&&(k=g.uuid,h=d.uuid,c=L[k],void 0===c&&(c={},L[k]=c),k=c[h],void 0===k&&(k=g.clone(),c[h]=k),g=k);g.visible=d.visible;g.wireframe=d.wireframe;g.side=d.side;g.clipShadows=d.clipShadows;g.clippingPlanes=d.clippingPlanes;g.wireframeLinewidth=d.wireframeLinewidth;
g.linewidth=d.linewidth;e&&void 0!==g.uniforms.lightPos&&g.uniforms.lightPos.value.copy(f);return g}function f(a,c,d){if(!1!==a.visible){a.layers.test(c.layers)&&(a instanceof b.Mesh||a instanceof b.Line||a instanceof b.Points)&&a.castShadow&&(!1===a.frustumCulled||!0===m.intersectsObject(a))&&!0===a.material.visible&&(a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld),r.push(a));a=a.children;for(var e=0,g=a.length;e<g;e++)f(a[e],c,d)}}var h=a.context,g=a.state,m=new b.Frustum,
t=new b.Matrix4,y=c.shadows,p=new b.Vector2,u=new b.Vector3,l=new b.Vector3,r=[],n=Array(4),v=Array(4),L={},q=[new b.Vector3(1,0,0),new b.Vector3(-1,0,0),new b.Vector3(0,0,1),new b.Vector3(0,0,-1),new b.Vector3(0,1,0),new b.Vector3(0,-1,0)],z=[new b.Vector3(0,1,0),new b.Vector3(0,1,0),new b.Vector3(0,1,0),new b.Vector3(0,1,0),new b.Vector3(0,0,1),new b.Vector3(0,0,-1)],K=[new b.Vector4,new b.Vector4,new b.Vector4,new b.Vector4,new b.Vector4,new b.Vector4];c=new b.MeshDepthMaterial;c.depthPacking=
b.RGBADepthPacking;c.clipping=!0;for(var A=b.ShaderLib.distanceRGBA,C=b.UniformsUtils.clone(A.uniforms),F=0;4!==F;++F){var H=0!==(F&1),E=0!==(F&2),X=c.clone();X.morphTargets=H;X.skinning=E;n[F]=X;H=new b.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:C,vertexShader:A.vertexShader,fragmentShader:A.fragmentShader,morphTargets:H,skinning:E,clipping:!0});v[F]=H}var M=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=b.PCFShadowMap;this.cullFace=b.CullFaceFront;this.render=function(c,
n){if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)&&0!==y.length){g.clearColor(1,1,1,1);g.disable(h.BLEND);g.enable(h.CULL_FACE);h.frontFace(h.CCW);h.cullFace(M.cullFace===b.CullFaceFront?h.FRONT:h.BACK);g.setDepthTest(!0);g.setScissorTest(!1);for(var v,A,F=0,H=y.length;F<H;F++){var G=y[F],P=G.shadow,J=P.camera;p.copy(P.mapSize);if(G instanceof b.PointLight){v=6;A=!0;var C=p.x,E=p.y;K[0].set(2*C,E,C,E);K[1].set(0,E,C,E);K[2].set(3*C,E,C,E);K[3].set(C,E,C,E);K[4].set(3*C,0,C,E);K[5].set(C,
0,C,E);p.x*=4;p.y*=2}else v=1,A=!1;null===P.map&&(P.map=new b.WebGLRenderTarget(p.x,p.y,{minFilter:b.NearestFilter,magFilter:b.NearestFilter,format:b.RGBAFormat}),J.updateProjectionMatrix());P instanceof b.SpotLightShadow&&P.update(G);C=P.map;P=P.matrix;l.setFromMatrixPosition(G.matrixWorld);J.position.copy(l);a.setRenderTarget(C);a.clear();for(C=0;C<v;C++){A?(u.copy(J.position),u.add(q[C]),J.up.copy(z[C]),J.lookAt(u),g.viewport(K[C])):(u.setFromMatrixPosition(G.target.matrixWorld),J.lookAt(u));J.updateMatrixWorld();
J.matrixWorldInverse.getInverse(J.matrixWorld);P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);P.multiply(J.projectionMatrix);P.multiply(J.matrixWorldInverse);t.multiplyMatrices(J.projectionMatrix,J.matrixWorldInverse);m.setFromMatrix(t);r.length=0;f(c,n,J);for(var E=0,Q=r.length;E<Q;E++){var L=r[E],ca=d.update(L),ua=L.material;if(ua instanceof b.MultiMaterial)for(var Y=ca.groups,ua=ua.materials,ta=0,X=Y.length;ta<X;ta++){var ja=Y[ta],pa=ua[ja.materialIndex];!0===pa.visible&&(pa=e(L,pa,A,l),a.renderBufferDirect(J,
null,ca,pa,L,ja))}else pa=e(L,ua,A,l),a.renderBufferDirect(J,null,ca,pa,L,null)}}}v=a.getClearColor();A=a.getClearAlpha();a.setClearColor(v,A);g.enable(h.BLEND);M.cullFace===b.CullFaceFront&&h.cullFace(h.BACK);M.needsUpdate=!1}}};b.WebGLState=function(a,c,d){var e=this,f=new b.Vector4,g=a.getParameter(a.MAX_VERTEX_ATTRIBS),k=new Uint8Array(g),m=new Uint8Array(g),t=new Uint8Array(g),v={},p=null,u=null,l=null,r=null,n=null,Q=null,L=null,q=null,z=!1,K=null,A=null,C=null,F=null,H=null,E=null,X=null,M=
null,O=null,I=null,D=null,S=null,B=null,N=null,G=null,P=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),J=void 0,V={},U=new b.Vector4,sa=null,Na=null,ca=new b.Vector4,ua=new b.Vector4;this.init=function(){this.clearColor(0,0,0,1);this.clearDepth(1);this.clearStencil(0);this.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.frontFace(a.CCW);a.cullFace(a.BACK);this.enable(a.CULL_FACE);this.enable(a.BLEND);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA)};this.initAttributes=function(){for(var a=
0,b=k.length;a<b;a++)k[a]=0};this.enableAttribute=function(b){k[b]=1;0===m[b]&&(a.enableVertexAttribArray(b),m[b]=1);0!==t[b]&&(c.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(b,0),t[b]=0)};this.enableAttributeAndDivisor=function(b,c,d){k[b]=1;0===m[b]&&(a.enableVertexAttribArray(b),m[b]=1);t[b]!==c&&(d.vertexAttribDivisorANGLE(b,c),t[b]=c)};this.disableUnusedAttributes=function(){for(var b=0,c=m.length;b<c;b++)m[b]!==k[b]&&(a.disableVertexAttribArray(b),m[b]=0)};this.enable=function(b){!0!==
v[b]&&(a.enable(b),v[b]=!0)};this.disable=function(b){!1!==v[b]&&(a.disable(b),v[b]=!1)};this.getCompressedTextureFormats=function(){if(null===p&&(p=[],c.get("WEBGL_compressed_texture_pvrtc")||c.get("WEBGL_compressed_texture_s3tc")||c.get("WEBGL_compressed_texture_etc1")))for(var b=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<b.length;d++)p.push(b[d]);return p};this.setBlending=function(c,e,f,g,h,k,m,p){c===b.NoBlending?this.disable(a.BLEND):this.enable(a.BLEND);if(c!==u||p!==z)c===b.AdditiveBlending?
p?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)):c===b.SubtractiveBlending?p?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR)):c===b.MultiplyBlending?p?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.SRC_COLOR,
a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR)):p?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)),u=c,z=p;if(c===b.CustomBlending){h=h||e;k=k||f;m=m||g;if(e!==l||h!==Q)a.blendEquationSeparate(d(e),d(h)),l=e,Q=h;if(f!==r||g!==n||k!==L||m!==q)a.blendFuncSeparate(d(f),
d(g),d(k),d(m)),r=f,n=g,L=k,q=m}else q=L=Q=n=r=l=null};this.setDepthFunc=function(c){if(K!==c){if(c)switch(c){case b.NeverDepth:a.depthFunc(a.NEVER);break;case b.AlwaysDepth:a.depthFunc(a.ALWAYS);break;case b.LessDepth:a.depthFunc(a.LESS);break;case b.LessEqualDepth:a.depthFunc(a.LEQUAL);break;case b.EqualDepth:a.depthFunc(a.EQUAL);break;case b.GreaterEqualDepth:a.depthFunc(a.GEQUAL);break;case b.GreaterDepth:a.depthFunc(a.GREATER);break;case b.NotEqualDepth:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);
K=c}};this.setDepthTest=function(b){b?this.enable(a.DEPTH_TEST):this.disable(a.DEPTH_TEST)};this.setDepthWrite=function(b){A!==b&&(a.depthMask(b),A=b)};this.setColorWrite=function(b){C!==b&&(a.colorMask(b,b,b,b),C=b)};this.setStencilFunc=function(b,c,d){if(H!==b||E!==c||X!==d)a.stencilFunc(b,c,d),H=b,E=c,X=d};this.setStencilOp=function(b,c,d){if(M!==b||O!==c||I!==d)a.stencilOp(b,c,d),M=b,O=c,I=d};this.setStencilTest=function(b){b?this.enable(a.STENCIL_TEST):this.disable(a.STENCIL_TEST)};this.setStencilWrite=
function(b){F!==b&&(a.stencilMask(b),F=b)};this.setFlipSided=function(b){D!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),D=b)};this.setLineWidth=function(b){b!==S&&(a.lineWidth(b),S=b)};this.setPolygonOffset=function(b,c,d){b?this.enable(a.POLYGON_OFFSET_FILL):this.disable(a.POLYGON_OFFSET_FILL);!b||B===c&&N===d||(a.polygonOffset(c,d),B=c,N=d)};this.getScissorTest=function(){return G};this.setScissorTest=function(b){(G=b)?this.enable(a.SCISSOR_TEST):this.disable(a.SCISSOR_TEST)};this.activeTexture=
function(b){void 0===b&&(b=a.TEXTURE0+P-1);J!==b&&(a.activeTexture(b),J=b)};this.bindTexture=function(b,c){void 0===J&&e.activeTexture();var d=V[J];void 0===d&&(d={type:void 0,texture:void 0},V[J]=d);if(d.type!==b||d.texture!==c)a.bindTexture(b,c),d.type=b,d.texture=c};this.compressedTexImage2D=function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(b){console.error(b)}};this.texImage2D=function(){try{a.texImage2D.apply(a,arguments)}catch(b){console.error(b)}};this.clearColor=function(b,c,
d,e){f.set(b,c,d,e);!1===U.equals(f)&&(a.clearColor(b,c,d,e),U.copy(f))};this.clearDepth=function(b){sa!==b&&(a.clearDepth(b),sa=b)};this.clearStencil=function(b){Na!==b&&(a.clearStencil(b),Na=b)};this.scissor=function(b){!1===ca.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),ca.copy(b))};this.viewport=function(b){!1===ua.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),ua.copy(b))};this.reset=function(){for(var b=0;b<m.length;b++)1===m[b]&&(a.disableVertexAttribArray(b),m[b]=0);v={};p=null;J=void 0;V={};D=F=A=C=
u=null}};b.WebGLUniforms=function(){var a=[],b=[],d=function(b,c,d){var e=b[0];if(0>=e||0<e)return b;var f=c*d,g=a[f];void 0===g&&(g=new Float32Array(f),a[f]=g);if(0!==c)for(e.toArray(g,0),e=1,f=0;e!==c;++e)f+=d,b[e].toArray(g,f);return g},e=function(a,d){var e=b[d];void 0===e&&(e=new Int32Array(d),b[d]=e);for(var f=0;f!==d;++f)e[f]=a.allocTextureUnit();return e},f=function(a,b){a.uniform1f(this.addr,b)},g=function(a,b){a.uniform1i(this.addr,b)},k=function(a,b){void 0===b.x?a.uniform2fv(this.addr,
b):a.uniform2f(this.addr,b.x,b.y)},m=function(a,b){void 0!==b.x?a.uniform3f(this.addr,b.x,b.y,b.z):void 0!==b.r?a.uniform3f(this.addr,b.r,b.g,b.b):a.uniform3fv(this.addr,b)},t=function(a,b){void 0===b.x?a.uniform4fv(this.addr,b):a.uniform4f(this.addr,b.x,b.y,b.z,b.w)},v=function(a,b){a.uniformMatrix2fv(this.addr,!1,b.elements||b)},p=function(a,b){a.uniformMatrix3fv(this.addr,!1,b.elements||b)},u=function(a,b){a.uniformMatrix4fv(this.addr,!1,b.elements||b)},l=function(a,b,c){var d=c.allocTextureUnit();
a.uniform1i(this.addr,d);b&&c.setTexture2D(b,d)},r=function(a,b,c){var d=c.allocTextureUnit();a.uniform1i(this.addr,d);b&&c.setTextureCube(b,d)},n=function(a,b){a.uniform2iv(this.addr,b)},Q=function(a,b){a.uniform3iv(this.addr,b)},L=function(a,b){a.uniform4iv(this.addr,b)},q=function(a){switch(a){case 5126:return f;case 35664:return k;case 35665:return m;case 35666:return t;case 35674:return v;case 35675:return p;case 35676:return u;case 35678:return l;case 35680:return r;case 5124:case 35670:return g;
case 35667:case 35671:return n;case 35668:case 35672:return Q;case 35669:case 35673:return L}},z=function(a,b){a.uniform1fv(this.addr,b)},K=function(a,b){a.uniform1iv(this.addr,b)},A=function(a,b){a.uniform2fv(this.addr,d(b,this.size,2))},C=function(a,b){a.uniform3fv(this.addr,d(b,this.size,3))},F=function(a,b){a.uniform4fv(this.addr,d(b,this.size,4))},H=function(a,b){a.uniformMatrix2fv(this.addr,!1,d(b,this.size,4))},E=function(a,b){a.uniformMatrix3fv(this.addr,!1,d(b,this.size,9))},X=function(a,
b){a.uniformMatrix4fv(this.addr,!1,d(b,this.size,16))},M=function(a,b,c){var d=b.length,f=e(c,d);a.uniform1iv(this.addr,f);for(a=0;a!==d;++a){var g=b[a];g&&c.setTexture2D(g,f[a])}},O=function(a,b,c){var d=b.length,f=e(c,d);a.uniform1iv(this.addr,f);for(a=0;a!==d;++a){var g=b[a];g&&c.setTextureCube(g,f[a])}},I=function(a){switch(a){case 5126:return z;case 35664:return A;case 35665:return C;case 35666:return F;case 35674:return H;case 35675:return E;case 35676:return X;case 35678:return M;case 35680:return O;
case 5124:case 35670:return K;case 35667:case 35671:return n;case 35668:case 35672:return Q;case 35669:case 35673:return L}},D=function(a,b,c){this.id=a;this.addr=c;this.setValue=q(b.type)},S=function(a,b,c){this.id=a;this.addr=c;this.size=b.size;this.setValue=I(b.type)},B=function(a){this.id=a;this.seq=[];this.map={}};B.prototype.setValue=function(a,b){for(var c=this.seq,d=0,e=c.length;d!==e;++d){var f=c[d];f.setValue(a,b[f.id])}};var N=/([\w\d_]+)(\])?(\[|\.)?/g,G=function(a,b,c){this.seq=[];this.map=
{};this.renderer=c;c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(var d=0;d!==c;++d){var e=a.getActiveUniform(b,d),f=a.getUniformLocation(b,e.name),g=this,h=e.name,k=h.length;for(N.lastIndex=0;;){var l=N.exec(h),m=N.lastIndex,n=l[1],p=l[3];"]"===l[2]&&(n|=0);if(void 0===p||"["===p&&m+2===k){h=g;e=void 0===p?new D(n,e,f):new S(n,e,f);h.seq.push(e);h.map[e.id]=e;break}else p=g.map[n],void 0===p&&(p=new B(n),n=g,g=p,n.seq.push(g),n.map[g.id]=g),g=p}}};G.prototype.setValue=function(a,b,c){b=this.map[b];
void 0!==b&&b.setValue(a,c,this.renderer)};G.prototype.set=function(a,b,c){var d=this.map[c];void 0!==d&&d.setValue(a,b[c],this.renderer)};G.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};G.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};G.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};G.splitDynamic=function(a,b){for(var c=null,
d=a.length,e=0,f=0;f!==d;++f){var g=a[f],h=b[g.id];h&&!0===h.dynamic?(null===c&&(c=[]),c.push(g)):(e<f&&(a[e]=g),++e)}e<d&&(a.length=e);return c};G.evalDynamic=function(a,b,c,d){for(var e=0,f=a.length;e!==f;++e){var g=b[a[e].id],h=g.onUpdateCallback;void 0!==h&&h.call(g,c,d)}};return G}();b.LensFlarePlugin=function(a,c){var d,e,f,g,k,m,t,v,p,u,l=a.context,r=a.state,n,Q,L,q,z,K;this.render=function(A,C,F){if(0!==c.length){A=new b.Vector3;var H=F.w/F.z,E=.5*F.z,X=.5*F.w,M=16/F.w,O=new b.Vector2(M*H,
M),I=new b.Vector3(1,1,0),D=new b.Vector2(1,1),S=new b.Box2;S.min.set(0,0);S.max.set(F.z-16,F.w-16);if(void 0===q){var M=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),B=new Uint16Array([0,1,2,0,2,3]);n=l.createBuffer();Q=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,n);l.bufferData(l.ARRAY_BUFFER,M,l.STATIC_DRAW);l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,Q);l.bufferData(l.ELEMENT_ARRAY_BUFFER,B,l.STATIC_DRAW);z=l.createTexture();K=l.createTexture();r.bindTexture(l.TEXTURE_2D,z);l.texImage2D(l.TEXTURE_2D,
0,l.RGB,16,16,0,l.RGB,l.UNSIGNED_BYTE,null);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);r.bindTexture(l.TEXTURE_2D,K);l.texImage2D(l.TEXTURE_2D,0,l.RGBA,16,16,0,l.RGBA,l.UNSIGNED_BYTE,null);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,
l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);var M=L={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},B=l.createProgram(),N=l.createShader(l.FRAGMENT_SHADER),
G=l.createShader(l.VERTEX_SHADER),P="precision "+a.getPrecision()+" float;\n";l.shaderSource(N,P+M.fragmentShader);l.shaderSource(G,P+M.vertexShader);l.compileShader(N);l.compileShader(G);l.attachShader(B,N);l.attachShader(B,G);l.linkProgram(B);q=B;p=l.getAttribLocation(q,"position");u=l.getAttribLocation(q,"uv");d=l.getUniformLocation(q,"renderType");e=l.getUniformLocation(q,"map");f=l.getUniformLocation(q,"occlusionMap");g=l.getUniformLocation(q,"opacity");k=l.getUniformLocation(q,"color");m=l.getUniformLocation(q,
"scale");t=l.getUniformLocation(q,"rotation");v=l.getUniformLocation(q,"screenPosition")}l.useProgram(q);r.initAttributes();r.enableAttribute(p);r.enableAttribute(u);r.disableUnusedAttributes();l.uniform1i(f,0);l.uniform1i(e,1);l.bindBuffer(l.ARRAY_BUFFER,n);l.vertexAttribPointer(p,2,l.FLOAT,!1,16,0);l.vertexAttribPointer(u,2,l.FLOAT,!1,16,8);l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,Q);r.disable(l.CULL_FACE);r.setDepthWrite(!1);B=0;for(N=c.length;B<N;B++)if(M=16/F.w,O.set(M*H,M),G=c[B],A.set(G.matrixWorld.elements[12],
G.matrixWorld.elements[13],G.matrixWorld.elements[14]),A.applyMatrix4(C.matrixWorldInverse),A.applyProjection(C.projectionMatrix),I.copy(A),D.x=F.x+I.x*E+E-8,D.y=F.y+I.y*X+X-8,!0===S.containsPoint(D)){r.activeTexture(l.TEXTURE0);r.bindTexture(l.TEXTURE_2D,null);r.activeTexture(l.TEXTURE1);r.bindTexture(l.TEXTURE_2D,z);l.copyTexImage2D(l.TEXTURE_2D,0,l.RGB,D.x,D.y,16,16,0);l.uniform1i(d,0);l.uniform2f(m,O.x,O.y);l.uniform3f(v,I.x,I.y,I.z);r.disable(l.BLEND);r.enable(l.DEPTH_TEST);l.drawElements(l.TRIANGLES,
6,l.UNSIGNED_SHORT,0);r.activeTexture(l.TEXTURE0);r.bindTexture(l.TEXTURE_2D,K);l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,D.x,D.y,16,16,0);l.uniform1i(d,1);r.disable(l.DEPTH_TEST);r.activeTexture(l.TEXTURE1);r.bindTexture(l.TEXTURE_2D,z);l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0);G.positionScreen.copy(I);G.customUpdateCallback?G.customUpdateCallback(G):G.updateLensFlares();l.uniform1i(d,2);r.enable(l.BLEND);for(var P=0,J=G.lensFlares.length;P<J;P++){var V=G.lensFlares[P];.001<V.opacity&&.001<V.scale&&
(I.x=V.x,I.y=V.y,I.z=V.z,M=V.size*V.scale/F.w,O.x=M*H,O.y=M,l.uniform3f(v,I.x,I.y,I.z),l.uniform2f(m,O.x,O.y),l.uniform1f(t,V.rotation),l.uniform1f(g,V.opacity),l.uniform3f(k,V.color.r,V.color.g,V.color.b),r.setBlending(V.blending,V.blendEquation,V.blendSrc,V.blendDst),a.setTexture2D(V.texture,1),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0))}}r.enable(l.CULL_FACE);r.enable(l.DEPTH_TEST);r.setDepthWrite(!0);a.resetGLState()}}};b.SpritePlugin=function(a,c){var d,e,f,g,k,m,t,v,p,u,l,r,n,Q,L,q,z;
function K(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:b.id-a.id}var A=a.context,C=a.state,F,H,E,X,M=new b.Vector3,O=new b.Quaternion,I=new b.Vector3;this.render=function(D,S){if(0!==c.length){if(void 0===E){var B=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),N=new Uint16Array([0,1,2,0,2,3]);F=A.createBuffer();H=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,F);A.bufferData(A.ARRAY_BUFFER,B,A.STATIC_DRAW);A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,
H);A.bufferData(A.ELEMENT_ARRAY_BUFFER,N,A.STATIC_DRAW);var B=A.createProgram(),N=A.createShader(A.VERTEX_SHADER),G=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(N,["precision "+a.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
A.shaderSource(G,["precision "+a.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
A.compileShader(N);A.compileShader(G);A.attachShader(B,N);A.attachShader(B,G);A.linkProgram(B);E=B;q=A.getAttribLocation(E,"position");z=A.getAttribLocation(E,"uv");d=A.getUniformLocation(E,"uvOffset");e=A.getUniformLocation(E,"uvScale");f=A.getUniformLocation(E,"rotation");g=A.getUniformLocation(E,"scale");k=A.getUniformLocation(E,"color");m=A.getUniformLocation(E,"map");t=A.getUniformLocation(E,"opacity");v=A.getUniformLocation(E,"modelViewMatrix");p=A.getUniformLocation(E,"projectionMatrix");u=
A.getUniformLocation(E,"fogType");l=A.getUniformLocation(E,"fogDensity");r=A.getUniformLocation(E,"fogNear");n=A.getUniformLocation(E,"fogFar");Q=A.getUniformLocation(E,"fogColor");L=A.getUniformLocation(E,"alphaTest");B=document.createElement("canvas");B.width=8;B.height=8;N=B.getContext("2d");N.fillStyle="white";N.fillRect(0,0,8,8);X=new b.Texture(B);X.needsUpdate=!0}A.useProgram(E);C.initAttributes();C.enableAttribute(q);C.enableAttribute(z);C.disableUnusedAttributes();C.disable(A.CULL_FACE);C.enable(A.BLEND);
A.bindBuffer(A.ARRAY_BUFFER,F);A.vertexAttribPointer(q,2,A.FLOAT,!1,16,0);A.vertexAttribPointer(z,2,A.FLOAT,!1,16,8);A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,H);A.uniformMatrix4fv(p,!1,S.projectionMatrix.elements);C.activeTexture(A.TEXTURE0);A.uniform1i(m,0);N=B=0;(G=D.fog)?(A.uniform3f(Q,G.color.r,G.color.g,G.color.b),G instanceof b.Fog?(A.uniform1f(r,G.near),A.uniform1f(n,G.far),A.uniform1i(u,1),N=B=1):G instanceof b.FogExp2&&(A.uniform1f(l,G.density),A.uniform1i(u,2),N=B=2)):(A.uniform1i(u,0),N=B=0);
for(var G=0,P=c.length;G<P;G++){var J=c[G];J.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,J.matrixWorld);J.z=-J.modelViewMatrix.elements[14]}c.sort(K);for(var V=[],G=0,P=c.length;G<P;G++){var J=c[G],U=J.material;A.uniform1f(L,U.alphaTest);A.uniformMatrix4fv(v,!1,J.modelViewMatrix.elements);J.matrixWorld.decompose(M,O,I);V[0]=I.x;V[1]=I.y;J=0;D.fog&&U.fog&&(J=N);B!==J&&(A.uniform1i(u,J),B=J);null!==U.map?(A.uniform2f(d,U.map.offset.x,U.map.offset.y),A.uniform2f(e,U.map.repeat.x,U.map.repeat.y)):
(A.uniform2f(d,0,0),A.uniform2f(e,1,1));A.uniform1f(t,U.opacity);A.uniform3f(k,U.color.r,U.color.g,U.color.b);A.uniform1f(f,U.rotation);A.uniform2fv(g,V);C.setBlending(U.blending,U.blendEquation,U.blendSrc,U.blendDst);C.setDepthTest(U.depthTest);C.setDepthWrite(U.depthWrite);U.map?a.setTexture2D(U.map,0):a.setTexture2D(X,0);A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0)}C.enable(A.CULL_FACE);a.resetGLState()}}};b.RenderableObject=function(){this.id=0;this.object=null;this.renderOrder=this.z=0};
b.RenderableFace=function(){this.id=0;this.v1=new b.RenderableVertex;this.v2=new b.RenderableVertex;this.v3=new b.RenderableVertex;this.normalModel=new b.Vector3;this.vertexNormalsModel=[new b.Vector3,new b.Vector3,new b.Vector3];this.vertexNormalsLength=0;this.color=new b.Color;this.material=null;this.uvs=[new b.Vector2,new b.Vector2,new b.Vector2];this.renderOrder=this.z=0};b.RenderableVertex=function(){this.position=new b.Vector3;this.positionWorld=new b.Vector3;this.positionScreen=new b.Vector4;
this.visible=!0};b.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};b.RenderableLine=function(){this.id=0;this.v1=new b.RenderableVertex;this.v2=new b.RenderableVertex;this.vertexColors=[new b.Color,new b.Color];this.material=null;this.renderOrder=this.z=0};b.RenderableSprite=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new b.Vector2;this.material=null;this.renderOrder=0};b.Projector=
function(){function a(){if(u===r){var a=new b.RenderableVertex;l.push(a);r++;u++;return a}return l[u++]}function c(){if(Q===q){var a=new b.RenderableFace;L.push(a);q++;Q++;return a}return L[Q++]}function d(){if(K===C){var a=new b.RenderableLine;A.push(a);C++;K++;return a}return A[K++]}function e(){if(H===X){var a=new b.RenderableSprite;E.push(a);X++;H++;return a}return E[H++]}function f(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}
function g(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,h=-a.z+a.w,k=-b.z+b.w;if(0<=e&&0<=f&&0<=h&&0<=k)return!0;if(0>e&&0>f||0>h&&0>k)return!1;0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f)));0>h?c=Math.max(c,h/(h-k)):0>k&&(d=Math.min(d,h/(h-k)));if(d<c)return!1;a.lerp(b,c);b.lerp(a,1-d);return!0}var k,m,t=[],v=0,p,u,l=[],r=0,n,Q,L=[],q=0,z,K,A=[],C=0,F,H,E=[],X=0,M={objects:[],lights:[],elements:[]},O=new b.Vector3,I=new b.Vector4,D=new b.Box3(new b.Vector3(-1,-1,-1),new b.Vector3(1,1,1)),S=new b.Box3,
B=Array(3),N=new b.Matrix4,G=new b.Matrix4,P,J=new b.Matrix4,V=new b.Matrix3,U=new b.Frustum,Z=new b.Vector4,da=new b.Vector4;this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var ca=new function(){function e(a){var b=
a.positionWorld,c=a.positionScreen;b.copy(a.position).applyMatrix4(P);c.copy(b).applyMatrix4(G);b=1/c.w;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z}function f(a,b,c){if(!0===a.visible||!0===b.visible||!0===c.visible)return!0;B[0]=a.positionScreen;B[1]=b.positionScreen;B[2]=c.positionScreen;return D.intersectsBox(S.setFromPoints(B))}function g(a,b,c){return 0>(c.positionScreen.x-a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(c.positionScreen.y-a.positionScreen.y)*
(b.positionScreen.x-a.positionScreen.x)}var h=[],k=[],m=null,s=null,r=new b.Matrix3;return{setObject:function(a){m=a;s=m.material;r.getNormalMatrix(m.matrixWorld);h.length=0;k.length=0},projectVertex:e,checkTriangleVisibility:f,checkBackfaceCulling:g,pushVertex:function(b,c,d){p=a();p.position.set(b,c,d);e(p)},pushNormal:function(a,b,c){h.push(a,b,c)},pushUv:function(a,b){k.push(a,b)},pushLine:function(a,b){var c=l[a],e=l[b];z=d();z.id=m.id;z.v1.copy(c);z.v2.copy(e);z.z=(c.positionScreen.z+e.positionScreen.z)/
2;z.renderOrder=m.renderOrder;z.material=m.material;M.elements.push(z)},pushTriangle:function(a,d,e){var p=l[a],q=l[d],t=l[e];if(!1!==f(p,q,t)&&(s.side===b.DoubleSide||!0===g(p,q,t))){n=c();n.id=m.id;n.v1.copy(p);n.v2.copy(q);n.v3.copy(t);n.z=(p.positionScreen.z+q.positionScreen.z+t.positionScreen.z)/3;n.renderOrder=m.renderOrder;n.normalModel.fromArray(h,3*a);n.normalModel.applyMatrix3(r).normalize();for(p=0;3>p;p++)q=n.vertexNormalsModel[p],q.fromArray(h,3*arguments[p]),q.applyMatrix3(r).normalize(),
n.uvs[p].fromArray(k,2*arguments[p]);n.vertexNormalsLength=3;n.material=m.material;M.elements.push(n)}}}};this.projectScene=function(p,q,r,A){H=K=Q=0;M.elements.length=0;!0===p.autoUpdate&&p.updateMatrixWorld();null===q.parent&&q.updateMatrixWorld();N.copy(q.matrixWorldInverse.getInverse(q.matrixWorld));G.multiplyMatrices(q.projectionMatrix,N);U.setFromMatrix(G);m=0;M.objects.length=0;M.lights.length=0;p.traverseVisible(function(a){if(a instanceof b.Light)M.lights.push(a);else if((a instanceof b.Mesh||
a instanceof b.Line||a instanceof b.Sprite)&&!1!==a.material.visible&&(!1===a.frustumCulled||!0===U.intersectsObject(a))){if(m===v){var c=new b.RenderableObject;t.push(c);v++;m++;k=c}else k=t[m++];k.id=a.id;k.object=a;O.setFromMatrixPosition(a.matrixWorld);O.applyProjection(G);k.z=O.z;k.renderOrder=a.renderOrder;M.objects.push(k)}});!0===r&&M.objects.sort(f);p=0;for(r=M.objects.length;p<r;p++){var C=M.objects[p].object,E=C.geometry;ca.setObject(C);P=C.matrixWorld;u=0;if(C instanceof b.Mesh)if(E instanceof
b.BufferGeometry){var D=E.attributes,C=E.groups;if(void 0!==D.position){for(var L=D.position.array,R=0,B=L.length;R<B;R+=3)ca.pushVertex(L[R],L[R+1],L[R+2]);if(void 0!==D.normal)for(var X=D.normal.array,R=0,B=X.length;R<B;R+=3)ca.pushNormal(X[R],X[R+1],X[R+2]);if(void 0!==D.uv)for(D=D.uv.array,R=0,B=D.length;R<B;R+=2)ca.pushUv(D[R],D[R+1]);if(null!==E.index)if(L=E.index.array,0<C.length)for(p=0;p<C.length;p++)for(B=C[p],R=B.start,B=B.start+B.count;R<B;R+=3)ca.pushTriangle(L[R],L[R+1],L[R+2]);else for(R=
0,B=L.length;R<B;R+=3)ca.pushTriangle(L[R],L[R+1],L[R+2]);else for(R=0,B=L.length/3;R<B;R+=3)ca.pushTriangle(R,R+1,R+2)}}else{if(E instanceof b.Geometry){var S=E.vertices,R=E.faces,B=E.faceVertexUvs[0];V.getNormalMatrix(P);for(var L=C.material,D=L instanceof b.MultiMaterial,X=!0===D?C.material:null,la=0,W=S.length;la<W;la++){var $=S[la];O.copy($);if(!0===L.morphTargets)for(var ia=E.morphTargets,aa=C.morphTargetInfluences,fa=0,za=ia.length;fa<za;fa++){var ga=aa[fa];if(0!==ga){var ma=ia[fa].vertices[la];
O.x+=(ma.x-$.x)*ga;O.y+=(ma.y-$.y)*ga;O.z+=(ma.z-$.z)*ga}}ca.pushVertex(O.x,O.y,O.z)}S=0;for(la=R.length;S<la;S++)if(W=R[S],L=!0===D?X.materials[W.materialIndex]:C.material,void 0!==L&&(aa=L.side,E=l[W.a],$=l[W.b],ia=l[W.c],!1!==ca.checkTriangleVisibility(E,$,ia))){fa=ca.checkBackfaceCulling(E,$,ia);if(aa!==b.DoubleSide){if(aa===b.FrontSide&&!1===fa)continue;if(aa===b.BackSide&&!0===fa)continue}n=c();n.id=C.id;n.v1.copy(E);n.v2.copy($);n.v3.copy(ia);n.normalModel.copy(W.normal);!1!==fa||aa!==b.BackSide&&
aa!==b.DoubleSide||n.normalModel.negate();n.normalModel.applyMatrix3(V).normalize();za=W.vertexNormals;ga=0;for(ma=Math.min(za.length,3);ga<ma;ga++){var ba=n.vertexNormalsModel[ga];ba.copy(za[ga]);!1!==fa||aa!==b.BackSide&&aa!==b.DoubleSide||ba.negate();ba.applyMatrix3(V).normalize()}n.vertexNormalsLength=za.length;aa=B[S];if(void 0!==aa)for(fa=0;3>fa;fa++)n.uvs[fa].copy(aa[fa]);n.color=W.color;n.material=L;n.z=(E.positionScreen.z+$.positionScreen.z+ia.positionScreen.z)/3;n.renderOrder=C.renderOrder;
M.elements.push(n)}}}else if(C instanceof b.Line)if(E instanceof b.BufferGeometry){if(D=E.attributes,void 0!==D.position){L=D.position.array;R=0;for(B=L.length;R<B;R+=3)ca.pushVertex(L[R],L[R+1],L[R+2]);if(null!==E.index)for(L=E.index.array,R=0,B=L.length;R<B;R+=2)ca.pushLine(L[R],L[R+1]);else for(D=C instanceof b.LineSegments?2:1,R=0,B=L.length/3-1;R<B;R+=D)ca.pushLine(R,R+1)}}else{if(E instanceof b.Geometry&&(J.multiplyMatrices(G,P),S=C.geometry.vertices,0!==S.length))for(E=a(),E.positionScreen.copy(S[0]).applyMatrix4(J),
D=C instanceof b.LineSegments?2:1,la=1,W=S.length;la<W;la++)E=a(),E.positionScreen.copy(S[la]).applyMatrix4(J),0<(la+1)%D||($=l[u-2],Z.copy(E.positionScreen),da.copy($.positionScreen),!0===g(Z,da)&&(Z.multiplyScalar(1/Z.w),da.multiplyScalar(1/da.w),z=d(),z.id=C.id,z.v1.positionScreen.copy(Z),z.v2.positionScreen.copy(da),z.z=Math.max(Z.z,da.z),z.renderOrder=C.renderOrder,z.material=C.material,C.material.vertexColors===b.VertexColors&&(z.vertexColors[0].copy(C.geometry.colors[la]),z.vertexColors[1].copy(C.geometry.colors[la-
1])),M.elements.push(z)))}else C instanceof b.Sprite&&(I.set(P.elements[12],P.elements[13],P.elements[14],1),I.applyMatrix4(G),R=1/I.w,I.z*=R,-1<=I.z&&1>=I.z&&(F=e(),F.id=C.id,F.x=I.x*R,F.y=I.y*R,F.z=I.z,F.renderOrder=C.renderOrder,F.object=C,F.rotation=C.rotation,F.scale.x=C.scale.x*Math.abs(F.x-(I.x+q.projectionMatrix.elements[0])/(I.w+q.projectionMatrix.elements[12])),F.scale.y=C.scale.y*Math.abs(F.y-(I.y+q.projectionMatrix.elements[5])/(I.w+q.projectionMatrix.elements[13])),F.material=C.material,
M.elements.push(F)))}!0===A&&M.elements.sort(f);return M}};b.SpriteCanvasMaterial=function(a){b.Material.call(this);this.type="SpriteCanvasMaterial";this.color=new b.Color(16777215);this.program=function(a,b){};this.setValues(a)};b.SpriteCanvasMaterial.prototype=Object.create(b.Material.prototype);b.SpriteCanvasMaterial.prototype.constructor=b.SpriteCanvasMaterial;b.SpriteCanvasMaterial.prototype.clone=function(){var a=new b.SpriteCanvasMaterial;a.copy(this);a.color.copy(this.color);a.program=this.program;
return a};b.CanvasRenderer=function(a){function c(a,b,c,d){t(b);v(c);p(d);u(a.getStyle());D.stroke();na.expandByScalar(2*b)}function d(a){l(a.getStyle());D.fill()}function e(a){if(0===a.version||a instanceof b.CompressedTexture||a instanceof b.DataTexture)return{canvas:void 0,version:a.version};var c=a.image;if(!1===c.complete)return{canvas:void 0,version:0};var d=document.createElement("canvas");d.width=c.width;d.height=c.height;var e=d.getContext("2d");e.setTransform(1,0,0,-1,0,c.height);e.drawImage(c,
0,0);var c=a.wrapS===b.RepeatWrapping,e=a.wrapT===b.RepeatWrapping,f="no-repeat";!0===c&&!0===e?f="repeat":!0===c?f="repeat-x":!0===e&&(f="repeat-y");d=D.createPattern(d,f);if(a.onUpdate)a.onUpdate(a);return{canvas:d,version:a.version}}function f(a,b,c,d,f,g,h,k,m,n,p,s,q){var r=la[q.id];if(void 0===r||r.version!==q.version)r=e(q),la[q.id]=r;if(void 0!==r.canvas){l(r.canvas);var r=q.offset.x/q.repeat.x,t=q.offset.y/q.repeat.y,u=q.image.width*q.repeat.x;q=q.image.height*q.repeat.y;h=(h+r)*u;k=(k+t)*
q;c-=a;d-=b;f-=a;g-=b;m=(m+r)*u-h;n=(n+t)*q-k;p=(p+r)*u-h;s=(s+t)*q-k;q=m*s-p*n;0!==q&&(r=1/q,q=(s*c-n*f)*r,n=(s*d-n*g)*r,c=(m*f-p*c)*r,d=(m*g-p*d)*r,a=a-q*h-c*k,b=b-n*h-d*k,D.save(),D.transform(q,n,c,d,a,b),D.fill(),D.restore())}else l("rgba( 0, 0, 0, 1)"),D.fill()}function g(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(c/=Math.sqrt(f),d*=c,e*=c,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function k(a){N!==a&&(N=D.globalAlpha=a)}function m(a){G!==a&&(a===b.NormalBlending?D.globalCompositeOperation="source-over":
a===b.AdditiveBlending?D.globalCompositeOperation="lighter":a===b.SubtractiveBlending&&(D.globalCompositeOperation="darker"),G=a)}function t(a){V!==a&&(V=D.lineWidth=a)}function v(a){U!==a&&(U=D.lineCap=a)}function p(a){Z!==a&&(Z=D.lineJoin=a)}function u(a){P!==a&&(P=D.strokeStyle=a)}function l(a){J!==a&&(J=D.fillStyle=a)}function r(a){da.length!==a.length&&(D.setLineDash(a),da=a)}console.log("THREE.CanvasRenderer",b.REVISION);a=a||{};var n=this,Q,L,q,z=new b.Projector,K=void 0!==a.canvas?a.canvas:
document.createElement("canvas"),A=K.width,C=K.height,F=Math.floor(A/2),H=Math.floor(C/2),E=0,X=0,M=A,O=C,I=1,D=K.getContext("2d",{alpha:!0===a.alpha}),S=new b.Color(0),B=!0===a.alpha?0:1,N=1,G=0,P=null,J=null,V=null,U=null,Z=null,da=[],ca,$,Y;new b.RenderableVertex;new b.RenderableVertex;var ta,ra,ja,pa,Ca,Da,R=new b.Color;new b.Color;new b.Color;new b.Color;new b.Color;var xa=new b.Color,ya=new b.Color,Ka=new b.Color,la={},W,Ga,ia,aa,fa,za,ga,ma=new b.Box2,ba=new b.Box2,na=new b.Box2,pb=new b.Color,
Qa=new b.Color,La=new b.Color,Ea=new b.Vector3,Aa=new b.Vector3,oa=new b.Vector3,Ba=new b.Matrix3;void 0===D.setLineDash&&(D.setLineDash=function(){});this.domElement=K;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.getContext=function(){return D};this.getContextAttributes=function(){return D.getContextAttributes()};this.getPixelRatio=function(){return I};this.setPixelRatio=
function(a){void 0!==a&&(I=a)};this.setSize=function(a,b,c){A=a*I;C=b*I;K.width=A;K.height=C;F=Math.floor(A/2);H=Math.floor(C/2);!1!==c&&(K.style.width=a+"px",K.style.height=b+"px");ma.min.set(-F,-H);ma.max.set(F,H);ba.min.set(-F,-H);ba.max.set(F,H);N=1;G=0;Z=U=V=J=P=null;this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){E=a*I;X=b*I;M=c*I;O=d*I};this.setScissor=function(){};this.setScissorTest=function(){};this.setClearColor=function(a,b){S.set(a);B=void 0!==b?b:1;ba.min.set(-F,-H);ba.max.set(F,
H)};this.setClearColorHex=function(a,b){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=function(){return S};this.getClearAlpha=function(){return B};this.getMaxAnisotropy=function(){return 0};this.clear=function(){!1===ba.isEmpty()&&(ba.intersect(ma),ba.expandByScalar(2),ba.min.x+=F,ba.min.y=-ba.min.y+H,ba.max.x+=F,ba.max.y=-ba.max.y+H,1>B&&D.clearRect(ba.min.x|0,ba.max.y|0,ba.max.x-ba.min.x|0,ba.min.y-
ba.max.y|0),0<B&&(m(b.NormalBlending),k(1),l("rgba("+Math.floor(255*S.r)+","+Math.floor(255*S.g)+","+Math.floor(255*S.b)+","+B+")"),D.fillRect(ba.min.x|0,ba.max.y|0,ba.max.x-ba.min.x|0,ba.min.y-ba.max.y|0)),ba.makeEmpty())};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.render=function(a,G){if(!1===G instanceof b.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();n.info.render.vertices=
0;n.info.render.faces=0;D.setTransform(M/A,0,0,-O/C,E,C-X);D.translate(F,H);Q=z.projectScene(a,G,this.sortObjects,this.sortElements);L=Q.elements;q=Q.lights;Ba.getNormalMatrix(G.matrixWorldInverse);pb.setRGB(0,0,0);Qa.setRGB(0,0,0);La.setRGB(0,0,0);for(var I=0,K=q.length;I<K;I++){var B=q[I],P=B.color;B instanceof b.AmbientLight?pb.add(P):B instanceof b.DirectionalLight?Qa.add(P):B instanceof b.PointLight&&La.add(P)}I=0;for(K=L.length;I<K;I++){var J=L[I],S=J.material;if(void 0!==S&&0!==S.opacity){na.makeEmpty();
if(J instanceof b.RenderableSprite){ca=J;ca.x*=F;ca.y*=H;var B=ca,N=J,P=S;k(P.opacity);m(P.blending);var w=N.scale.x*F,N=N.scale.y*H,J=.5*Math.sqrt(w*w+N*N);na.min.set(B.x-J,B.y-J);na.max.set(B.x+J,B.y+J);if(P instanceof b.SpriteMaterial){var U=P.map;if(null!==U){J=la[U.id];if(void 0===J||J.version!==U.version)J=e(U),la[U.id]=J;if(void 0!==J.canvas){l(J.canvas);var V=U.image,J=V.width*U.offset.x,S=V.height*U.offset.y,Z=V.width*U.repeat.x,U=V.height*U.repeat.y,V=w/Z,da=N/U;D.save();D.translate(B.x,
B.y);0!==P.rotation&&D.rotate(P.rotation);D.translate(-w/2,-N/2);D.scale(V,da);D.translate(-J,-S);D.fillRect(J,S,Z,U);D.restore()}}else l(P.color.getStyle()),D.save(),D.translate(B.x,B.y),0!==P.rotation&&D.rotate(P.rotation),D.scale(w,-N),D.fillRect(-.5,-.5,1,1),D.restore()}else P instanceof b.SpriteCanvasMaterial&&(u(P.color.getStyle()),l(P.color.getStyle()),D.save(),D.translate(B.x,B.y),0!==P.rotation&&D.rotate(P.rotation),D.scale(w,N),P.program(D),D.restore())}else if(J instanceof b.RenderableLine){if(ca=
J.v1,$=J.v2,ca.positionScreen.x*=F,ca.positionScreen.y*=H,$.positionScreen.x*=F,$.positionScreen.y*=H,na.setFromPoints([ca.positionScreen,$.positionScreen]),!0===ma.intersectsBox(na))if(B=ca,P=$,w=J,N=S,k(N.opacity),m(N.blending),D.beginPath(),D.moveTo(B.positionScreen.x,B.positionScreen.y),D.lineTo(P.positionScreen.x,P.positionScreen.y),N instanceof b.LineBasicMaterial){t(N.linewidth);v(N.linecap);p(N.linejoin);if(N.vertexColors!==b.VertexColors)u(N.color.getStyle());else if(J=w.vertexColors[0].getStyle(),
w=w.vertexColors[1].getStyle(),J===w)u(J);else{try{var T=D.createLinearGradient(B.positionScreen.x,B.positionScreen.y,P.positionScreen.x,P.positionScreen.y);T.addColorStop(0,J);T.addColorStop(1,w)}catch(ha){T=J}u(T)}D.stroke();na.expandByScalar(2*N.linewidth)}else N instanceof b.LineDashedMaterial&&(t(N.linewidth),v(N.linecap),p(N.linejoin),u(N.color.getStyle()),r([N.dashSize,N.gapSize]),D.stroke(),na.expandByScalar(2*N.linewidth),r([]))}else if(J instanceof b.RenderableFace){ca=J.v1;$=J.v2;Y=J.v3;
if(-1>ca.positionScreen.z||1<ca.positionScreen.z)continue;if(-1>$.positionScreen.z||1<$.positionScreen.z)continue;if(-1>Y.positionScreen.z||1<Y.positionScreen.z)continue;ca.positionScreen.x*=F;ca.positionScreen.y*=H;$.positionScreen.x*=F;$.positionScreen.y*=H;Y.positionScreen.x*=F;Y.positionScreen.y*=H;0<S.overdraw&&(g(ca.positionScreen,$.positionScreen,S.overdraw),g($.positionScreen,Y.positionScreen,S.overdraw),g(Y.positionScreen,ca.positionScreen,S.overdraw));na.setFromPoints([ca.positionScreen,
$.positionScreen,Y.positionScreen]);if(!0===ma.intersectsBox(na)){P=ca;w=$;N=Y;B=S;n.info.render.vertices+=3;n.info.render.faces++;k(B.opacity);m(B.blending);ta=P.positionScreen.x;ra=P.positionScreen.y;ja=w.positionScreen.x;pa=w.positionScreen.y;Ca=N.positionScreen.x;Da=N.positionScreen.y;var S=ta,Z=ra,U=ja,V=pa,da=Ca,sa=Da;D.beginPath();D.moveTo(S,Z);D.lineTo(U,V);D.lineTo(da,sa);D.closePath();if((B instanceof b.MeshLambertMaterial||B instanceof b.MeshPhongMaterial)&&null===B.map){xa.copy(B.color);
ya.copy(B.emissive);B.vertexColors===b.FaceColors&&xa.multiply(J.color);R.copy(pb);Aa.copy(P.positionWorld).add(w.positionWorld).add(N.positionWorld).divideScalar(3);P=Aa;w=J.normalModel;N=R;J=0;for(S=q.length;J<S;J++)Z=q[J],Ka.copy(Z.color),Z instanceof b.DirectionalLight?(U=Ea.setFromMatrixPosition(Z.matrixWorld).normalize(),V=w.dot(U),0>=V||(V*=Z.intensity,N.add(Ka.multiplyScalar(V)))):Z instanceof b.PointLight&&(U=Ea.setFromMatrixPosition(Z.matrixWorld),V=w.dot(Ea.subVectors(U,P).normalize()),
0>=V||(V*=0==Z.distance?1:1-Math.min(P.distanceTo(U)/Z.distance,1),0!=V&&(V*=Z.intensity,N.add(Ka.multiplyScalar(V)))));R.multiply(xa).add(ya);!0===B.wireframe?c(R,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):d(R)}else B instanceof b.MeshBasicMaterial||B instanceof b.MeshLambertMaterial||B instanceof b.MeshPhongMaterial?null!==B.map?B.map.mapping===b.UVMapping&&(W=J.uvs,f(ta,ra,ja,pa,Ca,Da,W[0].x,W[0].y,W[1].x,W[1].y,W[2].x,W[2].y,B.map)):null!==B.envMap?B.envMap.mapping===b.SphericalReflectionMapping&&
(oa.copy(J.vertexNormalsModel[0]).applyMatrix3(Ba),Ga=.5*oa.x+.5,ia=.5*oa.y+.5,oa.copy(J.vertexNormalsModel[1]).applyMatrix3(Ba),aa=.5*oa.x+.5,fa=.5*oa.y+.5,oa.copy(J.vertexNormalsModel[2]).applyMatrix3(Ba),za=.5*oa.x+.5,ga=.5*oa.y+.5,f(ta,ra,ja,pa,Ca,Da,Ga,ia,aa,fa,za,ga,B.envMap)):(R.copy(B.color),B.vertexColors===b.FaceColors&&R.multiply(J.color),!0===B.wireframe?c(R,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):d(R)):(B instanceof b.MeshNormalMaterial?(oa.copy(J.normalModel).applyMatrix3(Ba),
R.setRGB(oa.x,oa.y,oa.z).multiplyScalar(.5).addScalar(.5)):R.setRGB(1,1,1),!0===B.wireframe?c(R,B.wireframeLinewidth,B.wireframeLinecap,B.wireframeLinejoin):d(R))}}ba.union(na)}}D.setTransform(1,0,0,1,0,0)}}};b.TrackballControls=function(a,c){function d(a){!1!==l.enabled&&(window.removeEventListener("keydown",d),L=Q,Q===r.NONE)&&(a.keyCode!==l.keys[r.ROTATE]||l.noRotate?a.keyCode!==l.keys[r.ZOOM]||l.noZoom?a.keyCode!==l.keys[r.PAN]||l.noPan||(Q=r.PAN):Q=r.ZOOM:Q=r.ROTATE)}function e(a){!1!==l.enabled&&
(Q=L,window.addEventListener("keydown",d,!1))}function f(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),Q===r.NONE&&(Q=a.button),Q!==r.ROTATE||l.noRotate?Q!==r.ZOOM||l.noZoom?Q!==r.PAN||l.noPan||(M.copy(B(a.pageX,a.pageY)),O.copy(M)):(F.copy(B(a.pageX,a.pageY)),H.copy(F)):(K.copy(N(a.pageX,a.pageY)),z.copy(K)),document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",k,!1),l.dispatchEvent(D))}function g(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),Q!==
r.ROTATE||l.noRotate?Q!==r.ZOOM||l.noZoom?Q!==r.PAN||l.noPan||O.copy(B(a.pageX,a.pageY)):H.copy(B(a.pageX,a.pageY)):(z.copy(K),K.copy(N(a.pageX,a.pageY))))}function k(a){!1!==l.enabled&&(a.preventDefault(),a.stopPropagation(),Q=r.NONE,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",k),l.dispatchEvent(S))}function m(a){if(!1!==l.enabled){a.preventDefault();a.stopPropagation();var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3);F.y+=.01*b;l.dispatchEvent(D);
l.dispatchEvent(S)}}function t(a){if(!1!==l.enabled){switch(a.touches.length){case 1:Q=r.TOUCH_ROTATE;K.copy(N(a.touches[0].pageX,a.touches[0].pageY));z.copy(K);break;default:Q=r.TOUCH_ZOOM_PAN;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;X=E=Math.sqrt(b*b+c*c);M.copy(B((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2));O.copy(M)}l.dispatchEvent(D)}}function v(a){if(!1!==l.enabled)switch(a.preventDefault(),a.stopPropagation(),
a.touches.length){case 1:z.copy(K);K.copy(N(a.touches[0].pageX,a.touches[0].pageY));break;default:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;X=Math.sqrt(b*b+c*c);O.copy(B((a.touches[0].pageX+a.touches[1].pageX)/2,(a.touches[0].pageY+a.touches[1].pageY)/2))}}function p(a){if(!1!==l.enabled){switch(a.touches.length){case 0:Q=r.NONE;break;case 1:Q=r.TOUCH_ROTATE,K.copy(N(a.touches[0].pageX,a.touches[0].pageY)),z.copy(K)}l.dispatchEvent(S)}}function u(a){a.preventDefault()}
var l=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=a;this.domElement=void 0!==c?c:document;this.enabled=!0;this.screen={left:0,top:0,width:0,height:0};this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=.3;this.staticMoving=this.noPan=this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.target=new b.Vector3;var n=new b.Vector3,Q=r.NONE,L=r.NONE,q=new b.Vector3,z=new b.Vector2,K=new b.Vector2,
A=new b.Vector3,C=0,F=new b.Vector2,H=new b.Vector2,E=0,X=0,M=new b.Vector2,O=new b.Vector2;this.target0=this.target.clone();this.position0=this.object.position.clone();this.up0=this.object.up.clone();var I={type:"change"},D={type:"start"},S={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var a=this.domElement.getBoundingClientRect(),b=this.domElement.ownerDocument.documentElement;
this.screen.left=a.left+window.pageXOffset-b.clientLeft;this.screen.top=a.top+window.pageYOffset-b.clientTop;this.screen.width=a.width;this.screen.height=a.height}};this.handleEvent=function(a){if("function"==typeof this[a.type])this[a.type](a)};var B=function(){var a=new b.Vector2;return function(b,c){a.set((b-l.screen.left)/l.screen.width,(c-l.screen.top)/l.screen.height);return a}}(),N=function(){var a=new b.Vector2;return function(b,c){a.set((b-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),
(l.screen.height+2*(l.screen.top-c))/l.screen.width);return a}}();this.rotateCamera=function(){var a=new b.Vector3,c=new b.Quaternion,d=new b.Vector3,e=new b.Vector3,f=new b.Vector3,g=new b.Vector3,h;return function(){g.set(K.x-z.x,K.y-z.y,0);(h=g.length())?(q.copy(l.object.position).sub(l.target),d.copy(q).normalize(),e.copy(l.object.up).normalize(),f.crossVectors(e,d).normalize(),e.setLength(K.y-z.y),f.setLength(K.x-z.x),g.copy(e.add(f)),a.crossVectors(g,q).normalize(),h*=l.rotateSpeed,c.setFromAxisAngle(a,
h),q.applyQuaternion(c),l.object.up.applyQuaternion(c),A.copy(a),C=h):!l.staticMoving&&C&&(C*=Math.sqrt(1-l.dynamicDampingFactor),q.copy(l.object.position).sub(l.target),c.setFromAxisAngle(A,C),q.applyQuaternion(c),l.object.up.applyQuaternion(c));z.copy(K)}}();this.zoomCamera=function(){var a;Q===r.TOUCH_ZOOM_PAN?(a=E/X,E=X,q.multiplyScalar(a)):(a=1+(H.y-F.y)*l.zoomSpeed,1!==a&&0<a&&(q.multiplyScalar(a),l.staticMoving?F.copy(H):F.y+=(H.y-F.y)*this.dynamicDampingFactor))};this.panCamera=function(){var a=
new b.Vector2,c=new b.Vector3,d=new b.Vector3;return function(){a.copy(O).sub(M);a.lengthSq()&&(a.multiplyScalar(q.length()*l.panSpeed),d.copy(q).cross(l.object.up).setLength(a.x),d.add(c.copy(l.object.up).setLength(a.y)),l.object.position.add(d),l.target.add(d),l.staticMoving?M.copy(O):M.add(a.subVectors(O,M).multiplyScalar(l.dynamicDampingFactor)))}}();this.checkDistances=function(){l.noZoom&&l.noPan||(q.lengthSq()>l.maxDistance*l.maxDistance&&(l.object.position.addVectors(l.target,q.setLength(l.maxDistance)),
F.copy(H)),q.lengthSq()<l.minDistance*l.minDistance&&(l.object.position.addVectors(l.target,q.setLength(l.minDistance)),F.copy(H)))};this.update=function(){q.subVectors(l.object.position,l.target);l.noRotate||l.rotateCamera();l.noZoom||l.zoomCamera();l.noPan||l.panCamera();l.object.position.addVectors(l.target,q);l.checkDistances();l.object.lookAt(l.target);1E-6<n.distanceToSquared(l.object.position)&&(l.dispatchEvent(I),n.copy(l.object.position))};this.reset=function(){L=Q=r.NONE;l.target.copy(l.target0);
l.object.position.copy(l.position0);l.object.up.copy(l.up0);q.subVectors(l.object.position,l.target);l.object.lookAt(l.target);l.dispatchEvent(I);n.copy(l.object.position)};this.dispose=function(){this.domElement.removeEventListener("contextmenu",u,!1);this.domElement.removeEventListener("mousedown",f,!1);this.domElement.removeEventListener("mousewheel",m,!1);this.domElement.removeEventListener("MozMousePixelScroll",m,!1);this.domElement.removeEventListener("touchstart",t,!1);this.domElement.removeEventListener("touchend",
p,!1);this.domElement.removeEventListener("touchmove",v,!1);document.removeEventListener("mousemove",g,!1);document.removeEventListener("mouseup",k,!1);window.removeEventListener("keydown",d,!1);window.removeEventListener("keyup",e,!1)};this.domElement.addEventListener("contextmenu",u,!1);this.domElement.addEventListener("mousedown",f,!1);this.domElement.addEventListener("mousewheel",m,!1);this.domElement.addEventListener("MozMousePixelScroll",m,!1);this.domElement.addEventListener("touchstart",t,
!1);this.domElement.addEventListener("touchend",p,!1);this.domElement.addEventListener("touchmove",v,!1);window.addEventListener("keydown",d,!1);window.addEventListener("keyup",e,!1);this.handleResize();this.update()};b.TrackballControls.prototype=Object.create(b.EventDispatcher.prototype);b.TrackballControls.prototype.constructor=b.TrackballControls;b.SphereGeometry=function(a,c,d,e,f,g,k){b.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:c,heightSegments:d,
phiStart:e,phiLength:f,thetaStart:g,thetaLength:k};this.fromBufferGeometry(new b.SphereBufferGeometry(a,c,d,e,f,g,k))};b.SphereGeometry.prototype=Object.create(b.Geometry.prototype);b.SphereGeometry.prototype.constructor=b.SphereGeometry;b.SphereBufferGeometry=function(a,c,d,e,f,g,k){b.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:c,heightSegments:d,phiStart:e,phiLength:f,thetaStart:g,thetaLength:k};a=a||50;c=Math.max(3,Math.floor(c)||8);d=Math.max(2,
Math.floor(d)||6);e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;g=void 0!==g?g:0;k=void 0!==k?k:Math.PI;for(var m=g+k,t=(c+1)*(d+1),v=new b.BufferAttribute(new Float32Array(3*t),3),p=new b.BufferAttribute(new Float32Array(3*t),3),t=new b.BufferAttribute(new Float32Array(2*t),2),u=0,l=[],r=new b.Vector3,n=0;n<=d;n++){for(var Q=[],L=n/d,q=0;q<=c;q++){var z=q/c,K=-a*Math.cos(e+z*f)*Math.sin(g+L*k),A=a*Math.cos(g+L*k),C=a*Math.sin(e+z*f)*Math.sin(g+L*k);r.set(K,A,C).normalize();v.setXYZ(u,K,A,C);p.setXYZ(u,
r.x,r.y,r.z);t.setXY(u,z,1-L);Q.push(u);u++}l.push(Q)}e=[];for(n=0;n<d;n++)for(q=0;q<c;q++)f=l[n][q+1],k=l[n][q],u=l[n+1][q],r=l[n+1][q+1],(0!==n||0<g)&&e.push(f,k,r),(n!==d-1||m<Math.PI)&&e.push(k,u,r);this.setIndex(new (65535<v.count?b.Uint32Attribute:b.Uint16Attribute)(e,1));this.addAttribute("position",v);this.addAttribute("normal",p);this.addAttribute("uv",t);this.boundingSphere=new b.Sphere(new b.Vector3,a)};b.SphereBufferGeometry.prototype=Object.create(b.BufferGeometry.prototype);b.SphereBufferGeometry.prototype.constructor=
b.SphereBufferGeometry;b.CylinderGeometry=function(a,c,d,e,f,g,k,m){b.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:c,height:d,radialSegments:e,heightSegments:f,openEnded:g,thetaStart:k,thetaLength:m};this.fromBufferGeometry(new b.CylinderBufferGeometry(a,c,d,e,f,g,k,m));this.mergeVertices()};b.CylinderGeometry.prototype=Object.create(b.Geometry.prototype);b.CylinderGeometry.prototype.constructor=b.CylinderGeometry;b.CylinderBufferGeometry=function(a,c,
d,e,f,g,k,m){function t(d){var f,g,h;h=new b.Vector2;var p=new b.Vector3,u=0,x=!0===d?a:c,z=!0===d?1:-1;g=L;for(f=1;f<=e;f++)r.setXYZ(L,0,K*z,0),n.setXYZ(L,0,z,0),!0===d?(h.x=f/e,h.y=0):(h.x=(f-1)/e,h.y=1),Q.setXY(L,h.x,h.y),L++;h=L;for(f=0;f<=e;f++){var D=f/e;p.x=x*Math.sin(D*m+k);p.y=K*z;p.z=x*Math.cos(D*m+k);r.setXYZ(L,p.x,p.y,p.z);n.setXYZ(L,0,z,0);Q.setXY(L,D,!0===d?1:0);L++}for(f=0;f<e;f++)p=g+f,x=h+f,!0===d?(l.setX(q,x),q++,l.setX(q,x+1)):(l.setX(q,x+1),q++,l.setX(q,x)),q++,l.setX(q,p),q++,
u+=3;v.addGroup(A,u,!0===d?1:2);A+=u}b.BufferGeometry.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:c,height:d,radialSegments:e,heightSegments:f,openEnded:g,thetaStart:k,thetaLength:m};var v=this;a=void 0!==a?a:20;c=void 0!==c?c:20;d=void 0!==d?d:100;e=Math.floor(e)||8;f=Math.floor(f)||1;g=void 0!==g?g:!1;k=void 0!==k?k:0;m=void 0!==m?m:2*Math.PI;var p=function(){var a=(e+1)*(f+1);!1===g&&(a+=2*(e+1)+2*e);return a}(),u=function(){var a=e*f*6;!1===g&&(a+=6*
e);return a}(),l=new b.BufferAttribute(new (65535<u?Uint32Array:Uint16Array)(u),1),r=new b.BufferAttribute(new Float32Array(3*p),3),n=new b.BufferAttribute(new Float32Array(3*p),3),Q=new b.BufferAttribute(new Float32Array(2*p),2),L=0,q=0,z=[],K=d/2,A=0;(function(){var g,h,p=new b.Vector3,t=new b.Vector3,u=0,x=(c-a)/d;for(h=0;h<=f;h++){var O=[],I=h/f,D=I*(c-a)+a;for(g=0;g<=e;g++){var S=g/e;t.x=D*Math.sin(S*m+k);t.y=-I*d+K;t.z=D*Math.cos(S*m+k);r.setXYZ(L,t.x,t.y,t.z);p.copy(t);if(0===a&&0===h||0===
c&&h===f)p.x=Math.sin(S*m+k),p.z=Math.cos(S*m+k);p.setY(Math.sqrt(p.x*p.x+p.z*p.z)*x).normalize();n.setXYZ(L,p.x,p.y,p.z);Q.setXY(L,S,1-I);O.push(L);L++}z.push(O)}for(g=0;g<e;g++)for(h=0;h<f;h++)p=z[h+1][g],t=z[h+1][g+1],x=z[h][g+1],l.setX(q,z[h][g]),q++,l.setX(q,p),q++,l.setX(q,x),q++,l.setX(q,p),q++,l.setX(q,t),q++,l.setX(q,x),q++,u+=6;v.addGroup(A,u,0);A+=u})();!1===g&&(0<a&&t(!0),0<c&&t(!1));this.setIndex(l);this.addAttribute("position",r);this.addAttribute("normal",n);this.addAttribute("uv",
Q)};b.CylinderBufferGeometry.prototype=Object.create(b.BufferGeometry.prototype);b.CylinderBufferGeometry.prototype.constructor=b.CylinderBufferGeometry;b.ArrowHelper=function(){var a=new b.Geometry;a.vertices.push(new b.Vector3(0,0,0),new b.Vector3(0,1,0));var c=new b.CylinderGeometry(0,.5,1,5,1);c.translate(0,-.5,0);return function(d,e,f,g,k,m){b.Object3D.call(this);void 0===g&&(g=16776960);void 0===f&&(f=1);void 0===k&&(k=.2*f);void 0===m&&(m=.2*k);this.position.copy(e);this.line=new b.Line(a,
new b.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new b.Mesh(c,new b.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(d);this.setLength(f,k,m)}}();b.ArrowHelper.prototype=Object.create(b.Object3D.prototype);b.ArrowHelper.prototype.constructor=b.ArrowHelper;b.ArrowHelper.prototype.setDirection=function(){var a=new b.Vector3,c;return function(b){.99999<b.y?this.quaternion.set(0,0,0,1):-.99999>b.y?this.quaternion.set(1,
0,0,0):(a.set(b.z,0,-b.x).normalize(),c=Math.acos(b.y),this.quaternion.setFromAxisAngle(a,c))}}();b.ArrowHelper.prototype.setLength=function(a,b,d){void 0===b&&(b=.2*a);void 0===d&&(d=.2*b);this.line.scale.set(1,Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(d,b,d);this.cone.position.y=a;this.cone.updateMatrix()};b.ArrowHelper.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};m.THREE=b})}]);
</script>
</body>
</html>
